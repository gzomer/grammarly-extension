/*! For license information please see 387.vendors.chunk.js.LICENSE.txt */
(self.webpackChunk=self.webpackChunk||[]).push([[387],{59443:(e,t,r)=>{r.d(t,{Y1:()=>i,uq:()=>l});var i,n,s,a,o,l,c,u,d=r(73975),p=r(55415),h=r(22232),m=r(8125),g=r(51996);!function(e){var t;!function(t){var r;!function(e){e.user="user",e.api="api",e.doubleClick="doubleClick"}(r=t.Source||(t.Source={})),t.eq=(0,d.f7)((function(t,i){return t.source===i.source&&(t.source===r.doubleClick&&i.source===r.doubleClick?t.selectedWord===i.selectedWord:e.eqFormatting.equals(t.formatting,i.formatting))}))}(t=e.Meta||(e.Meta={})),e.nonEmpty=function(e){return e.length>0},e.isEmpty=function(e){return 0===e.length},e.toTextRange=function(e){return g.SV.create(e.index,e.index+e.length)},e.isUserSelection=function(e){return e.meta.source===t.Source.user},e.isApiSelection=function(e){return e.meta.source===t.Source.api},e.isDoubleClickSelection=function(e){return e.meta.source===t.Source.doubleClick},e.eqRange=(0,d.f7)((function(e,t){return e.index===t.index&&e.length===t.length})),e.eqFormatting=(0,d.f7)(p.vZ),e.eq=(0,d.f7)((function(t,r){return e.eqRange.equals(t,r)&&e.Meta.eq.equals(t.meta,r.meta)})),e.empty={index:0,length:0,meta:{source:e.Meta.Source.user,formatting:{}}}}(i||(i={})),function(e){e.DenaliOtherDocSession="denaliOtherDocSession",e.DenaliSameDocSession="denaliSameDocSession",e.MSOutlook="outlook",e.MSWord="word",e.MSWordOnline="wordOnline",e.MSExcel="excel",e.MSOffice="msoffice",e.ProbablyMSOutlookOnline="probablyMSOutlookOnline",e.GDocs="gdocs",e.GSheets="gsheets",e.ProbablyGMail="probablyGmail",e.CocoaHTMLWriter="cocoaHTMLWriter",e.DropboxPaper="dropbox_paper",e.PlainText="plainText",e.Unknown="unknown",e.Synthetic="synthetic"}(n||(n={})),function(e){e.empty={top:0,bottom:0}}(s||(s={})),function(e){!function(e){e.top="top",e.middle="middle",e.bottom="bottom"}(e.Y||(e.Y={})),function(e){e.left="left",e.middle="middle",e.right="right"}(e.X||(e.X={})),function(t){t.toViewport=function(t){return function(r){switch(r){case e.X.left:return t.left;case e.X.middle:return t.left+t.width/2;case e.X.right:return t.right;default:return(0,h.vE)(r)}}}}(e.X||(e.X={})),function(t){t.toViewport=function(t){return function(r){switch(r){case e.Y.top:return t.top;case e.Y.middle:return t.top+t.height/2;case e.Y.bottom:return t.bottom;default:return(0,h.vE)(r)}}}}(e.Y||(e.Y={}))}(a||(a={})),function(e){var t;!function(e){e.textMaybeWithFormatting="text",e.onlyFormatting="formatting"}(t=e.Type||(e.Type={})),e.isTextMaybeWithFormatting=function(e){return e.type===t.textMaybeWithFormatting},e.isOnlyFormatting=function(e){return e.type===t.onlyFormatting}}(o||(o={})),function(e){e.none="none",e.fast="fast",e.initial="initial",e.fake="fake"}(l||(l={})),function(e){var t;!function(e){e.bold="bold",e.italic="italic",e.underline="underline",e.strike="strike",e.header1="header1",e.header2="header2",e.bulletList="bulletList",e.dashedList="dashedList",e.orderedList="orderedList",e.link="link"}(t=e.Type||(e.Type={})),e.is=function(e){return(0,m.CI)(t,e)},e.asList=Object.values(e.Type),function(e){e.is=function(e){return void 0!==e[t.link]}}(e.LinkPayload||(e.LinkPayload={}))}(c||(c={})),function(e){e.undo="undo",e.redo="redo",e.cut="cut",e.copy="copy",e.paste="paste",e.selectAll="selectAll"}(u||(u={}))},87380:(e,t,r)=>{r.d(t,{x:()=>i});var i,n=r(27378),s=r(5739),a=r(12187),o=r(19962),l=r(44060),c=r(63969),u=r(24588),d=r(71284),p=r(21474),h=r(42329),m=r(43743),g=r(77176),f=r(98403),y=r(57091),v=r(93508),b=r(26653);!function(e){function t(e){return 0===e?"":e>=1e3?`${Math.min(Math.trunc(e/1e3),9)}k+`:String(e)}const r=({className:e,isChecking:t,type:r,animateFade:i=!0})=>{const{state:o,complete:l}=m.f.fadeOutState(t),c="checking-complete";return n.createElement(s.F.div,Object.assign({},(0,a.Sh)($.loader,e)),i?o.pipe(g.U((e=>"end"===e?n.createElement("div",{key:"checking-complete",className:c}):n.createElement(h.$,{key:"spinner",variation:r,size:"100%",className:"fadeOut"===e?$.fadeOut:void 0,onTransitionEnd:l})))):t.pipe(g.U((e=>e?n.createElement(h.$,{variation:r,size:"100%"}):n.createElement("div",{className:c})))))},i=({name:e,theme:r={},count:i,type:l="white",suffix:c=""})=>{const u=n.useContext(d.a.Context);return n.createElement(s.F.div,Object.assign({},(0,a.Sh)($.roundCounter,f.ab(l,h.$.getClassName($)),r.counterWrapper),{"data-role":"counter"}),n.createElement("svg",{viewBox:"0 0 32 32",className:$.circular},n.createElement("g",null,n.createElement("circle",{r:"15.75",cx:"16",cy:"16"}),n.createElement("text",Object.assign({x:"16",y:"17"},o.h5(u.has(d.a.Flag.supportsSVGDominantBaseline)),{fontSize:i>=100?14:18,"data-name":e},(0,a.Sh)(x,r.counterContent)),t(i),c))))},l=({name:e,theme:r={},count:i,type:l="white",suffix:c=""})=>{const u=n.useContext(d.a.Context);return n.createElement(s.F.div,Object.assign({},(0,a.Sh)($.ovalCounter,f.ab(l,h.$.getClassName($)),r.counterWrapper),{"data-role":"counter"}),n.createElement("svg",{viewBox:"0 0 32 20",className:$.circular},n.createElement("rect",{width:"32",height:"20",rx:"10"}),n.createElement("text",Object.assign({x:"16",y:"10.5"},o.h5(u.has(d.a.Flag.supportsSVGDominantBaseline)),{fontSize:11,"data-name":e},(0,a.Sh)(x,r.counterContent)),t(i),c)))};e.Counter=({theme:e={},count:t,type:r="white"})=>{const s=t>=100?l:i;return n.createElement(s,{theme:Object.assign(Object.assign({},e),{counterWrapper:(0,a.Sh)(e.counterWrapper,$.flexCounter).className}),count:t,type:r})},e.OutcomeCounter=({name:e,theme:r={},count:i,type:l="white",suffix:c,fontSize:u=12})=>{const p=n.useContext(d.a.Context);return n.createElement(s.F.div,Object.assign({},(0,a.Sh)($.outcomeCounter,f.ab(l,h.$.getClassName($)),r.counterWrapper),{"data-role":"counter"}),n.createElement("svg",{viewBox:"0 0 32 18",className:$.circular},n.createElement("rect",Object.assign({},function(e,t){return t||e>=100?{width:32}:e>=10?{x:4,width:24}:{x:7,width:18}}(i,Boolean(c)),{height:18,rx:9})),n.createElement("text",Object.assign({x:"50%",y:"10px"},o.h5(p.has(d.a.Flag.supportsSVGDominantBaseline)),{fontSize:u,"data-name":e},(0,a.Sh)(x,r.counterContent)),t(i),c)))},e.MainMeter=({count:e,isChecking:t,className:s})=>{const o=0===e;return n.createElement("div",Object.assign({},(0,a.Sh)($.meter,s)),n.createElement(r,{isChecking:t,type:o?"green":"red"}),0===e?n.createElement(p.JO.Grammarly,null):n.createElement(i,{count:e,type:"red",name:"toolbar-mistakes"}))},e.LensNavMeter=({count:e,isChecking:t})=>n.createElement("div",{className:$.lensNavMeter},n.createElement(r,{isChecking:t,type:"red"}),n.createElement(i,{count:e,type:"white",name:"toolbar-mistakes"})),e.PlagiarismMeter=({count:e,isChecking:t,className:i})=>n.createElement("div",Object.assign({},(0,a.Sh)($.plagiarismMeter,i)),n.createElement(r,{isChecking:t,type:"violet",animateFade:!1}),n.createElement(s.F.div,{className:$.wrapper},e.pipe(y.a(t),g.U((([e,t])=>0===e?n.createElement(p.JO.NotificationInfo,{className:$.plagiarismIcon,key:"icon",width:20}):!t&&n.createElement(l,{count:e,type:"violet",key:"value",suffix:n.createElement("tspan",{fontSize:8,dominantBaseline:"center"},"%")}))),v.O(null)))),e.PlagiarismOutcomesMeter=({count:t,isChecking:i,className:o})=>n.createElement("div",Object.assign({},(0,a.Sh)($.plagiarismMeter,o)),n.createElement(r,{isChecking:i,type:"cyan",animateFade:!1}),n.createElement(s.F.div,{className:$.wrapper},t.pipe(y.a(i),g.U((([t,r])=>b.g.isMin(t)?n.createElement(p.JO.CheckmarkOutcomes,{className:$.plagiarismOutcomeIcon,key:"icon",width:20}):!r&&n.createElement(e.OutcomeCounter,{count:b.g.prism.reverseGet(t),type:"cyan",key:"value",suffix:n.createElement("tspan",{fontSize:11},"%")}))),v.O(null))))}(i||(i={}));const w=1.25,S={position:"absolute",top:0,right:0,bottom:0,left:0,overflow:"visible",margin:"auto",width:c.u.percent(100),height:c.u.percent(100)},I={position:"absolute",width:c.u.percent(150),height:c.u.percent(150),transform:"translate(-17%, -17%)"},A={position:"relative",display:"inline-flex"},_={width:c.u.percent(100),height:c.u.percent(100)},C={minWidth:c.u.rem(2),width:c.u.percent(100),height:c.u.rem(w)},E={maxWidth:c.u.rem(2),height:c.u.rem(w)},T="counterText",x=c.u.joinClasses([T,c.u.style({fontWeight:"bold",textAnchor:"middle",fill:l.Il.CoreNeutral0})]),k={fill:u.zh,$nest:{"& .counterText":{fill:u.FW}}},M={fill:l.Il.CoreRed50,$nest:{"& .counterText":{fill:l.Il.CoreNeutral0}}},L={fill:l.Il.CoreGreen50,$nest:{"& .counterText":{fill:l.Il.CoreNeutral0}}},R={fill:l.Il.CoreBlue50,$nest:{"& .counterText":{fill:l.Il.CoreNeutral0}}},N={fill:"transparent",$nest:{"& .counterText":{fill:u.FW}}},U={fill:u.lh,$nest:{"& .counterText":{fill:l.Il.CoreNeutral0}}},D={fill:u.AX,$nest:{"& .counterText":{fill:l.Il.CoreNeutral0}}},O={fill:l.Il.CoreYellow20,$nest:{"& .counterText":{fill:l.Il.CoreYellow80}}},P={fill:l.Il.CoreYellow60,$nest:{"& .counterText":{fill:l.Il.CoreNeutral0}}},F={fill:l.Il.CoreCyan50,$nest:{"& .counterText":{fill:l.Il.CoreNeutral0}}},z={width:c.u.rem(1.5),height:c.u.rem(1.5)},j={margin:`0 ${c.u.rem(.25)}`},B={width:c.u.rem(2),height:c.u.rem(w)},W={margin:`${c.u.rem(-1)} 0`},H={$nest:{"&:not([data-disabled='true'])[data-active='true'], &:not([data-disabled='true'])[data-hovered='true']":{fill:l.Il.CoreCyan50}}},G={width:c.u.rem(2),height:c.u.rem(1.125),position:"relative"},$=c.u.stylesheet({fadeOut:[{opacity:0,transition:"opacity .5s linear"}],circular:[S],loader:[I],wrapper:[A],roundCounter:[A,_],ovalCounter:[A,C],flexCounter:[A,E],gray:[k],red:[M],green:[L],blue:[R],white:[N],violet:[U],yellow:[D],yellowPremium:[O],orange:[P],cyan:[F],meter:[A,z],lensNavMeter:[A,z,j],plagiarismMeter:[A,B],plagiarismIcon:[W],plagiarismOutcomeIcon:[W,H],outcomeCounter:[A,{position:"absolute",left:0},G]})},63899:(e,t,r)=>{r.d(t,{u_:()=>Ae,aV:()=>Se,ay:()=>Ie});var i=r(27378),n=r(38983),s=r(5739),a=r(12187),o=r(25781),l=r(8125),c=r(22232),u=r(44060),d=r(63969),p=r(24588),h=r(40219),m=r(7046),g=r(21474),f=r(29909),y=r(40327);function v(e){return getComputedStyle(e)}function b(e,t){for(var r in t){var i=t[r];"number"==typeof i&&(i+="px"),e.style[r]=i}return e}function w(e){var t=document.createElement("div");return t.className=e,t}var S="undefined"!=typeof Element&&(Element.prototype.matches||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector);function I(e,t){if(!S)throw new Error("No element matching method supported");return S.call(e,t)}function A(e){e.remove?e.remove():e.parentNode&&e.parentNode.removeChild(e)}function _(e,t){return Array.prototype.filter.call(e.children,(function(e){return I(e,t)}))}var C="ps",E="ps__rtl",T={thumb:function(e){return"ps__thumb-"+e},rail:function(e){return"ps__rail-"+e},consuming:"ps__child--consume"},x={focus:"ps--focus",clicking:"ps--clicking",active:function(e){return"ps--active-"+e},scrolling:function(e){return"ps--scrolling-"+e}},k={x:null,y:null};function M(e,t){var r=e.element.classList,i=x.scrolling(t);r.contains(i)?clearTimeout(k[t]):r.add(i)}function L(e,t){k[t]=setTimeout((function(){return e.isAlive&&e.element.classList.remove(x.scrolling(t))}),e.settings.scrollingThreshold)}var R=function(e){this.element=e,this.handlers={}},N={isEmpty:{configurable:!0}};R.prototype.bind=function(e,t){void 0===this.handlers[e]&&(this.handlers[e]=[]),this.handlers[e].push(t),this.element.addEventListener(e,t,!1)},R.prototype.unbind=function(e,t){var r=this;this.handlers[e]=this.handlers[e].filter((function(i){return!(!t||i===t)||(r.element.removeEventListener(e,i,!1),!1)}))},R.prototype.unbindAll=function(){for(var e in this.handlers)this.unbind(e)},N.isEmpty.get=function(){var e=this;return Object.keys(this.handlers).every((function(t){return 0===e.handlers[t].length}))},Object.defineProperties(R.prototype,N);var U=function(){this.eventElements=[]};function D(e){if("function"==typeof self.CustomEvent)return new CustomEvent(e);var t=document.createEvent("CustomEvent");return t.initCustomEvent(e,!1,!1,void 0),t}function O(e,t,r,i,n){var s;if(void 0===i&&(i=!0),void 0===n&&(n=!1),"top"===t)s=["contentHeight","containerHeight","scrollTop","y","up","down"];else{if("left"!==t)throw new Error("A proper axis should be provided");s=["contentWidth","containerWidth","scrollLeft","x","left","right"]}!function(e,t,r,i,n){var s=r[0],a=r[1],o=r[2],l=r[3],c=r[4],u=r[5];void 0===i&&(i=!0);void 0===n&&(n=!1);var d=e.element;e.reach[l]=null,d[o]<1&&(e.reach[l]="start");d[o]>e[s]-e[a]-1&&(e.reach[l]="end");t&&(d.dispatchEvent(D("ps-scroll-"+l)),t<0?d.dispatchEvent(D("ps-scroll-"+c)):t>0&&d.dispatchEvent(D("ps-scroll-"+u)),i&&function(e,t){M(e,t),L(e,t)}(e,l));e.reach[l]&&(t||n)&&d.dispatchEvent(D("ps-"+l+"-reach-"+e.reach[l]))}(e,r,s,i,n)}function P(e){return parseInt(e,10)||0}U.prototype.eventElement=function(e){var t=this.eventElements.filter((function(t){return t.element===e}))[0];return t||(t=new R(e),this.eventElements.push(t)),t},U.prototype.bind=function(e,t,r){this.eventElement(e).bind(t,r)},U.prototype.unbind=function(e,t,r){var i=this.eventElement(e);i.unbind(t,r),i.isEmpty&&this.eventElements.splice(this.eventElements.indexOf(i),1)},U.prototype.unbindAll=function(){this.eventElements.forEach((function(e){return e.unbindAll()})),this.eventElements=[]},U.prototype.once=function(e,t,r){var i=this.eventElement(e),n=function(e){i.unbind(t,n),r(e)};i.bind(t,n)};var F={isWebKit:"undefined"!=typeof document&&"WebkitAppearance"in document.documentElement.style,supportsTouch:"undefined"!=typeof self&&("ontouchstart"in self||"maxTouchPoints"in self.navigator&&self.navigator.maxTouchPoints>0||self.DocumentTouch&&document instanceof self.DocumentTouch),supportsIePointer:"undefined"!=typeof navigator&&navigator.msMaxTouchPoints,isChrome:"undefined"!=typeof navigator&&/Chrome/i.test(navigator&&navigator.userAgent)};function z(e){var t=e.element,r=Math.floor(t.scrollTop),i=t.getBoundingClientRect();e.containerWidth=Math.round(i.width),e.containerHeight=Math.round(i.height),e.contentWidth=t.scrollWidth,e.contentHeight=t.scrollHeight,t.contains(e.scrollbarXRail)||(_(t,T.rail("x")).forEach((function(e){return A(e)})),t.appendChild(e.scrollbarXRail)),t.contains(e.scrollbarYRail)||(_(t,T.rail("y")).forEach((function(e){return A(e)})),t.appendChild(e.scrollbarYRail)),!e.settings.suppressScrollX&&e.containerWidth+e.settings.scrollXMarginOffset<e.contentWidth?(e.scrollbarXActive=!0,e.railXWidth=e.containerWidth-e.railXMarginWidth-1,e.railXRatio=e.containerWidth/e.railXWidth,e.scrollbarXWidth=j(e,P(e.railXWidth*e.containerWidth/e.contentWidth)),e.scrollbarXLeft=P((e.negativeScrollAdjustment+t.scrollLeft)*(e.railXWidth-e.scrollbarXWidth)/(e.contentWidth-e.containerWidth))):e.scrollbarXActive=!1,!e.settings.suppressScrollY&&e.containerHeight+e.settings.scrollYMarginOffset<e.contentHeight?(e.scrollbarYActive=!0,e.railYHeight=e.containerHeight-e.railYMarginHeight-1,e.railYRatio=e.containerHeight/e.railYHeight,e.scrollbarYHeight=j(e,P(e.railYHeight*e.containerHeight/e.contentHeight)),e.scrollbarYTop=P(r*(e.railYHeight-e.scrollbarYHeight)/(e.contentHeight-e.containerHeight))):e.scrollbarYActive=!1,e.scrollbarXLeft>=e.railXWidth-e.scrollbarXWidth&&(e.scrollbarXLeft=e.railXWidth-e.scrollbarXWidth),e.scrollbarYTop>=e.railYHeight-e.scrollbarYHeight&&(e.scrollbarYTop=e.railYHeight-e.scrollbarYHeight),function(e,t){var r={width:t.railXWidth},i=Math.floor(e.scrollTop);t.isRtl?r.left=t.negativeScrollAdjustment+e.scrollLeft+t.containerWidth-t.contentWidth:r.left=e.scrollLeft;t.isScrollbarXUsingBottom?r.bottom=t.scrollbarXBottom-i:r.top=t.scrollbarXTop+i;b(t.scrollbarXRail,r);var n={top:i,height:t.railYHeight};t.isScrollbarYUsingRight?t.isRtl?n.right=t.contentWidth-(t.negativeScrollAdjustment+e.scrollLeft)-t.scrollbarYRight-t.scrollbarYOuterWidth-9:n.right=t.scrollbarYRight-e.scrollLeft:t.isRtl?n.left=t.negativeScrollAdjustment+e.scrollLeft+2*t.containerWidth-t.contentWidth-t.scrollbarYLeft-t.scrollbarYOuterWidth:n.left=t.scrollbarYLeft+e.scrollLeft;b(t.scrollbarYRail,n),b(t.scrollbarX,{left:t.scrollbarXLeft,width:t.scrollbarXWidth-t.railBorderXWidth}),b(t.scrollbarY,{top:t.scrollbarYTop,height:t.scrollbarYHeight-t.railBorderYWidth})}(t,e),e.scrollbarXActive?t.classList.add(x.active("x")):(t.classList.remove(x.active("x")),e.scrollbarXWidth=0,e.scrollbarXLeft=0,t.scrollLeft=!0===e.isRtl?e.contentWidth:0),e.scrollbarYActive?t.classList.add(x.active("y")):(t.classList.remove(x.active("y")),e.scrollbarYHeight=0,e.scrollbarYTop=0,t.scrollTop=0)}function j(e,t){return e.settings.minScrollbarLength&&(t=Math.max(t,e.settings.minScrollbarLength)),e.settings.maxScrollbarLength&&(t=Math.min(t,e.settings.maxScrollbarLength)),t}function B(e,t){var r=t[0],i=t[1],n=t[2],s=t[3],a=t[4],o=t[5],l=t[6],c=t[7],u=t[8],d=e.element,p=null,h=null,m=null;function g(t){t.touches&&t.touches[0]&&(t[n]=t.touches[0].pageY),d[l]=p+m*(t[n]-h),M(e,c),z(e),t.stopPropagation(),t.preventDefault()}function f(){L(e,c),e[u].classList.remove(x.clicking),e.event.unbind(e.ownerDocument,"mousemove",g)}function y(t,a){p=d[l],a&&t.touches&&(t[n]=t.touches[0].pageY),h=t[n],m=(e[i]-e[r])/(e[s]-e[o]),a?e.event.bind(e.ownerDocument,"touchmove",g):(e.event.bind(e.ownerDocument,"mousemove",g),e.event.once(e.ownerDocument,"mouseup",f),t.preventDefault()),e[u].classList.add(x.clicking),t.stopPropagation()}e.event.bind(e[a],"mousedown",(function(e){y(e)})),e.event.bind(e[a],"touchstart",(function(e){y(e,!0)}))}var W={"click-rail":function(e){e.element,e.event.bind(e.scrollbarY,"mousedown",(function(e){return e.stopPropagation()})),e.event.bind(e.scrollbarYRail,"mousedown",(function(t){var r=t.pageY-self.pageYOffset-e.scrollbarYRail.getBoundingClientRect().top>e.scrollbarYTop?1:-1;e.element.scrollTop+=r*e.containerHeight,z(e),t.stopPropagation()})),e.event.bind(e.scrollbarX,"mousedown",(function(e){return e.stopPropagation()})),e.event.bind(e.scrollbarXRail,"mousedown",(function(t){var r=t.pageX-self.pageXOffset-e.scrollbarXRail.getBoundingClientRect().left>e.scrollbarXLeft?1:-1;e.element.scrollLeft+=r*e.containerWidth,z(e),t.stopPropagation()}))},"drag-thumb":function(e){B(e,["containerWidth","contentWidth","pageX","railXWidth","scrollbarX","scrollbarXWidth","scrollLeft","x","scrollbarXRail"]),B(e,["containerHeight","contentHeight","pageY","railYHeight","scrollbarY","scrollbarYHeight","scrollTop","y","scrollbarYRail"])},keyboard:function(e){var t=e.element;e.event.bind(e.ownerDocument,"keydown",(function(r){if(!(r.isDefaultPrevented&&r.isDefaultPrevented()||r.defaultPrevented)&&(I(t,":hover")||I(e.scrollbarX,":focus")||I(e.scrollbarY,":focus"))){var i,n=document.activeElement?document.activeElement:e.ownerDocument.activeElement;if(n){if("IFRAME"===n.tagName)n=n.contentDocument.activeElement;else for(;n.shadowRoot;)n=n.shadowRoot.activeElement;if(I(i=n,"input,[contenteditable]")||I(i,"select,[contenteditable]")||I(i,"textarea,[contenteditable]")||I(i,"button,[contenteditable]"))return}var s=0,a=0;switch(r.which){case 37:s=r.metaKey?-e.contentWidth:r.altKey?-e.containerWidth:-30;break;case 38:a=r.metaKey?e.contentHeight:r.altKey?e.containerHeight:30;break;case 39:s=r.metaKey?e.contentWidth:r.altKey?e.containerWidth:30;break;case 40:a=r.metaKey?-e.contentHeight:r.altKey?-e.containerHeight:-30;break;case 32:a=r.shiftKey?e.containerHeight:-e.containerHeight;break;case 33:a=e.containerHeight;break;case 34:a=-e.containerHeight;break;case 36:a=e.contentHeight;break;case 35:a=-e.contentHeight;break;default:return}e.settings.suppressScrollX&&0!==s||e.settings.suppressScrollY&&0!==a||(t.scrollTop-=a,t.scrollLeft+=s,z(e),function(r,i){var n=Math.floor(t.scrollTop);if(0===r){if(!e.scrollbarYActive)return!1;if(0===n&&i>0||n>=e.contentHeight-e.containerHeight&&i<0)return!e.settings.wheelPropagation}var s=t.scrollLeft;if(0===i){if(!e.scrollbarXActive)return!1;if(0===s&&r<0||s>=e.contentWidth-e.containerWidth&&r>0)return!e.settings.wheelPropagation}return!0}(s,a)&&r.preventDefault())}}))},wheel:function(e){var t=e.element;function r(r){var i=function(e){var t=e.deltaX,r=-1*e.deltaY;return void 0!==t&&void 0!==r||(t=-1*e.wheelDeltaX/6,r=e.wheelDeltaY/6),e.deltaMode&&1===e.deltaMode&&(t*=10,r*=10),t!=t&&r!=r&&(t=0,r=e.wheelDelta),e.shiftKey?[-r,-t]:[t,r]}(r),n=i[0],s=i[1];if(!function(e,r,i){if(!F.isWebKit&&t.querySelector("select:focus"))return!0;if(!t.contains(e))return!1;for(var n=e;n&&n!==t;){if(n.classList.contains(T.consuming))return!0;var s=v(n);if(i&&s.overflowY.match(/(scroll|auto)/)){var a=n.scrollHeight-n.clientHeight;if(a>0&&(n.scrollTop>0&&i<0||n.scrollTop<a&&i>0))return!0}if(r&&s.overflowX.match(/(scroll|auto)/)){var o=n.scrollWidth-n.clientWidth;if(o>0&&(n.scrollLeft>0&&r<0||n.scrollLeft<o&&r>0))return!0}n=n.parentNode}return!1}(r.target,n,s)){var a=!1;e.settings.useBothWheelAxes?e.scrollbarYActive&&!e.scrollbarXActive?(s?t.scrollTop-=s*e.settings.wheelSpeed:t.scrollTop+=n*e.settings.wheelSpeed,a=!0):e.scrollbarXActive&&!e.scrollbarYActive&&(n?t.scrollLeft+=n*e.settings.wheelSpeed:t.scrollLeft-=s*e.settings.wheelSpeed,a=!0):(t.scrollTop-=s*e.settings.wheelSpeed,t.scrollLeft+=n*e.settings.wheelSpeed),z(e),(a=a||function(r,i){var n=Math.floor(t.scrollTop),s=0===t.scrollTop,a=n+t.offsetHeight===t.scrollHeight,o=0===t.scrollLeft,l=t.scrollLeft+t.offsetWidth===t.scrollWidth;return!(Math.abs(i)>Math.abs(r)?s||a:o||l)||!e.settings.wheelPropagation}(n,s))&&!r.ctrlKey&&(r.stopPropagation(),r.preventDefault())}}void 0!==self.onwheel?e.event.bind(t,"wheel",r):void 0!==self.onmousewheel&&e.event.bind(t,"mousewheel",r)},touch:function(e){if(F.supportsTouch||F.supportsIePointer){var t=e.element,r={},i=0,n={},s=null;F.supportsTouch?(e.event.bind(t,"touchstart",c),e.event.bind(t,"touchmove",u),e.event.bind(t,"touchend",d)):F.supportsIePointer&&(self.PointerEvent?(e.event.bind(t,"pointerdown",c),e.event.bind(t,"pointermove",u),e.event.bind(t,"pointerup",d)):self.MSPointerEvent&&(e.event.bind(t,"MSPointerDown",c),e.event.bind(t,"MSPointerMove",u),e.event.bind(t,"MSPointerUp",d)))}function a(r,i){t.scrollTop-=i,t.scrollLeft-=r,z(e)}function o(e){return e.targetTouches?e.targetTouches[0]:e}function l(e){return(!e.pointerType||"pen"!==e.pointerType||0!==e.buttons)&&(!(!e.targetTouches||1!==e.targetTouches.length)||!(!e.pointerType||"mouse"===e.pointerType||e.pointerType===e.MSPOINTER_TYPE_MOUSE))}function c(e){if(l(e)){var t=o(e);r.pageX=t.pageX,r.pageY=t.pageY,i=(new Date).getTime(),null!==s&&clearInterval(s)}}function u(s){if(l(s)){var c=o(s),u={pageX:c.pageX,pageY:c.pageY},d=u.pageX-r.pageX,p=u.pageY-r.pageY;if(function(e,r,i){if(!t.contains(e))return!1;for(var n=e;n&&n!==t;){if(n.classList.contains(T.consuming))return!0;var s=v(n);if(i&&s.overflowY.match(/(scroll|auto)/)){var a=n.scrollHeight-n.clientHeight;if(a>0&&(n.scrollTop>0&&i<0||n.scrollTop<a&&i>0))return!0}if(r&&s.overflowX.match(/(scroll|auto)/)){var o=n.scrollWidth-n.clientWidth;if(o>0&&(n.scrollLeft>0&&r<0||n.scrollLeft<o&&r>0))return!0}n=n.parentNode}return!1}(s.target,d,p))return;a(d,p),r=u;var h=(new Date).getTime(),m=h-i;m>0&&(n.x=d/m,n.y=p/m,i=h),function(r,i){var n=Math.floor(t.scrollTop),s=t.scrollLeft,a=Math.abs(r),o=Math.abs(i);if(o>a){if(i<0&&n===e.contentHeight-e.containerHeight||i>0&&0===n)return 0===self.scrollY&&i>0&&F.isChrome}else if(a>o&&(r<0&&s===e.contentWidth-e.containerWidth||r>0&&0===s))return!0;return!0}(d,p)&&s.preventDefault()}}function d(){e.settings.swipeEasing&&(clearInterval(s),s=setInterval((function(){e.isInitialized?clearInterval(s):n.x||n.y?Math.abs(n.x)<.01&&Math.abs(n.y)<.01?clearInterval(s):(a(30*n.x,30*n.y),n.x*=.8,n.y*=.8):clearInterval(s)}),10))}}},H=function(e,t){var r=this;if(void 0===t&&(t={}),"string"==typeof e&&(e=document.querySelector(e)),!e||!e.nodeName)throw new Error("no element is specified to initialize PerfectScrollbar");for(var i in this.element=e,e.classList.add(C),this.settings={handlers:["click-rail","drag-thumb","keyboard","wheel","touch"],maxScrollbarLength:null,minScrollbarLength:null,scrollingThreshold:1e3,scrollXMarginOffset:0,scrollYMarginOffset:0,suppressScrollX:!1,suppressScrollY:!1,swipeEasing:!0,useBothWheelAxes:!1,wheelPropagation:!0,wheelSpeed:1},t)this.settings[i]=t[i];this.containerWidth=null,this.containerHeight=null,this.contentWidth=null,this.contentHeight=null;var n,s,a=function(){return e.classList.add(x.focus)},o=function(){return e.classList.remove(x.focus)};this.isRtl="rtl"===v(e).direction,!0===this.isRtl&&e.classList.add(E),this.isNegativeScroll=(s=e.scrollLeft,e.scrollLeft=-1,n=e.scrollLeft<0,e.scrollLeft=s,n),this.negativeScrollAdjustment=this.isNegativeScroll?e.scrollWidth-e.clientWidth:0,this.event=new U,this.ownerDocument=e.ownerDocument||document,this.scrollbarXRail=w(T.rail("x")),e.appendChild(this.scrollbarXRail),this.scrollbarX=w(T.thumb("x")),this.scrollbarXRail.appendChild(this.scrollbarX),this.scrollbarX.setAttribute("tabindex",0),this.event.bind(this.scrollbarX,"focus",a),this.event.bind(this.scrollbarX,"blur",o),this.scrollbarXActive=null,this.scrollbarXWidth=null,this.scrollbarXLeft=null;var l=v(this.scrollbarXRail);this.scrollbarXBottom=parseInt(l.bottom,10),isNaN(this.scrollbarXBottom)?(this.isScrollbarXUsingBottom=!1,this.scrollbarXTop=P(l.top)):this.isScrollbarXUsingBottom=!0,this.railBorderXWidth=P(l.borderLeftWidth)+P(l.borderRightWidth),b(this.scrollbarXRail,{display:"block"}),this.railXMarginWidth=P(l.marginLeft)+P(l.marginRight),b(this.scrollbarXRail,{display:""}),this.railXWidth=null,this.railXRatio=null,this.scrollbarYRail=w(T.rail("y")),e.appendChild(this.scrollbarYRail),this.scrollbarY=w(T.thumb("y")),this.scrollbarYRail.appendChild(this.scrollbarY),this.scrollbarY.setAttribute("tabindex",0),this.event.bind(this.scrollbarY,"focus",a),this.event.bind(this.scrollbarY,"blur",o),this.scrollbarYActive=null,this.scrollbarYHeight=null,this.scrollbarYTop=null;var c=v(this.scrollbarYRail);this.scrollbarYRight=parseInt(c.right,10),isNaN(this.scrollbarYRight)?(this.isScrollbarYUsingRight=!1,this.scrollbarYLeft=P(c.left)):this.isScrollbarYUsingRight=!0,this.scrollbarYOuterWidth=this.isRtl?function(e){var t=v(e);return P(t.width)+P(t.paddingLeft)+P(t.paddingRight)+P(t.borderLeftWidth)+P(t.borderRightWidth)}(this.scrollbarY):null,this.railBorderYWidth=P(c.borderTopWidth)+P(c.borderBottomWidth),b(this.scrollbarYRail,{display:"block"}),this.railYMarginHeight=P(c.marginTop)+P(c.marginBottom),b(this.scrollbarYRail,{display:""}),this.railYHeight=null,this.railYRatio=null,this.reach={x:e.scrollLeft<=0?"start":e.scrollLeft>=this.contentWidth-this.containerWidth?"end":null,y:e.scrollTop<=0?"start":e.scrollTop>=this.contentHeight-this.containerHeight?"end":null},this.isAlive=!0,this.settings.handlers.forEach((function(e){return W[e](r)})),this.lastScrollTop=Math.floor(e.scrollTop),this.lastScrollLeft=e.scrollLeft,this.event.bind(this.element,"scroll",(function(e){return r.onScroll(e)})),z(this)};H.prototype.update=function(){this.isAlive&&(this.negativeScrollAdjustment=this.isNegativeScroll?this.element.scrollWidth-this.element.clientWidth:0,b(this.scrollbarXRail,{display:"block"}),b(this.scrollbarYRail,{display:"block"}),this.railXMarginWidth=P(v(this.scrollbarXRail).marginLeft)+P(v(this.scrollbarXRail).marginRight),this.railYMarginHeight=P(v(this.scrollbarYRail).marginTop)+P(v(this.scrollbarYRail).marginBottom),b(this.scrollbarXRail,{display:"none"}),b(this.scrollbarYRail,{display:"none"}),z(this),O(this,"top",0,!1,!0),O(this,"left",0,!1,!0),b(this.scrollbarXRail,{display:""}),b(this.scrollbarYRail,{display:""}))},H.prototype.onScroll=function(e){this.isAlive&&(z(this),O(this,"top",this.element.scrollTop-this.lastScrollTop),O(this,"left",this.element.scrollLeft-this.lastScrollLeft),this.lastScrollTop=Math.floor(this.element.scrollTop),this.lastScrollLeft=this.element.scrollLeft)},H.prototype.destroy=function(){this.isAlive&&(this.event.unbindAll(),A(this.scrollbarX),A(this.scrollbarY),A(this.scrollbarXRail),A(this.scrollbarYRail),this.removePsClasses(),this.element=null,this.scrollbarX=null,this.scrollbarY=null,this.scrollbarXRail=null,this.scrollbarYRail=null,this.isAlive=!1)},H.prototype.removePsClasses=function(){this.element.className=this.element.className.split(" ").filter((function(e){return!e.match(/^ps([-_].+|)$/)})).join(" ")};const G=H;var $=r(83078),Y=r(5114),V=r(85255),Z=r(60797),Q=r(85089),q=r(98403),X=r(66310),J=r(78674),K=r(50628),ee=r(2834),te=r(24209),re=r(66081),ie=r(40151),ne=r(77176),se=r(67434),ae=r(49708);const oe="#7d7c7c",le="#3a3a3a",ce="ps--force",ue=d.u.style({position:"relative",overflow:"hidden !important"});d.u.cssRule(".ps",{overflow:d.u.important("hidden"),"overflow-anchor":"none","-ms-touch-action":"auto",touchAction:"auto","-ms-overflow-style":"none",position:"relative",border:"none !important",$nest:Object.assign(Object.assign(Object.assign({},{"& .ps__rail-x, & .ps__rail-y":{zIndex:h.$n,pointerEvents:"all"},".ps__rail-x":{display:"none",opacity:0,transition:"background-color .2s linear, opacity .2s linear","-webkit-transition":"background-color .2s linear, opacity .2s linear",height:15,bottom:0,position:"absolute"},".ps__rail-y":{display:"none",opacity:"0",transition:"background-color .2s linear, opacity .2s linear","-webkit-transition":"background-color .2s linear, opacity .2s linear",width:15,right:0,position:"absolute"},".ps--active-x > .ps__rail-x, .ps--active-y > .ps__rail-y":{display:"block","background-color":"transparent"},"&.ps--hidden > .ps__rail-x, &.ps--hidden > .ps__rail-y":{opacity:0},"&.ps--force > .ps__rail-x, &.ps--force > .ps__rail-y":{opacity:.6},"&:hover > .ps__rail-x, &:hover > .ps__rail-y, &.ps--focus > .ps__rail-x, &.ps--focus > .ps__rail-y, &.ps--scrolling-x > .ps__rail-x, &.ps--scrolling-y > .ps__rail-y":{opacity:.6},".ps__rail-x:hover, .ps__rail-y:hover, .ps__rail-x:focus, .ps__rail-y:focus, .ps__rail-x.ps--clicking, .ps__rail-y.ps--clicking":{"background-color":"#eee",opacity:.9}}),{".ps__thumb-x":{backgroundColor:oe,borderRadius:6,transition:"background-color .2s linear, height .2s ease-in-out","-webkit-transition":"background-color .2s linear, height .2s ease-in-out",height:6,bottom:2,position:"absolute"},".ps__thumb-y":{backgroundColor:oe,borderRadius:6,transition:"background-color .2s linear, width .2s ease-in-out","-webkit-transition":"background-color .2s linear, width .2s ease-in-out",width:6,right:2,position:"absolute"},".ps__rail-x:hover > .ps__thumb-x, .ps__rail-x:focus > .ps__thumb-x, .ps__rail-x.ps--clicking .ps__thumb-x":{backgroundColor:le,height:11},".ps__rail-y:hover > .ps__thumb-y, .ps__rail-y:focus > .ps__thumb-y, .ps__rail-y.ps--clicking .ps__thumb-y":{backgroundColor:le,width:11}}),{"@media screen and (-ms-high-contrast: active), (-ms-high-contrast: none)":{overflow:d.u.important("auto")},"@supports (-ms-overflow-style: none)":{overflow:d.u.important("auto")}})});const de=({update:e,children:t,onScroll:r,scrollTo:o,name:l,className:c,showWhenScrollable:u})=>{const d=n.h.create(Y.none),p=n.h.create(Y.none);return V.P.useSubscriptionTo(d.pipe(Z.oA).pipe(X.w((e=>Q.YC(e).pipe(J.b(250),K.P(),ee.b((()=>p.set(Y.some((e=>new G(e,{suppressScrollX:!0,minScrollbarLength:40}))(e)))))))))),V.P.useSubscriptionTo(p.pipe(Z.oA).pipe(ee.b((e=>e.scrollbarY.setAttribute("aria-label","Vertical scrollbar"))),X.w((t=>te.T(Q.YC(t.element).pipe(re.e(200),ee.b((()=>{t.update()}))),(o||ie.E).pipe(ee.b((e=>{t.element.scrollTop=e,t.update()}))),(e||ie.E).pipe(ee.b((()=>{t.update()})))))))),V.P.useSubscriptionTo(d.pipe(Z.oA).pipe(X.w((e=>q.Dx(c).pipe(ne.U((e=>Boolean(e)?e.split(" "):[])),se.R(((t,r)=>(Boolean(t)&&e.classList.remove(...t),Boolean(r)&&e.classList.add(...r),r)),[])))))),V.P.useEffectOnWillUnmount((()=>{(0,y.pipe)(p.get(),$.bw((e=>{e.destroy(),p.set(Y.none)})))})),i.createElement("div",Object.assign({},(0,a.Sh)(!0===u&&ce,ue),{onScroll:r?()=>r.next():void 0,ref:e=>d.set(Y.fromNullable(e)),"data-role":`scrollbar-${l}`}),i.createElement(s.F.Fragment,null,t))};var pe;!function(e){function t(e){let t=e.deltaX,r=-1*e.deltaY;return void 0!==t&&void 0!==r||(t=-1*e.deltaX/6,r=e.deltaY/6),e.deltaMode&&1===e.deltaMode&&(t*=10,r*=10),t!=t&&r!=r&&(t=0,r=e.deltaY),[t,r]}e.verticalScrollByWhellEvent=e=>ae.R(e,"wheel",{passive:!0}).pipe(ne.U(t),ne.U(f.Yg),ee.b((t=>e.scrollTop-=t)))}(pe||(pe={}));var he=r(43743),me=r(28706),ge=r(28043),fe=r(55935),ye=r(85985),ve=r(41398),be=r(76974),we=r(17343);class Se extends i.Component{constructor(){super(...arguments),this._overlayIndex=Se._index++,this._subs=[],this._visibilityState=n.h.create("hidden"),this._onClick=()=>{!1!==this.props.preventClose&&null!=this.props.preventClose||this.props.visible.set(!1)}}componentDidMount(){this._visibilityState.set(this.props.visible.get()?"visible":"hidden"),this._subs.push(this._visibilityState.pipe(ne.U((e=>"visible"===e)),ge.x()).subscribe((e=>Se._activeOverlays.modify((t=>{const r=new Set(t);return e?r.add(this._overlayIndex):r.delete(this._overlayIndex),r})))),this.props.visible.pipe(fe.T(1)).subscribe((e=>{const t=!0===this.props.animate?"fadeOut":"hidden";this._visibilityState.set(e?"visible":t)}))),this._subs.push(this._visibilityState.pipe(X.w((e=>"visible"===e?ae.R(document,"keydown"):ie.E)),ye.h((e=>e.keyCode===o.R.ESC_CODE)),ve.M(this.props.onClose?q.Dx(this.props.onClose):be.of(l.Q1))).subscribe((([,e])=>{var t;null!==(t=this.props.preventClose)&&void 0!==t&&t||this.props.visible.set(!1),e()})))}componentWillUnmount(){Se._activeOverlays.modify((e=>{const t=new Set(e);return t.delete(this._overlayIndex),t})),this._subs.forEach((e=>e.unsubscribe())),this._subs=[]}render(){return i.createElement(s.F.Fragment,null,this._visibilityState.view((e=>{switch(e){case"visible":case"fadeOut":return i.createElement(s.F.div,Object.assign({},(0,a.Sh)(!0===this.props.animate?this._getAnimatedTypeClass(e):this._getTypeClass(e),this._getPositionType(this.props.positionType)),{onClick:this.props.onClose?q.Dx(this.props.onClose).pipe(ne.U((e=>()=>(this._onClick(),e())))):this._onClick,onTransitionEnd:()=>{"fadeOut"===e&&this._visibilityState.set("hidden")}}),i.createElement(s.F.div,Object.assign({},(0,a.Sh)(!0===this.props.animate&&this._getContentClass(e))),i.createElement("div",{className:je.scroll},i.createElement(s.F.div,Object.assign({},(0,a.Sh)(this._getAlignmentClass(),this._getSmallResolutionClass())),this.props.children))));case"hidden":return null;default:return(0,c.vE)(e)}})))}_getSmallResolutionClass(){switch(this.props.smallResolution){case"resize":return je.wrapperResize;case"cut":default:return""}}_getAlignmentClass(){switch(this.props.alignment){case"top-center":return je.wrapperTopCenter;case"bottom-right":return je.wrapperBottomRight;case"none":return"";case"center":default:return je.wrapperCenter}}_getTypeClass(e){if("visible"!==e)return je.wrapperTransparent;switch(this.props.overlayType){case"light":return je.wrapperLight;case"transparent":return je.wrapperTransparent;case"dark":default:return je.wrapperDark}}_getPositionType(e){switch(e){case"absolute":return je.wrapperAbsolute;case"fixed":return je.wrapperFixed;default:return(0,c.vE)(e)}}_getAnimatedTypeClass(e){const t="visible"===e;switch(this.props.overlayType){case"light":return he.f.rafSequence(t?[je.wrapperTransparent,je.wrapperLight]:[je.wrapperLight,je.wrapperTransparent],!0);case"transparent":return be.of(je.wrapperTransparent);case"dark":default:return he.f.rafSequence(t?[je.wrapperTransparent,je.wrapperDark]:[je.wrapperDark,je.wrapperTransparent],!0)}}_getContentClass(e){const{contentFaded:t,content:r}=this.props.theme||je,i="visible"===e?[t,r]:[r,t];return he.f.rafSequence(i,!0)}}Se.defaultProps={visible:n.h.create(!0)},Se._activeOverlays=n.h.create(new Set),Se.activeCount=Se._activeOverlays.view((e=>e.size)),Se._index=0;const Ie=e=>i.createElement(Se,Object.assign({},e,{visible:n.h.create(!0),preventClose:!1}),e.children);function Ae({children:e,className:t,close:r}){const n=i.useState("modal-title"+Math.floor(1e3*Math.random()))[0],{ref:o,onMount:c}=V.P.useElWatcher();return V.P.useFocusTrap(o),i.createElement("div",{ref:c,className:je.contentWrapper},i.createElement(s.F.div,Object.assign({},(0,a.Sh)(je.modal,t),{onClick:me.UW(l.Q1),role:"dialog","aria-modal":!0,"aria-labelledby":n}),i.createElement(Ae.TitleIdContext.Provider,{value:n},e),r?i.createElement("div",{className:je.closeIconButtonContainer},i.createElement(m.zx,{name:"modal-close",onClick:r},i.createElement(g.JO.Close,{className:je.closeIcon,width:13}))):null))}!function(e){e.TitleIdContext=i.createContext("modal-title"),e.Header=({children:e,className:t})=>i.createElement(s.F.div,Object.assign({},(0,a.Sh)(je.header,t)),e),e.Body=({children:e,className:t,wrapperClassName:r,name:n})=>{const{ref:o,onMount:l}=V.P.useElWatcher();return i.createElement(de,Object.assign({name:n},(0,a.Sh)(je.scrollBody,r),{showWhenScrollable:!0,update:o.pipe(Z.oA,X.w(Q.YC),we.h(q.PU))}),i.createElement(s.F.div,Object.assign({},(0,a.Sh)(je.body,t),{mount:l}),e))},e.Footer=({children:e,className:t})=>i.createElement(s.F.div,Object.assign({},(0,a.Sh)(je.footer,t))," ",e," ")}(Ae||(Ae={}));const _e={top:0,left:0,display:"flex",flexDirection:"column",overflow:"hidden",width:d.u.percent(100),height:d.u.percent(100),transition:`background ${d.u.seconds(.2)}`,pointerEvents:"auto"},Ce={position:"fixed",zIndex:h.DY},Ee={margin:`${d.u.rem(-.5)} auto auto`},Te={background:"rgba(255, 255, 255, .7)"},xe={background:"rgba(100, 107, 131, .4)"},ke={position:"absolute",top:d.u.rem(.5),right:d.u.rem(.5)},Me={stroke:p.FW},Le={position:"relative",display:"flex",flexDirection:"column",overflow:"hidden",maxHeight:"90vh",borderRadius:d.u.rem(h.Jr),boxShadow:u.uc.Z300},Re={position:"relative",overflow:"hidden",padding:`${d.u.rem(2.5)} ${d.u.rem(2)} ${d.u.rem(1)}`,borderTopLeftRadius:d.u.rem(h.Jr),borderTopRightRadius:d.u.rem(h.Jr),backgroundColor:u.Il.CoreNeutral1},Ne={position:"absolute",top:d.u.px(10),right:"@top"},Ue={padding:d.u.rem(2),backgroundColor:u.Il.CoreNeutral0},De={display:"flex",padding:`0 ${d.u.rem(2)}`,height:d.u.rem(4),border:"0 solid transparent",borderWidth:"0 1px",borderBottomRightRadius:d.u.rem(h.Jr),borderBottomLeftRadius:d.u.rem(h.Jr),backgroundColor:u.Il.CoreNeutral1,alignItems:"center",justifyContent:"flex-end",$nest:{"& > *:not(:last-child)":{marginRight:d.u.rem(.5)}}},Oe={transitionDuration:d.u.seconds(.2),transitionProperty:"opacity, transform",transformOrigin:"center"},Pe={height:d.u.percent(100)},Fe={position:"relative",display:"flex",padding:`${d.u.rem(.5)} 0`,width:"100vw",height:"100vh"},ze={$nest:{[`@media (${h.pZ})`]:{margin:`${d.u.rem(2)} auto auto`}}},je=d.u.prefixedStylesheet("modal",{wrapper:[_e],wrapperFixed:[Ce],wrapperAbsolute:[{position:"absolute"}],wrapperTopCenter:[Ee],wrapperBottomRight:[{margin:"auto 0 0 auto"}],wrapperCenter:[{margin:"auto"}],wrapperLight:[_e,Te],wrapperDark:[_e,xe],wrapperTransparent:[_e,{overflow:"hidden",background:"transparent"}],closeIconButtonContainer:[ke],closeIcon:[Me],modal:[Le],header:[Re],closeBtn:[Ne],body:[Ue],scrollBody:[{position:"relative",flexGrow:1}],footer:[De],contentBase:[Oe],contentFaded:[Oe,{opacity:0,transform:"scale(.8)"}],content:[Oe,{opacity:1,transform:"none"}],contentWrapper:[Pe],scroll:[Fe],wrapperResize:[ze]})},81301:(e,t,r)=>{r.d(t,{dC:()=>i,Iy:()=>n,EQ:()=>g});var i,n,s,a=r(38983),o=r(5114),l=r(8125),c=r(66310),u=r(18625),d=r(95300),p=r(76974),h=r(2834),m=r(40151);!function(e){e.SetGoals="SetGoals",e.Performance="Performance"}(i||(i={})),function(e){e.setGoals=e=>({type:i.SetGoals,source:e}),e.performance={type:i.Performance}}(n||(n={}));class g{constructor(e){this._modalViews=e,this.state=a.h.create(o.none),this._modalFactoryCache=new Map}show(e){return this.preload(e).pipe(c.w((e=>this.showPreloaded(e))))}showPreloaded(e){return u.P((()=>{const t=new d.X("opened");return this.state.set(o.some(e({onClose:()=>{this.state.set(o.none),t.next("closed"),t.complete()}}))),t}))}preload(e){const t=JSON.stringify(e);if(this._modalFactoryCache.has(t)){const e=this._modalFactoryCache.get(t);return p.of(e)}return u.P((()=>this._modalViews.load(e))).pipe(h.b((e=>{this._modalFactoryCache.set(t,e)})))}hideAll(){this.state.set(o.none)}}!function(e){e.Mock=class{constructor(){this.state=a.h.create(o.none),this.hideAll=l.Q1}show(e){return m.E}showPreloaded(e){return m.E}preload(e){return m.E}}}(s||(s={}))},47861:(e,t,r)=>{r.d(t,{i:()=>g});var i=r(27378);if(75==r.j)var n=r(5739);if(75==r.j)var s=r(8125);var a=r(63969),o=r(40219);if(75==r.j)var l=r(63899);if(75==r.j)var c=r(2844);if(75==r.j)var u=r(28043);if(75==r.j)var d=r(77176);if(75==r.j)var p=r(14522);if(75==r.j)var h=r(5802);if(75==r.j)var m=r(50790);const g=({manager:e,views:t,onNotificationClose:r=s.Q1,theme:a={}})=>{const o=function(e,t,r={}){return n=>{const s=e[n.type],a=e=>()=>{n.actions.next(e)};return n.metadata.viewType===h.P.ViewType.standard?i.createElement(m.DI.Wrapper,{key:n.id,notification:n,onClose:()=>{n.actions.next("closedByUser"),t(n)},theme:r},s(n,a)):i.createElement(i.Fragment,{key:n.id},s(n,a))}}(t,r,a.view),g=void 0!==a.grid?Object.assign({},A,a.grid):A,y=e.state.view((e=>e.filter(f(h.P.Position.bottomLeft)))),v=e.state.view((e=>e.filter(f(h.P.Position.bottomRight)))),b=e.state.view((e=>e.filter(f(h.P.Position.top))));return i.createElement(n.F.div,{className:g.container},c.aj(b,v,b,(e=>e.some(p._.isHighPriority))).pipe(u.x(),d.U((e=>e&&i.createElement("div",{className:g.overlay},i.createElement(l.aV,{positionType:"absolute",key:"notificationOverlay",preventClose:!0,overlayType:"light",alignment:"top-center",animate:!0,theme:{content:I.overlayContent,contentFaded:I.overlayContentFaded}}))))),i.createElement(n.F.div,{className:g.bottomLeft},y.view((e=>e.map(o)))),i.createElement(n.F.div,{className:g.bottomRight},v.view((e=>e.map(o)))),i.createElement(n.F.div,{className:g.top},b.view((e=>e.map(o)))))};function f(e){return t=>t.metadata.position===e}const y={position:"fixed",top:0,left:0,zIndex:o.nt,width:a.u.percent(100),height:a.u.percent(100),pointerEvents:"none"},v={position:"absolute",zIndex:o.nt,display:"flex",flexDirection:"column",width:a.u.rem(27),pointerEvents:"auto",alignItems:"flex-end"},b={right:a.u.rem(o.Ig),bottom:a.u.rem(1.5)},w={bottom:a.u.rem(1.5),left:a.u.rem(2)},S={transition:"transform .1s",transformOrigin:"center"},I=a.u.stylesheet({notificationContainer:[y],notificationWrapper:[v],bottomRightNotificationWrapper:[v,b],bottomLeftNotificationWrapper:[v,w],topNotificationWrapper:[v,{top:0,right:0,left:0,margin:"0 auto"}],overlayContentBase:[S],overlayContent:[S,{transform:"none"}],overlayContentFaded:[S,{transform:"scale(.95)"}]}),A={container:I.notificationContainer,bottomLeft:I.bottomLeftNotificationWrapper,bottomRight:I.bottomRightNotificationWrapper,top:I.topNotificationWrapper}},41966:(e,t,r)=>{r.d(t,{r:()=>i});var i,n=r(32952);!function(e){e.createBuilder=function(){return{build:(e,r)=>{const i=t();return{make:(t,s)=>({metadata:e,data:r,args:s,id:i,type:t,actions:new n.xQ})}}}};const t=(()=>{let e=1;return()=>e++})()}(i||(i={}))},14522:(e,t,r)=>{r.d(t,{_:()=>i});var i,n=r(5802);!function(e){e.isHighPriority=function(e){return e.metadata.priority>n.P.Priority.average},e.isCloseAction=function(e){return"timeout"===e||"closedByUser"===e||"closedByNotificationWithMorePriority"===e||"closedByMaxNotificationOnScreen"===e}}(i||(i={}))},61813:(e,t,r)=>{if(r.d(t,{y:()=>w}),75==r.j)var i=r(8125);if(75==r.j)var n=r(81531);if(75==r.j)var s=r(46680);if(75==r.j)var a=r(18625);if(75==r.j)var o=r(80900);if(75==r.j)var l=r(17343);if(75==r.j)var c=r(40151);if(75==r.j)var u=r(95093);if(75==r.j)var d=r(2768);if(75==r.j)var p=r(85985);if(75==r.j)var h=r(8473);if(75==r.j)var m=r(50628);if(75==r.j)var g=r(2834);if(75==r.j)var f=r(9223);if(75==r.j)var y=r(38194);if(75==r.j)var v=r(14522);if(75==r.j)var b=r(5802);class w{constructor(e,t,r,i){this.state=e,this._factory=t,this._maxNotificationsOnScreen=r,this._defaultTimeout=i,this._log=n.C8.Logging.getLogger("notificationsManager")}enqueue(e,t){const r=this._factory[e].make(e,t);return a.P((()=>{const t=r.metadata.timeout!==b.P.TimeoutDisabled?o.H(r.metadata.timeout===b.P.DefaultTimeout?this._defaultTimeout:r.metadata.timeout).pipe(l.h("timeout")):c.E;this.state.modify((e=>{const t=e.filter(((t,i)=>t.metadata.priority<r.metadata.priority?(this._log.debug(`closing ${t.type} notification, ${r.type} have higher priority`),t.actions.next("closedByNotificationWithMorePriority"),!1):t.id!==r.id&&(!(0===i&&e.length>=this._maxNotificationsOnScreen)||(this._log.debug(`closing ${t.type} notification, more than ${this._maxNotificationsOnScreen} notification on the screen`),t.actions.next("closedByMaxNotificationOnScreen"),!1))));return t.push(r),t}));const n=r.actions.pipe(u.T(t.pipe(d.R(r.actions.pipe(p.h(v._.isCloseAction))))));return n.pipe(h.o((0,i.ff)(v._.isCloseAction)),u.T(n.pipe(m.P(v._.isCloseAction))),g.b((t=>{this._log.log(v._.isHighPriority(r)?s.i.WARN:s.i.INFO,`Notification ${e} is ${t}`)})),f.x((()=>{this.state.modify((e=>e.filter((e=>e.id!==r.id))))})),y.B())}))}}},71860:(e,t,r)=>{r.d(t,{X:()=>x});var i,n=r(27378),s=r(57050),a=r(19962),o=r(5114),l=r(44060),c=r(63969),u=r(40219),d=r(70920),p=r(40327),h=r(5739),m=r(25781),g=r(83078),f=r(18625),y=r(49708);!function(e){const t="scrollaction";e.emit=e=>self.dispatchEvent(new CustomEvent(t,{detail:e})),e.observe=f.P((()=>y.R(self,t)))}(i||(i={}));var v=r(98403),b=r(85985),w=r(41398),S=r(24209),I=r(17343),A=r(38194),_=r(598),C=r(50628),E=r(97528);class T extends n.Component{constructor(){super(...arguments),this._subs=[],this._outOfTarget=e=>t=>!a.UL.hasPoint(t.getBoundingClientRect(),e)}componentDidMount(){this._listenTooltipAppearance()}componentWillUnmount(){this._subs.forEach((e=>e.unsubscribe())),this._subs=[],this.context.hide()}render(){return n.createElement(h.F.div,{"data-role":"tooltip"},this.context.state.view(this.props.children))}_listenTooltipAppearance(){const e=y.R(document,"keydown").pipe(b.h((e=>e.keyCode===m.R.ESC_CODE))),t=y.R(document,"mousedown").pipe(w.M(this.context.state),b.h((([e,t])=>(0,p.pipe)(t,o.map((e=>e.target)),o.filter((()=>a.pK(e.target))),g.wo(this._outOfTarget({x:e.clientX,y:e.clientY})))))),r=S.T(e,t,y.R(document,"scroll"),i.observe.pipe(b.h((e=>"show"===e.detail)))).pipe(I.h(v.PU),A.B());this._subs=[this.context.hasContent.pipe(b.h(Boolean),_.c(r.pipe(C.P()))).subscribe(this.context.hide),this.context.hasContent.pipe(b.h(Boolean),_.c(S.T(v.gw(!0,500),r.pipe(I.h(!1))).pipe(C.P())),b.h(Boolean)).subscribe(this.context.show)]}}T.contextType=E.G.Context;const x=()=>n.createElement(T,null,(0,s.ls)(o.map((e=>n.createElement(d.t.ByAbsoluteRect,Object.assign({rect:a.UL.fromEl(e.target),className:L.container},d.t.Alignment.toSelector(e.alignment),{withPin:!0}),n.createElement("div",{className:L.content},e.content)))),o.toNullable)),k={position:"fixed",zIndex:u.DY,pointerEvents:"none",$nest:{"@media print":{visibility:"hidden"}}},M={padding:`${c.u.rem(.25)} ${c.u.rem(1)}`,borderRadius:c.u.rem(u.fx),background:l.Il.BackgroundTooltip,color:l.Il.CoreNeutral1,textAlign:"center",whiteSpace:"nowrap",letterSpacing:c.u.px(.25),fontSize:c.u.rem(.75),lineHeight:c.u.rem(1)},L=c.u.stylesheet({container:[k],content:[M]})},6782:(e,t,r)=>{r.d(t,{Q:()=>i});var i,n=r(40327),s=r(5114);!function(e){e.group=function(e){return Object.values(e.reduce(((e,{group:t,category:r,categoryHuman:i,cost:n})=>(void 0===e[r]&&(e[r]={group:t,category:r,categoryHuman:i,count:0,lensName:"",bundleInfo:s.none}),e[r].count+=n,e)),{})).sort(((e,t)=>t.count-e.count))},e.groupByGroup=function(e){return Object.values(e.reduce(((e,{group:t,category:r,categoryHuman:i,cost:n,lensName:a="",bundleInfo:o=s.none})=>(void 0===e[a]&&(e[a]={group:t,category:r,categoryHuman:i,count:0,lensName:a,bundleInfo:o}),e[a].count+=n,e)),{})).sort(((e,t)=>t.count-e.count))},e.groupByBundleInfo=function(e){return Object.values(e.reduce(((e,{group:t,category:r,categoryHuman:i,cost:a,lensName:o="",bundleInfo:l=s.none})=>{const c=(0,n.pipe)(l,s.getOrElse((()=>i)));return void 0===e[c]&&(e[c]={group:t,category:r,categoryHuman:i,count:0,lensName:o,bundleInfo:l}),e[c].count+=a,e}),{})).sort(((e,t)=>t.count-e.count))}}(i||(i={}))},21311:(e,t,r)=>{r.d(t,{SC:()=>or});var i={};r.r(i),r.d(i,{Schemable:()=>B,URI:()=>j,UnknownArray:()=>S,UnknownRecord:()=>I,WithRefine:()=>G,WithUnion:()=>H,WithUnknownContainers:()=>W,alt:()=>O,array:()=>x,boolean:()=>w,compose:()=>F,id:()=>z,intersect:()=>L,lazy:()=>U,literal:()=>y,nullable:()=>_,number:()=>b,partial:()=>T,readonly:()=>D,record:()=>k,refine:()=>A,string:()=>v,struct:()=>C,sum:()=>N,tuple:()=>M,type:()=>E,union:()=>R,zero:()=>P});var n=r(29909),s=r(57050),a=r(40327),o=r(95195),l=function(e){return{_tag:"Of",value:e}},c=function(e,t){return{_tag:"Concat",left:e,right:t}};var u="required",d="optional",p=function(e,t,r){return{_tag:"Key",key:e,kind:t,errors:r}},h=function(e,t,r){return{_tag:"Index",index:e,kind:t,errors:r}},m=function(e,t){return{_tag:"Member",index:e,errors:t}};function g(){return{concat:c}}var f=r(18164),y=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{is:function(t){return-1!==e.findIndex((function(e){return e===t}))}}},v={is:function(e){return"string"==typeof e}},b={is:function(e){return"number"==typeof e&&!isNaN(e)}},w={is:function(e){return"boolean"==typeof e}},S={is:Array.isArray},I={is:function(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}},A=function(e){return function(t){return{is:function(r){return t.is(r)&&e(r)}}}},_=function(e){return{is:function(t){return null===t||e.is(t)}}},C=function(e){return(0,a.pipe)(I,A((function(t){for(var r in e)if(!(r in t)||!e[r].is(t[r]))return!1;return!0})))},E=C,T=function(e){return(0,a.pipe)(I,A((function(t){for(var r in e){var i=t[r];if(void 0!==i&&!e[r].is(i))return!1}return!0})))},x=function(e){return(0,a.pipe)(S,A((function(t){return t.every(e.is)})))},k=function(e){return(0,a.pipe)(I,A((function(t){for(var r in t)if(!e.is(t[r]))return!1;return!0})))},M=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{is:function(t){return Array.isArray(t)&&t.length===e.length&&e.every((function(e,r){return e.is(t[r])}))}}},L=function(e){return function(t){return{is:function(r){return t.is(r)&&e.is(r)}}}},R=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{is:function(t){return e.some((function(e){return e.is(t)}))}}},N=function(e){return function(t){return(0,a.pipe)(I,A((function(r){var i=r[e];return i in t&&t[i].is(r)})))}},U=function(e){var t=(0,f.H)(e);return{is:function(e){return t().is(e)}}},D=s.yR,O=function(e){return function(t){return{is:function(r){return t.is(r)||e().is(r)}}}},P=function(){return{is:function(e){return!1}}},F=function(e){return function(t){return{is:function(r){return t.is(r)&&e.is(r)}}}},z=function(){return{is:function(e){return!0}}},j="io-ts/Guard",B={URI:j,literal:y,string:v,number:b,boolean:w,nullable:_,type:E,struct:C,partial:T,record:k,array:x,tuple:M,intersect:L,sum:N,lazy:function(e,t){return U(t)},readonly:D},W={UnknownArray:S,UnknownRecord:I},H={union:R},G={refine:A};function $(e){return function(t,r){return{decode:function(i){return t(i)?e.of(i):e.throwError(r(i))}}}}function Y(e){return function(t){return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return{decode:function(n){return y.apply(i,r).is(n)?e.of(n):e.throwError(t(n,r))}}}}}function V(e){return function(t){return function(r){return{decode:function(i){return null===i?e.of(null):e.bimap(r.decode(i),(function(e){return t(i,e)}),(function(e){return e}))}}}}}function Z(e){var t=re(e);return function(r){return function(i){return{decode:function(n){return t(i,(function(t,i){return e.mapLeft(i.decode(n[t]),(function(e){return r(t,e)}))}))}}}}}function Q(e){var t=te(e);return function(r){return function(){for(var i=[],n=0;n<arguments.length;n++)i[n]=arguments[n];return{decode:function(n){return t(i,(function(t,i){return e.mapLeft(i.decode(n[t]),(function(e){return r(t,e)}))}))}}}}}function q(e){return function(t){return function(r){return{decode:function(i){return e.ap(e.map(r.decode(i),(function(e){return function(t){return(0,f.U)(e,t)}})),t.decode(i))}}}}}function X(e){return function(t){return function(r,i){var n=(0,f.H)(i);return{decode:function(i){return e.mapLeft(n().decode(i),(function(e){return t(r,e)}))}}}}}function J(e){return function(t){return function(r){return{decode:function(i){return e.chain(r.decode(i),t.decode)}}}}}var K,ee,te=function(e){return function(t,r){return t.reduce((function(t,i,n){return e.ap(e.map(t,(function(e){return function(t){return e.push(t),e}})),r(n,i))}),e.of([]))}},re=function(e){return function(t,r){var i=Object.keys(t);if(0===i.length)return e.of({});for(var n=e.of({}),s=function(i){n=e.ap(e.map(n,(function(e){return function(t){return e[i]=t,e}})),r(i,t[i]))},a=0,o=i;a<o.length;a++){s(o[a])}return n}},ie=function(e){var t={};for(var r in e){var i=e[r];o.tO(i)&&(t[r]=i.right)}return t},ne=g(),se={URI:o.ov,_E:void 0,map:function(e,t){return(0,a.pipe)(e,o.UI(t))},ap:function(e,t){return o.nM(e)?o.nM(t)?o.t$(ne.concat(e.left,t.left)):e:o.nM(t)?t:o.F2(e.right(t.right))},of:o.F2,chain:function(e,t){return(0,a.pipe)(e,o.tS(t))},throwError:o.t$,bimap:function(e,t,r){return(0,a.pipe)(e,o.Pd(t,r))},mapLeft:function(e,t){return(0,a.pipe)(e,o.Vn(t))},alt:function(e,t){if(o.tO(e))return e;var r=t();return o.nM(r)?o.t$(ne.concat(e.left,r.left)):r}},ae=function(e,t){return l(function(e,t){return{_tag:"Leaf",actual:e,error:t}}(e,t))},oe=(o.F2,function(e,t){return function(e,t){return $(se)(e,(function(e){return ae(e,t)}))}(e.is,t)}),le=Y(se)((function(e,t){return ae(e,t.map((function(e){return JSON.stringify(e)})).join(" | "))})),ce=oe(v,"string"),ue=oe(b,"number"),de=oe(w,"boolean"),pe=oe(S,"Array<unknown>"),he=oe(I,"Record<string, unknown>"),me=V(se)((function(e,t){return c(l(m(0,ae(e,"null"))),l(m(1,t)))})),ge=function(e){return Z(se)((function(e,t){return l(p(e,u,t))}))(e)},fe=function(e){return(0,a.pipe)(he,Ee(ge(e)))},ye=fe,ve=function(e){return function(e){var t=re(e),r=e.of(o.F2(void 0)),i=e.of(o.t$(void 0));return function(n){return function(s){return{decode:function(a){return e.map(t(s,(function(t,s){var l=a[t];return void 0===l?t in a?r:i:e.bimap(s.decode(l),(function(e){return n(t,e)}),(function(e){return o.F2(e)}))})),ie)}}}}}(se)((function(e,t){return l(p(e,d,t))}))(e)},be=function(e){return function(e){var t=te(e);return function(r){return function(i){return{decode:function(n){return t(n,(function(t,n){return e.mapLeft(i.decode(n),(function(e){return r(t,e)}))}))}}}}}(se)((function(e,t){return l(h(e,d,t))}))(e)},we=function(e){return function(e){var t=re(e);return function(r){return function(i){return{decode:function(n){return t(n,(function(t,n){return e.mapLeft(i.decode(n),(function(e){return r(t,e)}))}))}}}}}(se)((function(e,t){return l(p(e,d,t))}))(e)},Se=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Q(se)((function(e,t){return l(h(e,u,t))})).apply(void 0,e)},Ie=q(se),Ae=function(e){return function(t){return function(e){return function(t){return function(r){return function(i){var n=Object.keys(i);return{decode:function(s){var a=s[r];return a in i?i[a].decode(s):e.throwError(t(r,a,n))}}}}}}(se)((function(e,t,r){return l(p(e,u,ae(t,0===r.length?"never":r.map((function(e){return JSON.stringify(e)})).join(" | "))))}))(e)(t)}},_e=X(se)((function(e,t){return l(function(e,t){return{_tag:"Lazy",id:e,errors:t}}(e,t))})),Ce=s.yR,Ee=J(se),Te="io-ts/Decoder",xe={URI:Te,literal:le,string:ce,number:ue,boolean:de,nullable:me,type:ye,struct:fe,partial:function(e){return(0,a.pipe)(he,Ee(ve(e)))},record:function(e){return(0,a.pipe)(he,Ee(we(e)))},array:function(e){return(0,a.pipe)(pe,Ee(be(e)))},tuple:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,a.pipe)(pe,Ee(Se.apply(void 0,e)))},intersect:Ie,sum:function(e){return function(t){return(0,a.pipe)(he,Ee(Ae(e)(t)))}},lazy:_e,readonly:Ce},ke=[],Me=function(e,t){return void 0===t&&(t=ke),{value:e,forest:t}},Le=function(e){return e.value+Re("\n",e.forest)},Re=function(e,t){for(var r,i="",n=t.length,s=0;s<n;s++){var a=s===n-1;i+=e+(a?"└":"├")+"─ "+(r=t[s]).value,i+=Re(e+(n>1&&!a?"│  ":"   "),r.forest)}return i},Ne=(K={Leaf:function(e,t){return Me("cannot decode "+JSON.stringify(e)+", should be "+t)},Key:function(e,t,r){return Me(t+" property "+JSON.stringify(e),Ue(r))},Index:function(e,t,r){return Me(t+" index "+e,Ue(r))},Member:function(e,t){return Me("member "+e,Ue(t))},Lazy:function(e,t){return Me("lazy type "+e,Ue(t))},Wrap:function(e,t){return Me(e,Ue(t))}},function(e){switch(e._tag){case"Leaf":return K.Leaf(e.actual,e.error);case"Key":return K.Key(e.key,e.kind,e.errors);case"Index":return K.Index(e.index,e.kind,e.errors);case"Member":return K.Member(e.index,e.errors);case"Lazy":return K.Lazy(e.id,e.errors);case"Wrap":return K.Wrap(e.error,e.errors)}}),Ue=function(e){for(var t=[],r=e,i=[];;)switch(r._tag){case"Of":i.push(Ne(r.value));var n=t.pop();if(void 0===n)return i;r=n;break;case"Concat":t.push(r.right),r=r.left}},De=function(e){return Ue(e).map(Le).join("\n")},Oe=r(73915),Pe=r(38983),Fe=r(80358),ze=r(84966),je=r(67394),Be=r(89943),We=r(81670),He=r(8125),Ge=r(22232),$e=r(5114),Ye=r(19429),Ve=r(81531),Ze=r(46680),Qe=r(76513),qe=r(4390),Xe=r(20321),Je=r(88570),Ke=r(92843),et=r(68983),tt=r(51653),rt=r(21729),it=r(67434),nt=r(2834),st=r(77176);!function(e){function t(t){return s=>(0,a.pipe)(t,Ke.v.foldMap(e.group)(i,n,r),(0,et.W)(e.group.concat)(s))}e.group=rt.dM.group,e.eq=rt.dM.eq,e.applyDiff=t,e.fromAlerts=function(e){const r=Ve.C8.Logging.getLogger("DocumentCounters");return e.pipe(it.R(((e,r)=>({alerts:r,counters:t(qe.p.Diff.toRegistered(qe.p.diff(e.alerts,r)))(e.counters)})),{alerts:qe.p.empty,counters:rt.dM.group.empty}),nt.b((({counters:e})=>{rt.dM.isValid(e)||r.error("Counters can not be below zero",rt.dM.show.show(e))})),st.U((({counters:e})=>e)))};const r=e=>tt.R.toUnmutedOnly(e.counters),i=(0,s.ls)(r,e.group.inverse),n=(t,n)=>e.group.concat(r(n),i(t))}(ee||(ee={}));var at,ot=r(17771),lt=r(45614),ct=r(93756),ut=r(90329),dt=r(66896),pt=r(26653),ht=r(85985);!function(e){function t(e){const{left:t,right:i}=(0,a.pipe)(e,lt.DZ($e.fromNullable),lt.z7((e=>"GeneralScore"!==e)),lt.Su(((e,t)=>({lensId:r(e),score:pt.T.fromNumber(t)}))),lt.tV((0,ot.Y)(o.wE))),n=(0,a.pipe)(i,lt.UI((({lensId:e,score:t})=>(0,s.bc)(e,t))),(e=>new Map(Object.values(e))));return(0,a.pipe)(ct.Qp($e.fromPredicate((0,s.ff)(lt.xb))(t),$e.fromPredicate((0,s.ff)(ut.xb))(n)),$e.getOrElse((()=>ct.F2(new Map))))}function r(e){return e===dt.R.SpecialId.Plagiarism?o.F2(dt.R.SpecialId.Plagiarism):dt.R.OutcomeId.toOutcomeId(e)}e.empty=new Map,e.eq=ut.Eh(dt.R.Id.ord,pt.T.ord),e.fromCapi=function(e){return e.pipe(ht.h((0,He.Kg)(Fe.h.is("finish"),Fe.h.is("async_check_finished"),Fe.h.is("feedback_ack"))),st.U((e=>e.outcomeScores)),ht.h(He.$K),st.U(t),nt.b(ct.Vn((e=>{lt.xb(e)||Ve.C8.Logging.getLogger("LensesScores").error("failed to parse capi scores",e)}))),ht.h((0,He.Kg)(ct.WP,ct.tO)),st.U((e=>e.right)))}}(at||(at={}));var mt,gt=r(95983),ft=r(98403),yt=r(32952),vt=r(38194),bt=r(77843),wt=r(93508),St=r(95093),It=r(598),At=r(24209),_t=r(23063),Ct=r(17343),Et=r(36919),Tt=r(51374),xt=r(11064),kt=r(23330),Mt=r(25938),Lt=r(64450),Rt=r(37492),Nt=r(51072),Ut=r(71249),Dt=r(26328),Ot=r(70996),Pt=r(32426),Ft=r(36991),zt=function(){function e(e){this._delta=e,this._cursor={index:0,operationOffset:0}}return e.prototype.next=function(e){(0,Ge.kG)(e>=0,"Length cannot be negative");var t=this._cursor.index;if(t>=this._delta.ops.length)return $e.none;for(var r=Ft.s.operationLength(this._delta.ops[t]),i=e-(r-this._cursor.operationOffset);i>0&&t<this._delta.ops.length-1;)t++,i-=r=Ft.s.operationLength(this._delta.ops[t]);return i>0?(this._cursor={index:t+1,operationOffset:0},$e.none):(this._cursor={index:t,operationOffset:r+i},$e.some(this._delta.ops[t]))},e}();!function(e){const t=$e.getMonoid((0,Pt.getObjectSemigroup)());e.getEnrichedWithFormattingDelta=e=>r=>{const i=new zt(e);return r.ops.reduce((([e,r],n)=>{const s=i.next(r);return Ft.s.isInsert(n)?[e.insert(n.insert,$e.toUndefined(t.concat($e.chain(Ft.s.getAttrs)(s),Ft.s.getAttrs(n)))),0]:[e.push(n),Ft.s.operationLength(n)]}),[new Lt.i,1])[0]}}(mt||(mt={}));var jt=r(64015),Bt=r(40018);const Wt=(0,He.HP)(Ve.C8.Logging.getLogger),Ht=(0,s.ls)(jt.UI((({beingAppliedAlert:e,undo:t,reversedAlternative:r})=>kt.Y3((()=>{const i={action:ze.PZ.ACCEPTED,commit:()=>Wt("AlertManager.ops").debug(`_applyTransformJson(${e.toLiteString()}):commit()`),undo:t,reversedAlternative:e.registerReversedAlternative(r)},n=e.switchToApplied(i),s=Bt.xS.create(n.state.from,Ot.h.create(e));return[n.id,s]}),o.KC))),kt.mg);function Gt(e){const t=je.r3.compose(e.alternatives.map(n.UI((e=>e.alternative))),e.currentFullText);return(0,a.pipe)(Ft.s.nonEmpty(t.composedDelta)?$e.some(t):$e.none,$e.map((({composedDelta:t,reversedAlternatives:r})=>({changeWithFormatting:(0,a.pipe)(t,mt.getEnrichedWithFormattingDelta(e.currentFullText),(t=>Mt.RI.delta(t,e.originalTextLength))),correctRevAlternatives:(0,a.pipe)(r,We.T.tapFailure((({rejected:e})=>Ve.C8.Logging.getLogger("AlertManager.ops").error("failed to generate reverse alternative",e))),We.T.foldSuccess(Ut.UI((t=>({reversedAlternative:t.reversedAlternative,alternative:n.li(e.alternatives[t.alternativeIndex]),alert:e.alerts[t.alternativeIndex].alert})))))}))))}var $t;!function(e){const t=(0,s.ls)(((e,t)=>o.Y3((()=>Bt.xS.create(e,t)),o.KC)),o.UI((e=>(0,s.bc)(e[0].id,e))),xt.of);e.prepare=xt.tS((0,s.og)(t)),e.prepareFromAlert=kt.tS((e=>t(e.state.from,Ot.h.create(e))))}($t||($t={}));function Yt(e,t){return o.DT(e,(e=>{const r=new Ge.ej(t,e.toString());return Ve.C8.Logging.getLogger("AlertManager.ops").error(t,r),r}))}const Vt=e=>Yt(Bt.bZ.isNotDisposed,e);function Zt(e){return kt.tS($e.fold((0,s.a9)(kt.F2(void 0)),e))}var Qt;!function(e){e.mock={undoApplied:()=>kt.F2(void 0)}}(Qt||(Qt={}));class qt{constructor(e,t,r,i){this._positionManager=e,this._getContent=t,this._capiClient=r,this._alertsRepo=i,this._log=Ve.C8.Logging.getLogger("AlertManager.ops"),this._sendUpdate=e=>kt.Y3((()=>this.events.next({updated:new Map(e)})),o.KC),this._sendSingleUpdate=kt.tS((e=>this._sendUpdate([e]))),this._flushChanges=kt.Y3((()=>this.changes.next(Mt.RI.flush())),o.KC),this.changes=new yt.xQ,this.events=new yt.xQ,this.undoApplied=(e,t)=>{return(0,a.pipe)((()=>this._positionManager.getTextLength()),xt.tS((t=>{const i={alertsToUpdate:[],reversedDelta:new Lt.i,undo:s.Q1},n=e.filter(Bt.bZ.isApplied).reduce(((e,t)=>{const i=t.state.undoable;return Bt.VD.isWithAlternative(i)?(0,a.pipe)(i.reversedAlternative,$e.fold((()=>{ze.wQ.withTransformJson(t._raw)&&this._log.error("No reversed delta registered for alert",{alert:t.toLiteString()}),r(e,t)}),(0,s.ls)((e=>e()),o.UI((e=>e.delta)),o.g_((e=>{this._log.error("Could not retrieve reversed delta",{e:e,alert:t.toLiteString()})}),(i=>{r(e,t),(0,a.pipe)(i,je.r3.fromRawDelta,(t=>t.rebase(e.reversedDelta)),$e.fold((()=>{e.reversedDelta=e.reversedDelta.compose(i)}),(({delta:t})=>{e.reversedDelta=e.reversedDelta.compose(t)})))}))))):r(e,t),e}),i);return n.alertsToUpdate.length>0?(0,a.pipe)(kt.Y3((()=>{const e=(0,a.pipe)(n.reversedDelta,mt.getEnrichedWithFormattingDelta(this._getContent()));this.changes.next(Mt.RI.delta(e,t))}),o.KC),kt.N(this._flushChanges),kt.N((0,a.pipe)(n.undo,xt.UI(o.F2))),kt.a1((0,a.pipe)(n.alertsToUpdate,kt.mg,kt.tS(this._sendUpdate)))):kt.F2(void 0)})));function r(e,r){e.undo=(0,s.ls)(e.undo,r.state.undoable.undo),e.alertsToUpdate.push($t.prepare((()=>[Ot.h.create(r),Ot.h.create(r.changeState(t===Bt.bZ.State.Applied.Method.ByCard?Bt.bZ.State.init:Bt.bZ.State.Removed.create(Bt.bZ.State.Removed.Reason.bulkAcceptUserResponse)))])))}},this._dismissBatch=(e,t)=>(0,a.pipe)(this._flushChanges,kt.a1((0,a.pipe)(e,Ut.UI((0,s.ls)(xt.of,xt.UI(Vt("Cannot send feedback for already disposed")),kt.tS((e=>this._applyFeedbackToAlert(e,ze.PZ.IGNORE,Bt.l$.sidebar,this._commitFeedbackToCapi(e,{kind:ze.PZ.IGNORE,subtype:t})))),$t.prepareFromAlert)),kt.mg,kt.tS(this._sendUpdate)))),this._applyAlert=({alert:e,replacementText:t,source:r,method:i,feedbackSubtype:n,reason:s,gbPrompt:o})=>(0,a.pipe)(e,Yt(Bt.bZ.isRegistered,"can not apply alert in non registered state"),xt.of,kt.N(this._flushChanges),kt.tS((e=>this._switchToBeingApplied(e,r,i))),kt.tS((({beingAppliedAlert:e,undo:r})=>(0,a.pipe)(e.getReplaceEither.bind(e),kt.LF,kt.Pd((()=>new Error("Cannot apply alert with tJSON")),(i=>{this._log.debug(`_applyAlert(${e.toLiteString()}, rrange: ${i})`);const a=i.start,l=i.end-i.start,c=(new Lt.i).retain(a).delete(t.length).insert(e.replaceText);return{alert:e,undo:r,reverseDelta:c,replacementText:t,removeLen:l,feedbackSubtype:n,pos:a,reason:s,gbPrompt:o}}))))),kt.tS(this._applyAlertData)),this._applyTransformJson=({alerts:e,source:t,method:r,feedbackSubtype:i,drilldownSuggestionIds:n,reason:l,gbPrompt:c})=>(0,a.pipe)(this._flushChanges,kt.a1((0,a.pipe)(e,kt.pE((e=>(0,a.pipe)(e.alternative,kt.UI((t=>(0,s.bc)(t,function(e){switch(e._raw.point){case"AllCapsBoldification":return je.JJ.fromAlternativeBoldified;case"Lists":return je.JJ.fromAlternativeListified;default:return je.JJ.fromAlternative}}(e.alert))))))))),kt.tS((t=>kt.Y3((()=>({alternatives:t,alerts:e,originalTextLength:this._positionManager.getTextLength(),currentFullText:this._getContent()})),o.KC))),kt.UI(Gt),Zt((e=>(0,a.pipe)(e.correctRevAlternatives,Ut.UI((({alert:e,alternative:s,reversedAlternative:o})=>(0,a.pipe)(this._switchToBeingApplied(e,t,r),kt.mU((e=>kt.dk(this._sendApplyTransformJsonFeedback(e.beingAppliedAlert,s.alternativeIndex,i,n,l,c)))),kt.UI((e=>Object.assign(Object.assign({},e),{reversedAlternative:o})))))),kt.mg,kt.tS((t=>(0,a.pipe)(kt.Y3((()=>this.changes.next(e.changeWithFormatting)),o.KC),kt.N(this._flushChanges),xt.a1((0,a.pipe)(Ht(t),kt.tS(this._sendUpdate)))))))))),this._alertFeedback=(e,t,r)=>{this._log.debug(`_alertFeedback(${e.toLiteString()}, feedbackType: ${t.kind}, source: ${r})`),Bt.bZ.isHidden(e)&&this._log.error("Sending feedback for a hidden alert",{alert:e,feedbackType:t.kind});const i=this._commitFeedbackToCapi(e,t);return(0,a.pipe)(e,Vt("Cannot send feedback for already disposed"),xt.of,kt.tS((e=>t.kind!==ze.PZ.LOOKED||e.isRead?ze.nw.willRemoveAlert(t.kind)?(0,a.pipe)(this._flushChanges,kt.a1(this._applyFeedbackToAlert(e,t.kind,r,i)),$t.prepareFromAlert,this._sendSingleUpdate):(0,a.pipe)(i,kt.dk):(0,a.pipe)($t.prepare((()=>[Ot.h.create(e),(e.isRead=!0,Ot.h.create(e))])),this._sendSingleUpdate,xt.N(i)))))},this._alertBatchFeedback=(e,t,r)=>(0,a.pipe)(e,Ut.DZ((e=>e.rawId)),Dt.nI,$e.fold((0,s.a9)(s.Q1),(e=>this._sendFeedback({kind:t,alertIds:e,subtype:r})))),this._notifyAlertUpdated=(0,s.ls)((e=>[[e[0].id,e]]),this._sendUpdate),this._releaseRef=(e,t)=>(0,a.pipe)(kt.Y3((()=>{this._log.debug(`_releaseRef ${e} on (${t.toLiteString()}) refs: ${t._refNames}`,{shouldBeRemoved:Bt.bZ.shouldBeRemoved(t)}),Bt.bZ.shouldBeRemoved(t)&&this.events.next({removed:new Map([[t.id,Ot.h.create(t)]])})}),o.KC)),this._changeMuteState=(e,t)=>{const r=(0,a.pipe)(e,We.T.fromArray((0,s.ls)(Vt("Cannot send Mute feedback for already disposed"),o.tS(Yt((e=>$e.isSome(e.muteCategory)||Bt.bZ.belongsToAnySpecialCategory(e)),"Alert is not muting")))));return(0,a.pipe)(r,We.T.foldSuccess(Ut.UI((e=>$t.prepare((()=>[Ot.h.create(e),(e.mute=t,Ot.h.create(e))]))))),kt.mg,kt.UI(Dt.nI),Zt(this._sendUpdate),kt.UI((0,s.a9)(r)))},this._changeGapValue=(e,t)=>(0,a.pipe)(e,Yt(Bt.bZ.isOneGap,"can not change gap value for a non one gap alert"),xt.of,kt.tS((e=>$t.prepare((()=>[Ot.h.create(e),Ot.h.create(e.changeGapValue(t))])))),this._sendSingleUpdate),this._confirmApplied=(0,s.ls)(Ut.UI((e=>$t.prepare((()=>[Ot.h.create(e),Ot.h.create(e.changeState(Bt.bZ.State.Removed.create(Bt.bZ.State.Removed.Reason.bulkAcceptUserResponse)))])))),kt.mg,kt.tS(this._sendUpdate)),this._changeTakeawayFeedback=(e,t)=>(0,a.pipe)(e,Yt(Bt.bZ.isTakeaway,"can not change feedback for non-takeaway alert"),xt.of,kt.tS((e=>{const r=Ot.h.create(e),i=e.setFeedback(t),n=Ot.h.create(i);return(0,a.pipe)($t.prepare((()=>[r,n])),this._sendSingleUpdate,kt.UI((()=>i)))}))),this._shortenItSummaryNotFound=e=>(0,a.pipe)(e,Vt("Cannot change state to not-found for already disposed"),o.tS(Yt(Bt.bZ.isShortenIt,"cannot change state to not-found for a non shorten-it alert")),xt.of,kt.tS((e=>{const t=Ot.h.create(e),r=e.changeSummaryState("notFound"),i=Ot.h.create(r);return(0,a.pipe)($t.prepare((()=>[t,i])),this._sendSingleUpdate,kt.UI((()=>r)))}))),this._commitShortenItSummaryRequest=e=>(0,a.pipe)(e,Vt("Cannot send shorten_it_submit message for already disposed"),o.tS(Yt(Bt.bZ.isShortenIt,"cannot send shorten_it_submit for a non shorten-it alert")),xt.of,kt.tS((e=>{const t=Ot.h.create(e),r=e.changeSummaryState("requestSent"),i=Ot.h.create(r);return(0,a.pipe)($t.prepare((()=>[t,i])),this._sendSingleUpdate,kt.UI((()=>r)),xt.N(this._commitShortenItSubmitToCapi(e)))}))),this._dismissShortenItTransformGroup=(e,t)=>(0,a.pipe)(e,Vt("Cannot dismiss transform group for already disposed"),o.tS(Yt(Bt.bZ.isShortenIt,"cannot dismiss transform group for a non shorten-it alert")),xt.of,kt.tS((e=>{const r=Ot.h.create(e),i=e.dismissTransformGroup(t),n=Ot.h.create(i);return(0,a.pipe)($t.prepare((()=>[r,n])),this._sendSingleUpdate,kt.UI((()=>i)))}))),this._changeToneAIToneAlternative=(e,t)=>(0,a.pipe)(e,Yt(Bt.bZ.isToneAI,"Cannot change tone for a non-ToneAI alert."),xt.of,kt.tS((e=>kt.Y3((()=>{const r=[(0,s.bc)(e.id,Bt.xS.create(Ot.h.create(e),Ot.h.create(e.setSelectedToneAlternativeIdx(t))))];return this.events.next({updated:new Map(r)}),e}),o.KC)))),this._changeSentenceLevelBrandTonesFeedback=(e,t)=>(0,a.pipe)(e,Yt(Bt.bZ.isSentenceLevelBrandTones,"Cannot change feedback for a non-Sentence Level Brand Tones alert."),xt.of,kt.tS((e=>kt.Y3((()=>{const r=[(0,s.bc)(e.id,Bt.xS.create(Ot.h.create(e),Ot.h.create(e.setFeedback(t))))];return this.events.next({updated:new Map(r)}),e}),o.KC)))),this._handleCapiError=e=>t=>{Rt.EP.isDroppedError(t)?this._log.debug(`Stopped listening for ${e} message acknowledge`,t):Rt.YG.isNotConnectedError(t)?this._log.warn(`Failed to send ${e} as CAPI was not connected`,t):this._log.error(`Failed to send ${e}`,t)},this._applyAlertData=({pos:e,removeLen:t,reverseDelta:r,undo:i,replacementText:n,alert:s,feedbackSubtype:l,reason:c,gbPrompt:u})=>(0,a.pipe)(kt.Y3((()=>{let a=this._positionManager.getTextLength(),o=!1;const d={action:ze.PZ.ACCEPTED,replacement:n,commit:()=>{o||this._log.debug(`_applyAlert(${s.toLiteString()}):commit()`)},reversedAlternative:$e.none,undo:()=>{o=!0,this._log.debug(`_applyAlert(${s.toLiteString()}):undo()`);const e=this._positionManager.getTextLength();e!==a&&this._log.error(`Text has changed while uncommitted apply is present. Expected: ${a}, actual: ${e}`);const t=Mt.RI.delta(r,e);this.changes.next(t),this.changes.next(Mt.RI.flush()),i()}};return this._sendApplyTextFeedback(s,n,l,c,u)(),this.changes.next(Mt.RI.delta((new Lt.i).retain(e).delete(t).insert(n),a)),this.changes.next(Mt.RI.flush()),a=this._positionManager.getTextLength(),d}),o.KC),kt.tS((e=>kt.Y3((()=>s.switchToApplied(e)),o.KC))),$t.prepareFromAlert,this._sendSingleUpdate),this._sendApplyFeedback=(e,t)=>e.state.method===Bt.bZ.State.Applied.Method.ByCard?this._commitFeedbackToCapi(e,t):s.Q1,this._sendApplyTextFeedback=(e,t,r,i,n)=>this._sendApplyFeedback(e,{kind:ze.PZ.ACCEPTED,replacementText:t,subtype:r,reason:i,gbPrompt:n}),this._sendApplyTransformJsonFeedback=(e,t,r,i,n,s)=>{const a={kind:ze.PZ.ACCEPTED,alternativeIndex:t,subtype:r,drilldownSuggestionIds:i,reason:n,gbPrompt:s},o=Bt.bZ.isOneGap(e)?Object.assign(Object.assign({},a),{gapValue:e.gapValue}):Bt.bZ.isShortenIt(e)?Object.assign(Object.assign({},a),{dismissedTransformGroups:Array.from(e.dismissedTransformGroups)}):a;return this._sendApplyFeedback(e,o)}}_applyFeedbackToAlert(e,t,r,i){return kt.Y3((()=>{this._alertsRepo.removeFromCapiMapping(e);const n=this._createFeedbackUndoable(e,t,i);return e.changeState(Bt.bZ.State.Applied.create(n,r,Bt.bZ.State.Applied.Method.ByCard,Ot.h.create(e)))}),o.KC)}_createFeedbackUndoable(e,t,r){return{action:t,replacement:e.replaceText,commit:r,undo:()=>this._alertsRepo.addToCapiMapping(e)}}_commitFeedbackToCapi(e,t){return(0,a.pipe)(e.rawId,$e.fold((0,s.a9)((()=>this._log.debug("skip feedback for local alert",e))),(e=>this._sendFeedback(Object.assign({id:e},t)))))}_sendFeedback(e){return()=>{Nt.Vi(this._capiClient.sendFeedback(e)).catch(this._handleCapiError("alert feedback"))}}_commitShortenItSubmitToCapi(e){return(0,a.pipe)(e.rawId,$e.fold((0,s.a9)((()=>this._log.debug("skip shorten-it-submit for local alert",e))),(e=>this._shortenItSubmit(e))))}_shortenItSubmit(e){return()=>{Nt.Vi(this._capiClient.shortenItSubmit(e)).catch(this._handleCapiError("shorten-it-submit"))}}_switchToBeingApplied(e,t,r){return kt.Y3((()=>(this._alertsRepo.removeFromCapiMapping(e),e.switchToBeingAppliedState(t,r))),o.KC)}}var Xt,Jt,Kt,er,tr,rr=r(83078);!function(e){e.toString=o.g_((({id:e})=>`rid:${e}`),(e=>`aid:${e.toString()}`))}(Xt||(Xt={})),function(e){e.match=function(e){return t=>t instanceof Bt.Ev?e.alertAddOrUpdate(t):t instanceof Map?e.rangeChange(t):"_tag"in t?e.alertRemove(t):e.alertChange(t)}}(Jt||(Jt={})),function(e){e.defaultValidator=Bt.bZ.isDuplicatedBy}(Kt||(Kt={}));class ir{constructor(e,t,r){this._positionManager=e,this._alertsRepo=t,this._alertDuplicateValidator=r,this._log=Ve.C8.Logging.getLogger("AlertManager.pipeline",Ze.i.DEBUG),this._heuristicallyRemovedAlerts=new Map,this.process=e=>(this._log.trace(`process, to process = ${e.length}`),this._collectChanges(this._processAlertsBatch(e))),this.reset=e=>(this._cleanupPendingAlerts(e),this._finishAlertsChecking()),this._processAlertsBatch=e=>{const{toAdd:t,toUpdate:r,toAddOrUpdate:i,toRemoveUnfiltered:n,toChangeUnfiltered:l,toDispose:c,rangeChanges:u}=this._processBatch(e),d=e=>(0,a.pipe)(this._alertsRepo.getByAlertId(e),$e.getOrElse((()=>t.get(e)||r.get(e)||c.get(e))));l.forEach((e=>(0,a.pipe)($e.fromNullable(i.get(e.id)),$e.fold((()=>(0,a.pipe)(this._alertsRepo.getByRawAlertId(e.id),$e.map((t=>{const n=t.copy(!1),s=ir._prepareUpdate(n,e);$e.isSome(e.transformJson)?n.updateAlertWithManagedData(s):n.patchWithRawAlert(s),r.set(n.id,n),i.set(e.id,n)})),$e.getOrElse((()=>this._log.info("Change from CAPI: Cannot find internal AlertId."))))),(t=>{const i=ir._prepareUpdate(t,e);r.has(t.id)?t.patchWithRawAlert(i):t.updateAlertWithManagedData(i)})))));const p=n.reduce(((e,n)=>{const s=(0,a.pipe)(n,o.g_((({id:e})=>(0,a.pipe)(this._alertsRepo.getByRawAlertId(e),$e.map((e=>Bt.bZ.isRegistered(e)?e:void 0)),$e.getOrElse((()=>this._heuristicallyRemovedAlerts.has(e)?void this._heuristicallyRemovedAlerts.delete(e):i.get(e))))),d));return void 0===s?(o.nM(n)?this._log.debug("Remove from CAPI: Cannot find internal AlertId. capiId: #"+JSON.stringify(n.left)):this._log.error("Cannot find existing alert by id",n.right),e):((0,a.pipe)(this._getMergeTarget(n,i),$e.filter(nr((e=>e.lensId!==s.lensId?(this._log.warn("Trying to merge alerts from different lenses",{source:s,target:e}),!1):$e.isNone(s.rawId)?(this._log.warn("Trying to merge into local alert",{source:s,target:e}),!1):s.references>e.references))),$e.fold((()=>{e.set(s.id,{alert:s,reason:(0,a.pipe)(n,o.LF,$e.fromEither,$e.chain((e=>e.hint)),$e.chain((e=>e===Fe.A.NotFixed?$e.some(Bt.bZ.State.Removed.Reason.capiDismiss):$e.none)),$e.getOrElse((()=>Bt.bZ.State.Removed.Reason.capiDone)))})}),o.g_((e=>{this._log.debug("swap raw alerts with new alert",{source:s.toString(),newTarget:e.toString()}),this._alertsRepo.swapRaw(s,e);const n=rr.MH(s.rawId);(0,Ge.kG)(void 0===r.get(e.id),"Added alert should not be present in the updated alerts map",(()=>r.get(e.id).toString()));const a=s.copy();r.set(a.id,a),i.set(n,a),t.delete(e.id),c.set(e.id,e)}),(t=>{this._log.debug("swap raw alerts with existing alert",{source:s.toString(),existingTarget:t.toString()}),this._alertsRepo.swapRaw(s,t),e.set(t.id,{alert:t,reason:Bt.bZ.State.Removed.Reason.capiDismiss})})))),e)}),new Map),h=new Map;return u&&u.forEach(((e,t)=>{(0,a.pipe)(t,d,$e.fromPredicate((i=>i?Bt.bZ.isInteractable(i)?!r.has(i.id)||(this._log.debug("skip range change on updateHolder alert",i.toLiteString()),!1):(this._log.debug("skip range change on non-interactable alert",i.toLiteString()),!1):(this._log.warn("got range changes for unknown alert",{alertId:t,alertRanges:e}),!1))),$e.chain((r=>(0,a.pipe)(r.onRangeChange(e),$e.map((e=>{switch(e.state){case Bt.bZ.Transition.State.Pending:return h.set(r.id,[r,e.removedRanges]);case Bt.bZ.Transition.State.Dispose:return(0,a.pipe)(r.rawId,$e.fold((()=>this._log.debug("dispose by range change on unknown rid",r.id)),(e=>this._heuristicallyRemovedAlerts.set(e,r)))),p.set(t,{alert:r,reason:Bt.bZ.State.Removed.Reason.textChange});default:return(0,Ge.vE)(e)}}))))))})),p.forEach((({alert:e})=>{this._log.trace("check cancellations from toRemove: "+e.toLiteString()),(0,a.pipe)(e.rawId,$e.fold((()=>{t.get(e.id)&&(this._log.debug("cancel add local alert for: "+e.toLiteString()),t.delete(e.id),p.delete(e.id),c.set(e.id,e)),(0,Ge.kG)(!1===r.has(e.id),"Added local alert should not be present in the updated alerts map",(()=>r.get(e.id).toString()))}),(n=>{const s=i.get(n);s&&(i.delete(n),t.delete(s.id)?(this._log.debug("cancel add for: "+s.toLiteString()),this._log.debug("cancel remove for: "+e.toLiteString()),p.delete(e.id),c.set(e.id,e),c.set(s.id,s)):r.delete(s.id)?(this._log.debug("cancel update for: "+s.toLiteString()),s.id!==e.id&&(this._log.debug("marking update to dispose: "+s.toLiteString()),c.set(s.id,s))):this._log.error("_addOrUpdateAlert toAdd || toUpdate mapping in unsync state!",s))}))),this._log.trace("check if local orphan toRemove: "+e.toLiteString()),(0,a.pipe)(this._alertsRepo.getByAlertId(e.id),$e.fold((()=>{this._log.debug("cancel delete for: "+e.toLiteString()),p.delete(e.id)}),s.Q1))})),c.size>0&&this._log.debug(`_cancelAlerts, to cancel = ${c.size}`,{alerts:Array.from(c.values()).map((e=>e.toLiteString()))}),c.forEach((e=>{h.delete(e.id)&&this._log.debug("cancel startChecking for: "+e.toLiteString());try{e.dispose()}catch(t){this._log.warn("unexpected error on disposing canceled alert",t,e)}})),{toAdd:t,toUpdate:r,toRemove:p,toStartChecking:h}},this._collectChanges=({toAdd:e,toUpdate:t,toRemove:r,toStartChecking:i})=>{const{alertsToAdd:n,alertsToUpdate:s,alertsToRemove:a}=this._addAlerts(Array.from(e.values()),r);return t.size>0&&this._updateAlerts(Array.from(t.values()),s),i.size>0&&this._startAlertsChecking(Array.from(i.values()),s,n),a.size>0&&this._removeAlerts(a,s),{added:n,updated:s}},this._validateAlertAdd=e=>{try{const t=!Bt.bZ.isPremium(e)||void 0!==e.categoryHuman;return e._raw.impact!==ze.wQ.Impact.Critical&&e._raw.impact!==ze.wQ.Impact.Advanced&&$e.isSome(e.rawId)&&this._log.warn("CAPI provides corrupted impact prop",{alert:e,raw:ze.wQ.clearUserTextFields(e._raw)}),t||(this._log.error("CAPI provides corrupted alert",{alert:e,raw:ze.wQ.clearUserTextFields(e._raw)}),e.dispose()),(0,a.pipe)(e.rawId,$e.exists((e=>$e.isSome(this._alertsRepo.getByRawAlertId(e)))))?(this._log.warn("unexpected overlap on rawId for non-updatable alert",{alert:e,raw:ze.wQ.clearUserTextFields(e._raw)}),e.dispose(),!1):e.lensType===dt.R.Type.Plagiarism&&pt.T.isMax(e.progress)?(this._log.info("CAPI provides a Plagiarism alert with an invalid progress",{alert:e,raw:ze.wQ.clearUserTextFields(e._raw)}),e.dispose(),!1):t}catch(t){this._log.error("Cannot validate alert",t);try{e.dispose()}catch(e){this._log.warn("Cannot dispose invalid alert",e)}return!1}},this._recheckedAlerts=new Set,this._terminateAlertChecking=({id:e})=>{this._recheckedAlerts.delete(e)&&this._log.debug("Stopped watching checking state for alert",e)},this._applyRemoveToAlert=({alert:e,reason:t})=>(this._alertsRepo.removeFromCapiMapping(e),t!==Bt.bZ.State.Removed.Reason.textChange&&e.clearCapiId(),e.changeState(Bt.bZ.State.Removed.create(t))),this._finishAlertChecking=e=>{(0,Ge.kG)(this._recheckedAlerts.delete(e.id),"tried to finish checking on alert which had not been marked as checking"),this._log.debug("Stopped watching checking state for alert",e.id);const t=Ot.h.create(e);return Bt.xS.create(t,Ot.h.create(e.changeState(Bt.bZ.State.Registered.create(Bt.bZ.CheckingState.IDLE))))}}static _prepareUpdate(e,t){const r=Object.assign(Object.assign({},e.toRawAlert()),{rev:t.rev});return ze.wQ.withTransformJson(r)&&(0,a.pipe)(t.transformJson,rr.bw((e=>r.transformJson=e))),(0,a.pipe)(t.extraProperties,rr.bw((e=>r.extra_properties=e))),(0,a.pipe)(t.muted,rr.bw((e=>r.muted=e))),(0,a.pipe)(t.sdui,rr.bw((e=>r.sdui=e))),r}_processBatch(e){return e.reduce(((e,t)=>(Jt.match({alertAddOrUpdate:t=>{(0,a.pipe)(t.rawId,$e.fold((()=>{e.toAdd.set(t.id,t)}),(r=>{(0,a.pipe)(this._alertsRepo.getByRawAlertId(r),$e.filter((e=>e.allowUpdate)),$e.map((()=>{(0,a.pipe)($e.fromNullable(e.toAddOrUpdate.get(r)),$e.map((t=>{this._log.debug("got overlap in batch on update"),e.toUpdate.delete(t.id),e.toDispose.set(t.id,t)}))),e.toUpdate.set(t.id,t)})),$e.getOrElse((()=>{(0,a.pipe)($e.fromNullable(e.toAddOrUpdate.get(r)),$e.map((t=>{this._log.info("got overlap in batch on add"),e.toAdd.delete(t.id),e.toDispose.set(t.id,t)}))),e.toAdd.set(t.id,t)}))),e.toAddOrUpdate.set(r,t)})))},rangeChange:t=>{(0,Ge.kG)(void 0===e.rangeChanges,"unexpected rangeChanges duplicate"),e.rangeChanges=t},alertRemove:t=>{e.toRemoveUnfiltered.push(t)},alertChange:t=>{e.toChangeUnfiltered.push(t)}})(t),e)),{toAdd:new Map,toRemoveUnfiltered:[],toChangeUnfiltered:[],toUpdate:new Map,toAddOrUpdate:new Map,rangeChanges:void 0,toDispose:new Map})}_getMergeTarget(e,t){return(0,a.pipe)(e,o.LF,$e.fromEither,$e.chain((e=>e.mergedIn)),$e.chain((e=>{const r=(0,a.pipe)(this._alertsRepo.getByRawAlertId(e),$e.map((e=>o.F2(e))),$e.alt((()=>(0,a.pipe)($e.fromNullable(t.get(e)),$e.map((e=>o.t$(e)))))));return $e.isNone(r)&&this._log.warn("Merge from CAPI: Cannot find alert to merge into.",{capiId:e}),r})),$e.filter(nr((e=>!!e.allowUpdate||(this._log.warn("Merge from CAPI: Trying to merge in a non-updatable alert, skipping. ",{target:e.toLiteString()}),!1)))))}_addAlerts(e,t){return e.length>0&&this._log.debug("_addAlerts, count = "+e.length,{alerts:e.map((e=>e.toLiteString()))}),(0,a.pipe)(e,Ut.hX(this._validateAlertAdd),Ut.u4({alertsToAdd:new Map,alertsToUpdate:new Map,alertsToRemove:t},((e,t)=>{this._log.trace("Adding alert: "+t.toLiteString());const r=this._getAlertsWithMatchingRanges(t.getHighlightRanges()[0]),i=this._tryToMatchInvalid(t,r);switch(this._log.trace("Adding alert match result",{inc:t.id,match:i}),i.type){case er.Type.Merged:{const r=i.result[1];Bt.bZ.isNotRegistered(r.alert)?Bt.bZ.isRemoved(r.alert)&&this._log.warn("unexpected merge into removed alert",{alert:r,newAlert:t}):this._alertsRepo.addToCapiMapping(r.alert),e.alertsToUpdate.set(r.id,i.result);break}case er.Type.Restored:{const t=i.result[1];(0,Ge.kG)(!e.alertsToRemove.has(t.id),"can't update alert which we wanted to remove earlier"),this._alertsRepo.addToCapiMapping(t.alert),e.alertsToUpdate.set(t.id,i.result);break}case er.Type.Unmatched:{const n=i.result,s=r.filter((t=>Bt.bZ.isDuplicateCandidate(t)&&this._alertDuplicateValidator(n,t)&&!e.alertsToRemove.has(t.id)));(0,Ge.kG)(n.allowDuplicates||Bt.bZ.isApplicableAlert(n),"BaseAlertImpl must allow duplicates or be an ApplicableAlert type"),s.length>0&&this._log.info("Trying to add a duplicated alert",{newAlert:t.toString(),duplicates:s.map((e=>e.toString()))});const o=n.allowDuplicates?{result:tr.Add,toRemove:$e.none}:this._tryAddAlert(n,s);switch(o.result){case tr.Add:case tr.OverwriteExisting:this._log.debug("AllAlerts: Append alert to all alerts",n.toLiteString()),this._alertsRepo.addToCapiMapping(n),(0,Ge.kG)(!e.alertsToRemove.has(n.id),"can't add alert which we wanted to remove earlier",(()=>n.toLiteString())),this._alertsRepo.add(n),e.alertsToAdd.set(n.id,Ot.h.create(n)),(0,a.pipe)(o.toRemove,rr.bw((t=>{if(e.alertsToAdd.has(t.id)){this._alertsRepo.removeFromCapiMapping(t);const e=t.changeState(Bt.bZ.State.Removed.create(Bt.bZ.State.Removed.Reason.canceled));this._terminateAlertChecking(e),this._alertsRepo.remove(e)}else this._log.debug("schedule to remove duplicate",t.toLiteString()),e.alertsToRemove.set(t.id,{alert:t,reason:Bt.bZ.State.Removed.Reason.duplicated});e.alertsToAdd.delete(t.id),e.alertsToUpdate.delete(t.id)})));break;case tr.Skip:this._log.debug("Skip alert with low priority",n.id);break;default:(0,Ge.vE)(o.result)}break}default:(0,Ge.vE)(i)}return e})))}_updateAlerts(e,t){this._log.debug(`_updateAlerts, to update = ${e.length}`,{alerts:e.map((e=>e.toLiteString()))}),(0,a.pipe)(e,Ut.u4(t,((e,t)=>(this._log.trace("Updating alert: "+t.toLiteString()),(0,a.pipe)(this._alertsRepo.getByRawAlertId(rr.MH(t.rawId)),$e.fold((()=>this._log.warn("tried to update unknown alert",t)),(r=>{const i=t._raw;t.dispose();const n=e.has(r.id)?e.get(r.id)[0]:Ot.h.create(r);r.enqueueRawAlertForUpdate(i),e.set(r.id,Bt.xS.create(n,Ot.h.create(r)))}))),e))))}_startAlertsChecking(e,t,r){this._log.debug(`_startAlertsChecking, to update = ${e.length}`,{alerts:e.map((([e,t])=>[e.toLiteString(),t]))});const i=(e,t)=>{const r=e.changeState(Bt.bZ.State.Registered.create(Bt.bZ.CheckingState.CHECKING));return this._recheckedAlerts.add(e.id),Ot.h.create(t.size>0?r.enqueueRangesRemove(t):r)};(0,a.pipe)(e,Ut.u4({updatedAlerts:t,addedAlerts:r},((e,[t,r])=>((0,a.pipe)(this._alertsRepo.getByAlertId(t.id),$e.fold((()=>{this._log.warn("tried to start checking unknown alert",{alert:t,ranges:r})}),(()=>{if(e.addedAlerts.has(t.id))e.addedAlerts.set(t.id,i(t,r));else{const n=e.updatedAlerts.has(t.id)?e.updatedAlerts.get(t.id)[0]:Ot.h.create(t);e.updatedAlerts.set(t.id,Bt.xS.create(n,i(t,r)))}}))),e))))}_removeAlerts(e,t){e.forEach(((e,r)=>{(0,a.pipe)(this._alertsRepo.getByAlertId(r),$e.fold((()=>{this._log.warn("tried to remove unknown alert",e)}),(()=>{const i=t.has(r)?t.get(r)[0]:Ot.h.create(e.alert),n=this._applyRemoveToAlert(e);this._terminateAlertChecking(n),t.set(r,Bt.xS.create(i,Ot.h.create(n)))})))}))}_getAlertsWithMatchingRanges(e){return(0,a.pipe)(this._positionManager.findIntersections(e),Ut.hX((0,He.W9)(Tt.P.is,Tt.x.isVisible)),Ut.DZ((e=>this._alertsRepo.getByAlertId(e.meta.alertId))),Ut.hX((e=>!(Bt.bZ.isApplied(e)&&e.getAppliedRanges().length>0))))}_tryToMatchInvalid(e,t){return(0,Ge.kG)(!e.isValid,"added alert should be invalid"),(0,Ge.kG)(Bt.bZ.isRegistered(e),"added alert should be in registered state",(()=>e.toString())),(0,a.pipe)($e.fromNullable(t.find((t=>!t.isValid&&t.canBeMergedWith(e)))),$e.fold((()=>({result:e,type:er.Type.Unmatched})),(t=>{(0,Ge.kG)((0,a.pipe)(t.rawId,rr.wo((0,s.ls)(this._alertsRepo.getByRawAlertId,$e.isNone))),"CAPI mapping should not contain invalid alerts"),this._log.debug(`Merging new alert (${e}) into the existing one aid(${t})`);const r=Ot.h.create(t);return t.patchWithRawAlert(e._raw),e.dispose(),t.allowUpdate&&Bt.bZ.isCapiDone(t)?{result:Bt.xS.create(r,Ot.h.create(t.changeState(Bt.bZ.State.init))),type:er.Type.Restored}:{result:Bt.xS.create(r,Ot.h.create(t)),type:er.Type.Merged}})))}_tryAddAlert(e,t){return(0,a.pipe)(Dt.nI(t),$e.map((t=>{(0,Ge.kG)(1===t.length,"Only one visible alert to one range is expected while _tryEnqueueAlert",`got ${t.map((e=>e.toString()))} with input (${e.toString()})`);const r=t[0];return r.extraProperties.priority<=e.extraProperties.priority?{result:tr.OverwriteExisting,toRemove:$e.some(r)}:(e.dispose(),{result:tr.Skip,toRemove:$e.none})})),$e.getOrElse((()=>({result:tr.Add,toRemove:$e.none}))))}_cleanupPendingAlerts(e){e.removed.forEach((e=>{this._heuristicallyRemovedAlerts.delete(e)&&this._log.info("unexpected alert remove from finish msg",e)})),this._heuristicallyRemovedAlerts.size>0&&this._log.info("we had heuristically removed alerts which were not confirmed by capi",{size:this._heuristicallyRemovedAlerts.size}),this._heuristicallyRemovedAlerts.clear()}_finishAlertsChecking(){return(0,a.pipe)(Array.from(this._recheckedAlerts.values()),Ut.DZ((e=>{const t=this._alertsRepo.getByAlertId(e);$e.isNone(t)&&(this._log.error("tried to finish checking on missing alert",e),this._recheckedAlerts.delete(e));const r=(0,a.pipe)(t,$e.filter((e=>Bt.bZ.isRegistered(e))),$e.map((e=>(0,s.bc)(e.id,this._finishAlertChecking(e)))));return $e.isNone(r)&&this._log.error("tried to update checking state on non-registered alert",e),r})),(e=>({updated:new Map(e)})))}}function nr(e){return o.g_(e,e)}!function(e){let t;!function(e){e.Unmatched="Unmatched",e.Merged="Merged",e.Restored="Restored"}(t=e.Type||(e.Type={}))}(er||(er={})),function(e){e.Skip="Skip",e.Add="Add",e.OverwriteExisting="OverwriteExisting"}(tr||(tr={}));class sr{constructor(){this._log=Ve.C8.Logging.getLogger("AlertManager.repository",Ze.i.DEBUG),this._allAlerts=new Map,this._capiAlertsIdMapping=new Map,this.add=e=>{this._allAlerts.set(e.id,e)},this.remove=e=>{this._log.trace("AllAlerts: Clean alert from all alerts",e.toLiteString()),(0,Ge.kG)(0===e.references,"can not dispose alert in use",(()=>e.toString())),(0,Ge.kG)(!1===e.isValid,"can not dispose valid alert",(()=>e.toString())),(0,Ge.kG)(this._allAlerts.delete(e.id),"alert should exist in alerts list",(()=>e.toString())),e.dispose()},this.addToCapiMapping=e=>{e.isValid||(0,a.pipe)(e.rawId,$e.fold((()=>this._log.debug("skip register of local alert in capi mapping",e)),(t=>{this._log.trace("register alert in capi mapping",e.toLiteString()),(0,Ge.kG)(void 0===this._capiAlertsIdMapping.get(t),"unexpected overlap of rawid alert",(()=>e.toString())),e.validate(),this._capiAlertsIdMapping.set(t,e.id)})))},this.removeFromCapiMapping=e=>{e.isValid&&((0,a.pipe)(e.rawId,rr.bw((t=>{this._log.trace("clean valid alert capi mapping for: "+e.toLiteString()),(0,Ge.kG)(this._capiAlertsIdMapping.delete(t),"valid alert should had valid raw id",(()=>e.toString()))}))),e.invalidate())},this.getByAlertId=e=>$e.fromNullable(this._allAlerts.get(e)),this.getByRawAlertId=e=>(0,a.pipe)($e.fromNullable(this._capiAlertsIdMapping.get(e)),$e.chain(this.getByAlertId)),this.swapRaw=(e,t)=>{const r=(0,a.pipe)(e.rawId,$e.exists((e=>this._capiAlertsIdMapping.has(e)))),i=(0,a.pipe)(e.rawId,$e.exists((e=>this._capiAlertsIdMapping.has(e))));(0,Ge.kG)(r||i,"At least one of the swapped alerts should be registered in the system");const n=e._raw;e.silentPatchWithRawAlert(t._raw),t.silentPatchWithRawAlert(n),r&&this._capiAlertsIdMapping.set(rr.MH(e.rawId),e.id),i&&this._capiAlertsIdMapping.set(rr.MH(t.rawId),t.id)},this.toArray=()=>Array.from(this._allAlerts.values()),this.toMap=()=>this._allAlerts,this.toJSON=()=>({allAlerts:Array.from(this._allAlerts.entries()),idMapping:Array.from(this._capiAlertsIdMapping.entries())})}}var ar=r(96021);class or{constructor(e,t,r,i,l,c,u,d=Kt.defaultValidator,p=!1){this._positionManager=e,this._alternativeManager=t,this._getContent=r,this._capiEvents=i,this._capiClient=l,this._documentCounters=c,this._transformRawAlert=u,this._alertDuplicateValidator=d,this._enforceSDUIOnlyMode=p,this._state=Pe.h.create(Je.r.empty),this.state=this._state.view(Je.r.toCheckingResult),this.lensesScores=Pe.h.create(at.empty),this._log=Ve.C8.Logging.getLogger("AlertManager",Ze.i.TRACE,Ze.T.Manager.getColor()),this._subs=[],this._addAlerts=new yt.xQ,this._removeAlerts=new yt.xQ,this._changeAlerts=new yt.xQ,this._flush=new yt.xQ,this._alertsPerRevision=0,this._alertsRepository=new sr,this._pipeline=new ir(this._positionManager,this._alertsRepository,this._alertDuplicateValidator),this._invalidateAlerts=()=>{this.flushAlerts();const[e,t]=Be.uK(this._getAllAlertsAsArray(),(e=>e.isValid));this._log.debug("Invalidate alerts...",{valid:e.length,invalid:t.length}),e.forEach((e=>{this._alertsRepository.removeFromCapiMapping(e),e.clearCapiId()})),t.forEach((e=>e.clearCapiId()))},this._removeInvalidAlerts=e=>{this._log.debug(`Removing invalid alerts by type '${e}'...`);const t=this._getTypeFilter(e),r=this._getAllAlertsAsArray().filter((e=>!e.isValid&&Bt.bZ.isRegistered(e)&&t(e)));r.forEach((e=>this._removeAlertBuffered(o.F2(e.id)))),this._log.debug(`${r.length} invalid alerts removed`),this.flushAlerts(),this._log.isEnabled(Ze.i.TRACE)&&this._log.trace("Removed alerts",r.map((e=>e.toString())))},this._onCapiEvent=e=>{try{switch("alert_received"===e.kind&&this._alertsPerRevision++,e.kind){case"alert_received":case"plagiarism_alert_received":if(!1===e.alert.hidden&&void 0===e.alert.cardLayout)return void this._log.warn("got alert with empty mapping",{pname:e.alert.pname});this._isValidSDUI(e.alert.id,e.alert.sdui,"alert_add")&&this._addAlertBuffered(Bt.bZ.create(this._transformRawAlert(e.alert),this._ops,this._positionManager,this._alternativeManager));break;case"alert_removed":this._log.debug(`Remove from capi #${e.alertId}, merged in #${$e.getOrElse((()=>"None"))(e.mergedIn)}, hint: ${$e.getOrElse((()=>"None"))(e.hint)}`);(0,a.pipe)(this._alertsRepository.getByRawAlertId(e.alertId),$e.exists(Bt.bZ.isBulkApplied))||this._removeAlertBuffered(o.t$({id:e.alertId,mergedIn:e.mergedIn,hint:e.hint}));break;case"alert_changed":this._log.debug("Alert change from capi #"+e.alertId),(void 0===e.sdui||this._isValidSDUI(e.alertId,e.sdui,"alert_change"))&&this._changeAlertBuffered({id:e.alertId,rev:e.rev,extraProperties:$e.fromNullable(e.extraProperties),transformJson:$e.fromNullable(e.transformJson),muted:$e.fromNullable(e.muted),sdui:$e.fromNullable(e.sdui)});break;case"finish":this._log.debug(`Alerts per revision (#${e.revision}): ${this._alertsPerRevision}`),this._alertsPerRevision=0,"idle"===this._capiClient.checkingState&&this._emitDomainEvent(this._pipeline.reset(e))}}catch(t){this._log.warn("Cannot handle alert event "+e.kind,t)}},this._emitDomainEvent=e=>{(0,a.pipe)(e,this._prepareDiff,Xe.v.createDiff,We.T.recover((e=>this._log.error("conflicts on diff creating",e))),(e=>(this._log.debug("_emitDomainEvent",qe.p.Diff.show.show(e)),e)),Je.r.applyDiff,Ye.UI(We.T.recover((e=>this._log.error("conflicts on diff apply",e)))),(e=>this._state.modify(e)))},this._prepareDiff=({added:e,updated:t=new Map,removed:r=new Map})=>(t.forEach(((e,i)=>{(0,a.pipe)(e,n.Yg,Bt.bZ.fromAlertModel,Bt.bZ.shouldBeRemoved)&&(t.delete(i),r.set(i,e[0]))})),r.forEach((0,s.ls)(Bt.bZ.fromAlertModel,this._disposeAlert)),{added:e,updated:t,removed:r}),this._disposeAlert=e=>{if(Bt.bZ.isApplied(e)&&e.state.undoable.commit(),Bt.bZ.isNotRegistered(e))try{this._alertsRepository.remove(e)}catch(t){this._log.error("can not remove alert",t),Bt.bZ.isNotDisposed(e)&&e.dispose()}else this._log.error("unexpected remove of registered alert",e.toString())},this._cardDSLDecoder=Oe.n(xe)(Qe.n),this._isValidSDUI=!1===this._enforceSDUIOnlyMode?s.W8:(e,t,r)=>void 0===t?(this._capiClient.sendDebugReport(e,`got unexpected empty sdui content during ${r}`)(),this._log.error(`skip alert on ${r} due to empty sdui content`,e),!1):(0,a.pipe)(this._cardDSLDecoder.decode(t.card),o.Vn((t=>{const i=De(t);this._capiClient.sendDebugReport(e,i)(),this._log.error(`skip alert on ${r} due to incorrect sdui content`,{alertId:e,err:i})})),o.tO),this._ops=new qt(this._positionManager,this._getContent,this._capiClient,this._alertsRepository),this.loadScores=e=>{this.lensesScores.set(e)},this.undoApplied=this._ops.undoApplied,this.changes=this._ops.changes;const h=e.rangeChanged.pipe(st.U((({affected:e})=>e)),ht.h((e=>e.length>0)),st.U((e=>gt.vM((e=>e.meta.alertId),e.filter(Tt.P.is)))),ht.h((e=>e.size>0)),nt.b((e=>this._log.debug("Range[s] changed",e))),vt.B()),m=bt.F(250).pipe(wt.O(0),St.T(this._flush)),g=ft.RX(this._log);this._subs.push(g("_alertsInvalidation",this._capiEvents.pipe(ht.h(Fe.h.is("session_started")),nt.b(this._invalidateAlerts),It.c(At.T(this._capiEvents.pipe(ht.h(Fe.h.is("finish")),_t.q(1),Ct.h("alert")),this._capiEvents.pipe(ht.h(Fe.h.is("async_check_finished")),_t.q(1),Ct.h("plagiarism")))),nt.b(this._removeInvalidAlerts))),g("_capiEvents",this._capiEvents.pipe(nt.b(this._onCapiEvent))),g("_alertsProccesing",this._addAlerts.pipe(St.T(this._removeAlerts),St.T(this._changeAlerts),St.T(h),Et.f(m),ht.h(He.Dw),st.U(this._pipeline.process),nt.b(this._emitDomainEvent))),g("_alertsBuffer",h.pipe(St.T(this._capiEvents.pipe(ht.h(Fe.h.is("before_finish","before_async_check_finish","async_check_finished")))),Ct.h(ft.PU),nt.b(this._flush))),g("_alertOpsAlertChanges",this._ops.events.pipe(nt.b(this._emitDomainEvent))),g("_lensesScoresChanges",at.fromCapi(this._capiEvents).pipe(nt.b(ft.wW(this.lensesScores)))),g("documentCountersChanges",ee.fromAlerts(this._state.view(Xe.v.iso.wrap)).pipe(nt.b(ft.wW(this._documentCounters))))),(0,He.iR)("alerts",(()=>this.toString())),(0,He.iR)("triggerRemove",(e=>{this._removeAlertBuffered(o.F2(e))}))}flushAlerts(){this._flush.next()}loadAlerts(e){const t=new Map;return(0,He.Dw)(e)&&(this._log.debug(`${e.length} external alert(s) where loaded`),e.map(ar.I.splitById).map((({id:e,local:t})=>({id:e,alert:Bt.bZ.create((0,a.pipe)(t,ze.wQ.matchBy(s.yR,(e=>Object.assign(Object.assign({},e),{transformJson:{highlights:e.transformJson.highlights,alternatives:(0,a.pipe)(e.transformJson.alternatives,$e.map(je.r3.Group.fromSerialized))}})),s.yR),this._transformRawAlert),this._ops,this._positionManager,this._alternativeManager)}))).forEach((({id:e,alert:r})=>{this._addAlertBuffered(r),e&&t.set(e,r.id)}))),t}toString(){return JSON.stringify(this,void 0,2)}toJSON(){return{repo:this._alertsRepository}}dispose(){this._subs.forEach((e=>e.unsubscribe())),this._subs=[]}_getTypeFilter(e){switch(e){case"alert":return e=>!Bt.bZ.isPlagiarism(e);case"plagiarism":return e=>Bt.bZ.isPlagiarism(e);default:return(0,Ge.vE)(e)}}_addAlertBuffered(e){this._log.trace(`_addAlert(${e.toLiteString()})`),this._addAlerts.next(e)}_changeAlertBuffered(e){this._log.trace(`_changeAlert(${e.id})`),this._changeAlerts.next(e)}_removeAlertBuffered(e){this._log.trace(`_removeAlert(${Xt.toString(e)})`),this._removeAlerts.next(e)}_getAllAlertsAsArray(){return this._alertsRepository.toArray().filter(Bt.bZ.isNotRemoved)}}},6488:(e,t,r)=>{r.d(t,{e:()=>i});var i,n=r(40327),s=r(5114),a=r(4390),o=r(40018);!function(e){e.create=function(e){const t=t=>(0,n.pipe)(e.get(),a.p.get(t),s.map(o.bZ.fromAlertModel)),r=e=>(0,n.pipe)(t(e),s.filter(o.bZ.isInteractable)),i=e=>(0,n.pipe)(t(e),s.filter(o.bZ.isRegistered));return{getById:t,getRegistered:i,getInteractable:r,isRegistered:e=>(0,n.pipe)(i(e),s.isSome),isInteractable:e=>(0,n.pipe)(r(e),s.isSome)}}}(i||(i={}))},43320:(e,t,r)=>{r.d(t,{R:()=>s});var i=r(51072),n=r(32952);class s{static init(e,t,r,i,a,o){const l=new n.xQ;return new s(e,t,r,i,a,o,l),l}constructor(e,t,r,i,n,a,o){const l=s.NamedChangesSink.factory(o),c={pm:l(s.Receiver.PM,i),dm:l(s.Receiver.PM,n),capi:l(s.Receiver.CAPI,r),userTextEcho:l(s.Receiver.UserText,e)};s.Producer.create(s.Producer.UserText,{changes:e.changes})(c.dm,c.pm,c.capi),s.Producer.create(s.Producer.ALERT_APPLY,a)(c.userTextEcho),t.subscribe((t=>{"before_alert"===t.kind&&e.flushChanges()}))}}!function(e){let t,r,n,s;!function(e){e.DEd="denali_editor",e.UserText="user_text",e.DOX="remote_document",e.ALERT_APPLY="alert_synonyms_manager"}(t=e.Producer||(e.Producer={})),function(e){e.create=function(e,t){return(...r)=>t.changes.subscribe((t=>{r.forEach((r=>r.pushChanges(e,t)))}))}}(t=e.Producer||(e.Producer={})),function(e){e.DEd="denali_editor",e.UserText="user_text",e.DOX="remote_document",e.CAPI="checking_service",e.PM="position_manager"}(r=e.Receiver||(e.Receiver={})),function(e){function t(e,t,r){return{pushChanges:(n,s)=>{try{let a=t.pushChanges(s);"function"==typeof a&&(a=i.Vi(a)),void 0!==a&&a.catch((t=>r.next({exception:t,details:{from:n,to:e}})))}catch(t){r.next({exception:t,details:{from:n,to:e}})}}}}e.factory=function(e){return(r,i)=>t(r,i,e)},e.create=t}(n=e.NamedChangesSink||(e.NamedChangesSink={})),function(e){e.create=e=>({changes:e.changes,pushChanges(t){e.pushChanges(t,"user")},getContents:()=>e.getContents(),flushChanges:()=>e.flushChanges()})}(s=e.UserTextChangesSync||(e.UserTextChangesSync={}))}(s||(s={}))},5008:(e,t,r)=>{r.d(t,{n:()=>i,A:()=>n});var i,n,s=r(57050),a=r(25938),o=r(36991),l=r(8125),c=r(62965),u=r(24209);!function(e){e.noopSync={pushChanges:l.Q1},e.ignoreResult=function(e){return{pushChanges:t=>{e.pushChanges(t)}}},e.ignoreTEResult=function(e){return{pushChanges:(0,s.ls)(e.pushChanges,c.UI(l.Q1))}},e.pushDeleteThenInsert=function(e){return{pushChanges:t=>{(a.RI.isDelta(t)?a.RI.fromArrayOfDeltas(o.s.splitToDeleteThenInsert(t.delta).filter(o.s.nonEmpty),t.prevLen):[t]).forEach((t=>e.pushChanges(t)))}}}}(i||(i={})),function(e){e.merge=function(e){return{changes:u.T(...e.map((e=>e.changes)))}}}(n||(n={}))},89772:(e,t,r)=>{r.d(t,{w:()=>n});var i,n,s=r(57050),a=r(40327),o=r(92843),l=r(68983),c=r(5114),u=r(90329),d=r(66896),p=r(51653),h=r(70996);!function(e){e.modelToCounters=function(e){return h.h.isRegistered(e)?e.counters:p.R.empty}}(i||(i={})),function(e){e.monoid=u.uZ(d.R.Id.ord,d.R.Meta.group),e.eq=u.Eh(d.R.Id.ord,d.R.Meta.eq),e.isEmpty=u.xb,e.lookup=u.P5(d.R.Id.ord),e.applyDiff=t=>i=>c=>(0,a.pipe)(i,o.v.foldMap(e.monoid)(n(t),p(t),r(t)),(0,l.W)(e.monoid.concat)(c),u.hX((0,s.ff)(d.R.Meta.isEmpty))),e.updatePercentiles=e=>t=>{let r=t;return e.forEach(((e,t)=>{r=(0,a.pipe)(r,u.cq(d.R.Id.ord)(t,d.R.Meta.ratioToPercentile(e)),c.fold((()=>(0,a.pipe)(r,u.ZQ(d.R.Id.ord)(t,d.R.Meta.fromPercentile(e)))),s.yR))})),r};const t=(0,s.ls)(i.modelToCounters,d.R.Meta.fromAlertCounters),r=e=>r=>h(e)(r,t),n=e=>r=>h(e)(r,(0,s.ls)(t,d.R.Meta.group.inverse)),p=t=>(i,s)=>e.monoid.concat(r(t)(s),n(t)(i)),h=e=>(t,r)=>(0,a.pipe)(e,u.hX((e=>e(t.alert))),u.UI((()=>r(t))))}(n||(n={}))},13313:(e,t,r)=>{r.d(t,{A:()=>i});var i,n=r(38983),s=r(4390),a=r(54216),o=r(93508),l=r(57091),c=r(67434),u=r(98403),d=r(89772);!function(e){e.defaultState={alerts:s.p.empty,lenses:d.w.monoid.empty},e.get=(i,n,a)=>n.pipe(o.O(new Map),l.a(i.pipe(o.O(s.p.empty),c.R(((e,r)=>t(r,a.lensFilters)(e)),e.defaultState)),r)),e.getMock=(t,r)=>{const i=n.h.create(e.defaultState);return e.get(t,r,a.t.create(a.t.defaultLensFilters,a.t.defaultTextFilters)).subscribe(u.wW(i)),i};const t=(e,t)=>r=>{const i=s.p.Diff.toRegistered(s.p.diff(r.alerts,e));return{alerts:e,lenses:d.w.applyDiff(t)(i)(r.lenses)}},r=(e,t)=>Object.assign(Object.assign({},t),{lenses:d.w.updatePercentiles(e)(t.lenses)})}(i||(i={}))},35301:(e,t,r)=>{r.d(t,{J:()=>i});var i,n=r(71249),s=r(22690),a=r(57050),o=r(40327),l=r(38983),c=r(84966),u=r(80358),d=r(45701),p=r(90329),h=r(5114),m=r(43675),g=r(62965),f=r(95195),y=r(8125),v=r(81531),b=r(40018),w=r(32952),S=r(45586),I=r(85985),A=r(77176),_=r(2834),C=r(98403),E=r(16118),T=r(40151),x=r(85654);!function(e){let t,r,i;!function(e){let t;!function(e){e.ord=d.ordString,e.show=s._3,e.create=e=>e}(t=e.Id||(e.Id={})),e.isSpecial=e=>Object.values(c.JW.SpecialCategory).includes(e),e.specialCategoryDescription="Special category"}(t=e.Category||(e.Category={})),function(e){e.filter=e=>p.hX((t=>e(t.id))),e.filterWithCount=(e,t)=>r=>{const i=Array.from(r.keys()),n=x.k.getAlerts(t,i).byCategory;return(0,o.pipe)(r,p.DZ((t=>e(t.id)?h.some(Object.assign(Object.assign({},t),{alertsCount:n.get(t.id).filter(b.bZ.isRegistered).length})):h.none)))}}(r=e.BaseMutedCategories||(e.BaseMutedCategories={})),function(e){let i,s;!function(e){let t;!function(e){e.CategoriesChanged="CategoriesChanged"}(t=e.Type||(e.Type={})),e.isChangedEvent=function(e){return e.type===t.CategoriesChanged}}(i=e.Events||(e.Events={})),e.create=function(e,s,d,p,y){const T=v.C8.Logging.getLogger("MutedAlertsModel"),k=l.h.create(new Map),M=new w.xQ,L=new S.w.Keeper;return L.push(e.pipe(I.h(u.h.is("session_started")),A.U((e=>function(e){const t=e.map((e=>[e.userMuteCategory,{id:e.userMuteCategory,description:e.userMuteCategoryDescription,scope:e.userMuteScope}]));return new Map(t)}(e.userMutedCategories))),_.b(C.wW(k)),_.b((()=>M.next({type:i.Type.CategoriesChanged})))).subscribe(),k.pipe(E.G(),A.U((([e,r])=>function(e,r){return{muted:m.uz(t.Id.ord)(e,r),unmuted:m.uz(t.Id.ord)(r,e)}}(e,r))),A.U(function(e){return({muted:t,unmuted:r})=>({toMute:x.k.getAlerts(e,t).all.filter((e=>e.mute!==b.bZ.MuteStateType.Muted)),toUnmute:x.k.getAlerts(e,r).all.filter((e=>e.mute!==b.bZ.MuteStateType.Unmuted))})}(d)),_.b((({toMute:e,toUnmute:t})=>{e.length>0&&p.changeMuteState(e,b.bZ.MuteStateType.Muted),t.length>0&&p.changeMuteState(t,b.bZ.MuteStateType.Unmuted)}))).subscribe()),{events:M,mutedCategories:k,muteCategories:e=>{(0,o.pipe)(s.sendFeedback({kind:c.Mw.MUTE,userMuteScope:y,userMuteCategories:e}),g.Vn((e=>{T.warn("Alerts could not be muted on CAPI",e)})))();const r=x.k.getAlerts(d,e);0===r.all.filter((e=>e.mute!==b.bZ.MuteStateType.Muted)).length&&T.warn("No alerts were muted on category mute",{categoryIds:e});const a=function(e,r,i){return s=>{const a=new Map(s);return e.forEach(((e,s)=>{t.isSpecial(s)?a.set(s,{id:s,scope:r,description:t.specialCategoryDescription}):(0,o.pipe)(n.P5(0,e),h.chain((e=>e.muteCategory)),h.fold((()=>i.error("No alerts to mute",s)),(e=>a.set(s,{id:e.id,description:e.description,scope:r}))))})),a}}(r.byCategory,y,T)(k.get());return k.set(a),M.next({type:i.Type.CategoriesChanged}),f.F2(void 0)},unmuteCategories:e=>{(0,o.pipe)(s.sendFeedback({kind:c.Mw.UNMUTE,userMuteScope:y,userMuteCategories:e}),g.Vn((e=>{T.warn("Alerts could not be un-muted on CAPI",e)})))();return 0===x.k.getAlerts(d,e).all.filter((e=>e.mute!==b.bZ.MuteStateType.Unmuted)).length&&T.warn("No alerts were unmuted on category unmute",{categoryIds:e}),k.modify(function(e,t){return r=>{const i=new Map(r);return e.forEach((e=>{r.has(e)?i.delete(e):t.error("Tried to unmute a category which is not muted",e)})),i}}(e,T)),M.next({type:i.Type.CategoriesChanged}),f.F2(void 0)},getMutedCategories:()=>(0,o.pipe)(k.get(),r.filterWithCount((0,a.ff)(t.isSpecial),d)),getMutedSpecialCategories:()=>(0,o.pipe)(k.get(),r.filter(t.isSpecial)),loadCachedMutedCategories:e=>{k.set(e)},dispose:()=>L.dispose()}},function(e){e.create=function(){return{events:T.E,mutedCategories:l.h.create(new Map),getMutedCategories:()=>new Map,getMutedSpecialCategories:()=>new Map,muteCategories:e=>f.F2(void 0),unmuteCategories:e=>f.F2(void 0),loadCachedMutedCategories:y.Q1,dispose:y.Q1}}}(s=e.Mock||(e.Mock={}))}(i=e.CategoriesModel||(e.CategoriesModel={}))}(i||(i={}))},85654:(e,t,r)=>{r.d(t,{k:()=>i});var i,n=r(40327),s=r(5114),a=r(40018),o=r(4390);!function(e){e.create=e=>({getAlertMuteCategory:t=>(0,n.pipe)(e.getById(t),s.chain((e=>e.muteCategory)))}),e.getAlerts=function(e,t){const r={byCategory:new Map(t.map((e=>[e,[]]))),all:[]};return(0,n.pipe)(e.get(),o.p.reduce(r,((e,{alert:r})=>(0,n.pipe)(r.muteCategory,s.filter((e=>t.includes(e.id))),s.map((e=>e.id)),s.alt((()=>s.fromNullable(t.find(a.bZ.belongsToSpecialCategory(r))))),s.fold((()=>e),(t=>(e.byCategory.get(t).push(r),e.all.push(r),e)))))))}}(i||(i={}))},72720:(e,t,r)=>{r.d(t,{Q:()=>o});var i=r(57050),n=r(37492),s=r(51072),a=r(81531);class o{constructor(e){this._capiSDUIClient=e,this._log=a.C8.Logging.getLogger("SDUIFeedbackServiceImpl")}sendUserAction(e,t){(0,i.zG)(this._capiSDUIClient.sendUserAction(e,t),s.Vi,(e=>e.catch((e=>{n.EP.isDroppedError(e)?this._log.debug("Stopped listening for sendUserAction message acknowledge",e):n.YG.isNotConnectedError(e)?this._log.warn("Failed to sendUserAction as CAPI was not connected",e):this._log.error("Failed to sendUserAction",e)}))))}}},21729:(e,t,r)=>{r.d(t,{dM:()=>i,j:()=>n});var i,n,s,a,o=r(73975),l=r(22690),c=r(40327),u=r(38983),d=r(73353),p=r(48837),h=r(5114),m=r(83078);!function(e){e.group=p.kT({critical:p.Kh,advanced:p.Kh,free:p.Kh,freePremium:p.Kh,paid:p.Kh,criticalPriority:p.Kh,advancedPriority:p.Kh,freePriority:p.Kh,paidPriority:p.Kh,unread:p.Kh,muted:p.Kh}),e.eq=o.MW({critical:o.lr,advanced:o.lr,free:o.lr,freePremium:o.lr,paid:o.lr,unread:o.lr,criticalPriority:o.lr,advancedPriority:o.lr,freePriority:o.lr,paidPriority:o.lr,muted:o.lr}),e.show=l.aM({critical:l.yt,advanced:l.yt,free:l.yt,paid:l.yt,criticalPriority:l.yt,advancedPriority:l.yt,freePriority:l.yt,paidPriority:l.yt,unread:l.yt,muted:l.yt}),e.isValid=function(e){return e.critical>=0&&e.advanced>=0&&e.unread>=0},e.isEmpty=function(t){return e.eq.equals(t,e.group.empty)}}(i||(i={})),function(e){e.MIN_GOALS=3,e.TOTAL_GOALS=e.MIN_GOALS+2,e.calculateCompleteness=function(t){const r=(0,c.pipe)(t.goals,h.exists((e=>e.size>0))),i=(0,c.pipe)(t.emotions,h.exists((e=>e.size>0)));return d.R$.eq.equals(t,d.R$.unset)||(0,c.pipe)(t.domain,m.wo((e=>"general"===e)))&&!(h.isSome(t.audience)||h.isSome(t.style)||r||i)?0:Number(r||0)+Number(i||0)+e.MIN_GOALS}}(n||(n={})),function(e){e.zero={full:0,trimmed:0}}(s||(s={})),function(e){let t;!function(e){e[e.Document=0]="Document",e[e.Plagiarism=1]="Plagiarism"}(t=e.CheckingKind||(e.CheckingKind={})),e.Mock={getCheckingForState:()=>u.h.create({kind:e.CheckingKind.Document,type:"idle"})}}(a||(a={}))},54286:(e,t,r)=>{r.d(t,{_:()=>n});var i,n,s=r(38983),a=r(73353),o=r(5114),l=r(20817);!function(e){e.unwrap=function(e){return l.Ri.create(o.getOrElse((()=>e)),o.some)}}(i||(i={})),function(e){e.create=function(e,t,r,n){const l=i.unwrap(t.style),c=i.unwrap(t.audience),u=i.unwrap(t.domain),d=s.h.create(e),p=d.lens("style").lens(l),h=d.lens("domain").lens(u),m={audience:{items:a.R$.audiences,current:d.lens("audience").lens(c),default:o.some(t.audience)},formality:{items:a.R$.formalityLevels,current:p,default:o.some(t.style),shouldDisable:e=>h.view((t=>!!t&&!a.R$.isStyleValidWithDomain(t,e)))},domain:{items:a.R$.domains,current:h,default:o.some(t.domain),shouldDisable:e=>p.view((t=>r.isFree?"general"!==e:!a.R$.isStyleValidWithDomain(e,t)))},intent:{items:a.R$.goals.filter((e=>"sell"!==e)),current:d.lens("goals")},tone:{items:a.R$.tone,current:d.lens("emotions")}};return{localContext:d,blocks:m,showSetGoalsLoader:s.h.create(!r.demoMode&&n)}}}(n||(n={}))},68579:(e,t,r)=>{r.d(t,{A:()=>i});var i,n=r(27378),s=r(5739),a=r(12187),o=r(8125),l=r(5114),c=r(8725),u=r(63969),d=r(34442),p=r(95983),h=r(77176);!function(e){let t;function r(e){return c.UI.List.make(p.aW.getFoldableWithIndex(),i(e))}function i(t){return c.UI.Knot.make(e.IdProvider,{cell:c.UI.Knot.make(d.H.Cell,{item:c.UI.Composite.make(e.CardStyleProvider,t)})})}!function(e){e.onMount="onMount"}(t=e.ActionsKind||(e.ActionsKind={})),e.cardListContent=r,e.cardList=function(t){return c.UI.Knot.make(e.ScrollableBox,{content:r(t)})},e.ScrollableBox=c.UI.Grid.make((({notify:e,view:r,slots:i})=>n.createElement(s.F.div,Object.assign({},(0,a.Sh)(r("disableUserActions").pipe(h.U((0,o.RN)(g.disableUserActions,void 0))),g.scrollContent),{"data-purpose":"scrollable-box",style:{height:r("height")},mount:r=>e({kind:t.onMount,element:l.fromNullable(r)})()}),i.content))),e.cell=i,e.CardStyleProvider=c.UI.Grid.make((({slots:e})=>n.createElement("div",{className:g.cardWrapper},e.children))),e.IdProvider=c.UI.Grid.make((({slots:e,state:t})=>n.createElement(s.F.div,{"data-id":t},e.cell)))}(i||(i={}));const m={margin:`${u.u.rem(.5)} 0`,background:"none",userSelect:"none",$nest:{"&:before":{position:"absolute",left:u.u.rem(-.5),width:u.u.rem(.5),height:u.u.percent(100),background:"none",content:"''"}}},g=u.u.stylesheet({scrollContent:[{position:"relative",boxSizing:"content-box"}],disableUserActions:[{pointerEvents:"none"}],cardWrapper:[m]})},92569:(e,t,r)=>{r.d(t,{A:()=>i});var i,n=r(27378),s=r(5739),a=r(8125),o=r(8725),l=r(44060),c=r(63969),u=r(66896),d=r(87380),p=r(21474),h=r(77176),m=r(57091),g=r(85985);!function(e){e.DefaultCounter=o.UI.Node.make((({state:e})=>n.createElement(s.F.Fragment,null,e.pipe(h.U((({count:e,fontSize:t,lensId:r})=>n.createElement(d.x.OutcomeCounter,{count:e,theme:{counterWrapper:_.get(r),counterContent:A.counterContent},type:"gray",fontSize:t}))))))),e.ZeroCounter=o.UI.Node.make((()=>n.createElement(p.JO.CheckmarkOutcomes,{className:A.zeroCounter}))),e.PlagiarismCounter=o.UI.Node.make((({state:e})=>n.createElement(s.F.Fragment,null,e.pipe(h.U((({count:e,fontSize:t})=>n.createElement(d.x.OutcomeCounter,{count:e,theme:{counterWrapper:A.plagiarismCounterWrapper,counterContent:A.plagiarismCounterContent},suffix:"%",type:"gray",fontSize:t}))))))),e.Component=o.UI.Union.make("kind",{plagiarism:e.PlagiarismCounter,default:e.DefaultCounter,zero:e.ZeroCounter});const t=e=>!u.R.isPlagiarismId(e);e.createLensCounterFlow=(e,r,i)=>o.Z.composeUnion({plagiarism:o.Z.fromSideEffect(a.Q1,r.pipe(h.U((e=>({count:e,fontSize:i}))))),default:o.Z.fromSideEffect(a.Q1,r.pipe(m.a(e.pipe(g.h(t))),h.U((([e,t])=>({count:e,lensId:t,fontSize:i}))))),zero:o.Z.fromSideEffect(a.Q1,null)},(()=>e.pipe(m.a(r),h.U((([e,t])=>({kind:0===t?"zero":e===u.R.SpecialId.Plagiarism?"plagiarism":"default"}))))));const r={fill:c.u.important(l.Il.CoreNeutral0)},i={fill:c.u.important(l.Il.CoreNeutral50)},f={fill:c.u.important(l.Il.CoreRed50)},y={fill:c.u.important(l.Il.CoreBlue50)},v={fill:c.u.important(l.Il.CoreGreen50)},b={fill:c.u.important(l.Il.CorePurple50)},w={fill:c.u.important(l.Il.CoreNeutral50)},S={fill:c.u.important(l.Il.CoreCyan50)},I={fill:l.Il.CoreGreen50,minHeight:0,minWidth:c.u.rem(1)},A=c.u.stylesheet({counterWrapper:[],counterContent:[r],zeroCounter:[I],allAlertsCounter:[i],priorityAlertsCounter:[i],correctnessCounter:[f],clarityCounter:[y],engagementCounter:[v],deliveryCounter:[b],voxCounter:[w],plagiarismCounterWrapper:[S],plagiarismCounterContent:[r,{}]}),_=new Map([[u.R.SpecialId.AllAlerts,A.allAlertsCounter],[u.R.SpecialId.Priority,A.priorityAlertsCounter],[u.R.SpecialId.Correctness,A.correctnessCounter],[u.R.SpecialId.Clarity,A.clarityCounter],[u.R.SpecialId.Engagement,A.engagementCounter],[u.R.SpecialId.Delivery,A.deliveryCounter],[u.R.SpecialId.Vox,A.voxCounter],[u.R.SpecialId.CorrectnessPriority,A.correctnessCounter],[u.R.SpecialId.ClarityPriority,A.clarityCounter],[u.R.SpecialId.EngagementPriority,A.engagementCounter],[u.R.SpecialId.DeliveryPriority,A.deliveryCounter],[u.R.SpecialId.VoxPriority,A.voxCounter]])}(i||(i={}))},40743:(e,t,r)=>{r.d(t,{C:()=>f});var i=r(27378),n=r(40327),s=r(5739),a=r(5114),o=r(8725),l=r(44060),c=r(63969),u=r(40219),d=r(66896),p=r(7046),h=r(24811),m=r(3656),g=r(77176);const f=o.UI.Node.make((({state:e,notify:t})=>i.createElement(s.F.Fragment,null,e.pipe(g.U((({previews:e,disabled:r,activeLensId:o})=>i.createElement(s.F.div,{className:T.lensNavigation},e.map((e=>i.createElement(p.zx.Flat,{name:e.id,key:e.id,className:T.lensButton,active:(0,n.pipe)(o,a.exists((t=>t===e.id))),disabled:r,title:e.description,titleAlign:"bottomCenter",onClick:t({kind:"lensClicked",lens:e})},i.createElement(h.B,{value:e.progress,wrapperClass:T.progressBarWrapper,progressClass:y(e.id)}),i.createElement(m.XY,{className:T.lensButtonText},e.title)))))))))));function y(e){switch(e){case d.R.SpecialId.Correctness:return T.correctnessProgressBar;case d.R.SpecialId.Clarity:return T.clarityProgressBar;case d.R.SpecialId.Engagement:return T.engagementProgressBar;case d.R.SpecialId.Delivery:return T.deliveryProgressBar;case d.R.SpecialId.Vox:return T.voxProgressBar;default:return}}const v={display:"flex",height:c.u.percent(100),justifyContent:"space-between",alignItems:"center"},b={display:"flex",flexDirection:"column",marginRight:c.u.rem(.3125),padding:`${c.u.rem(.375)} ${c.u.rem(.25)} 0`,borderRadius:c.u.rem(u.fx),$nest:{"&:last-child":{marginRight:0},"&:hover:not([data-disabled='true'])":{backgroundColor:l.Il.CoreNeutral10},"&[data-active='true']":{backgroundColor:l.Il.CoreNeutral10,color:l.Il.CoreNeutral90}}},w={textTransform:"uppercase",fontSize:c.u.px(8)},S={width:c.u.rem(2),backgroundColor:l.Il.CoreNeutral20},I={backgroundColor:l.Il.CoreRed50},A={backgroundColor:l.Il.CoreBlue50},_={backgroundColor:l.Il.CoreGreen50},C={backgroundColor:l.Il.CorePurple50},E={backgroundColor:l.Il.CoreNeutral50},T=c.u.stylesheet({lensNavigation:[v],lensButton:[b],lensButtonText:[w],progressBarWrapper:[S],correctnessProgressBar:[I],clarityProgressBar:[A],engagementProgressBar:[_],deliveryProgressBar:[C],voxProgressBar:[E]})},52249:(e,t,r)=>{if(r.d(t,{A:()=>d}),75==r.j)var i=r(22232);var n=r(8725);if(75==r.j)var s=r(66896);if(75==r.j)var a=r(40018);if(75==r.j)var o=r(85985);if(75==r.j)var l=r(77176);if(75==r.j)var c=r(28043);if(75==r.j)var u=r(15774);function d(e,t,r,d){const p=t.pipe(o.h((e=>e!==s.R.SpecialId.Premium)),l.U((e=>e===s.R.SpecialId.Priority?u.H.LensMode.priority:u.H.LensMode.all)),c.x());return n.Z.fromSideEffect((t=>{switch(t.kind){case u.H.Action.Kind.select:e.events.next({type:"switchToLens",id:t.selected===u.H.LensMode.priority?s.R.SpecialId.Priority:s.R.SpecialId.AllAlerts,focusFirst:!1,actionSource:a.l$.sidebar});break;default:(0,i.vE)(t.kind)}}),p.pipe(l.U((e=>({ord:"priority"===r?u.H.Order.priorityFirst:u.H.Order.allFirst,layoutMode:d,lensMode:e})))))}},15774:(e,t,r)=>{r.d(t,{H:()=>T});var i=r(27378),n=r(5739),s=r(12187),a=r(22232),o=r(45701),l=r(8725),c=r(30763),u=r(7046),d=r(21474),p=r(16951),h=r(77176),m=r(44060),g=r(63969),f=r(40219),y=r(2040);const v=g.u.style({display:"inline-flex",overflow:"visible",border:`2px solid ${m.Il.CoreNeutral10}`,borderRadius:g.u.rem(f.fx),backgroundColor:m.Il.CoreNeutral10}),b=g.u.joinClasses([g.u.style({padding:`0 ${g.u.rem(.5)} 0 ${g.u.rem(.5)}`,display:"inline-flex",justifyContent:"space-around",textAlign:"center",$nest:{"&:first-child":{marginRight:g.u.px(2)}}}),y.base]),w=g.u.style({fontSize:g.u.rem(m.xv.SmallSize)}),S=g.u.style({width:g.u.rem(2.5)}),I=g.u.style({width:g.u.rem(9.5)}),A=g.u.joinClasses([g.u.style({width:g.u.rem(2.25)}),w]),_=g.u.joinClasses([g.u.style({width:g.u.rem(8.75)}),w]),C=g.u.joinClasses([g.u.style({borderRadius:g.u.rem(f.fx),backgroundColor:m.Il.CoreNeutral0,boxShadow:m.uc.Z100,fontWeight:600,$nest:{"&[data-disabled='true']":{backgroundColor:m.Il.CoreNeutral0}}}),b]),E=g.u.style({display:"inline-flex",width:g.u.rem(1.25),minWidth:0,minHeight:0,fill:m.Il.CoreNeutral50,stroke:m.Il.CoreNeutral50,$nest:{"&[data-disabled='true']":{fill:m.Il.CoreNeutral50,stroke:m.Il.CoreNeutral50}}});var T;!function(e){let t,r,m;!function(e){e.priority="priority",e.all="all"}(t=e.LensMode||(e.LensMode={})),function(e){let t;!function(e){e.select="select"}(t=e.Kind||(e.Kind={}))}(r=e.Action||(e.Action={})),function(t){t.priorityFirst=o.fromCompare((t=>t===e.LensMode.priority?-1:1)),t.allFirst=o.fromCompare((t=>t===e.LensMode.all?-1:1))}(m=e.Order||(e.Order={})),e.Component=l.UI.Node.make((({state:e,notify:a})=>i.createElement(n.F.div,{key:"feedModeSelector",className:v},e.pipe(h.U((({lensMode:e,layoutMode:n,ord:o})=>[t.all,t.priority].sort(o.compare).map((t=>i.createElement(u.zx,Object.assign({name:`${t}-lens`,key:`${t}-lens`,disabled:e===t,onClick:()=>a({kind:r.Kind.select,selected:t})()},(0,s.Sh)(e===t?C:b,f(t,n))),i.createElement(g,{selected:t}))))))))));const g=({selected:e})=>{const r=i.useContext(c.m.Context).feedModeSelector;switch(e){case t.all:return i.createElement(i.Fragment,null,r.all);case t.priority:return i.createElement(i.Fragment,null,r.priority,i.createElement(p.u,{align:"bottomCenter",title:r.priorityDescription},i.createElement(d.JO.Info,{width:10,className:E})));default:(0,a.vE)(e)}},f=(e,r)=>{switch(e){case t.all:return"compact"===r?A:S;case t.priority:return"compact"===r?_:I;default:(0,a.vE)(e)}}}(T||(T={}))},84317:(e,t,r)=>{r.d(t,{HP:()=>o});var i=r(8725);if(75==r.j)var n=r(92569);if(75==r.j)var s=r(66310);if(75==r.j)var a=r(52249);function o(e,t,r,o,l,c){return i.Z.composeKnot({info:n.A.createLensCounterFlow(t,t.pipe(s.w((e=>l.getLens(e).view("count")))),c),switcher:(0,a.A)(e,t,r,o)})}},89186:(e,t,r)=>{r.d(t,{B:()=>b});var i=r(27378),n=r(5739),s=r(8725),a=r(92569),o=r(7046),l=r(21474),c=r(77176),u=r(15774),d=r(63969),p=r(2040);const h=d.u.style({display:"inline-flex",verticalAlign:"middle",marginRight:d.u.rem(.75),alignItems:"center"}),m=d.u.joinClasses([d.u.style({fontWeight:"bold"}),p.base]),g=d.u.style({minHeight:d.u.rem(1.5)}),f=d.u.style({$nest:{"&:not([data-disabled='true'])[data-hovered='true']":{backgroundColor:"transparent"}}}),y=d.u.style({display:"flex",justifyContent:"space-between",alignItems:"center"}),v=d.u.style({marginTop:d.u.rem(.35)});var b;!function(e){let t,r;e.Grid=s.UI.Grid.make((({slots:e})=>i.createElement(i.Fragment,null,i.createElement("span",{className:h},e.info),e.switcher))),e.GridWithBulkAccept=s.UI.Grid.make((({slots:e})=>i.createElement("div",{className:y},i.createElement("span",{className:v},e.headerContent),e.bulkAccept))),function(e){let t;!function(e){let t;!function(e){e.switchBack="switchBack"}(t=e.Kind||(e.Kind={}))}(t=e.Action||(e.Action={})),e.Component=s.UI.Node.make((({state:e,notify:r})=>i.createElement(n.F.Fragment,null,e.pipe(c.U((({lensTitle:e})=>i.createElement(i.Fragment,null,i.createElement("span",{className:m},e),i.createElement(o.zx.Flat,{name:"switch-back",title:"Back to all suggestions",className:f,onClick:()=>r({kind:t.Kind.switchBack})()},i.createElement(l.JO.Close,{className:g})))))))))}(t=e.LensFilter||(e.LensFilter={})),function(e){e.Component=s.UI.Grid.make((({slots:e})=>i.createElement(i.Fragment,null,i.createElement("span",{className:h},e.counter),e.filter)))}(r||(r={})),e.DefaultHeader=s.UI.Knot.make(e.Grid,{info:a.A.Component,switcher:u.H.Component}),e.LensInfoComponent=s.UI.Knot.make(r.Component,{counter:a.A.Component,filter:t.Component}),e.WithFilterHeader=s.UI.Knot.make(e.Grid,{info:e.LensInfoComponent,switcher:u.H.Component}),e.Component=s.UI.Union.make("kind",{withFilter:e.WithFilterHeader,withoutFilter:e.DefaultHeader})}(b||(b={}))},92644:(e,t,r)=>{if(r.d(t,{i:()=>h}),75==r.j)var i=r(22232);var n=r(8725);if(75==r.j)var s=r(66896);if(75==r.j)var a=r(40018);if(75==r.j)var o=r(24713);if(75==r.j)var l=r(28043);if(75==r.j)var c=r(85985);if(75==r.j)var u=r(77176);if(75==r.j)var d=r(57091);if(75==r.j)var p=r(87667);function h(e,t,r){const h=e.getLens(s.R.SpecialId.AllAlerts).pipe(o.j("count"),l.x()),m=e.getLens(s.R.SpecialId.Priority).pipe(o.j("count"),l.x()),g=r.pipe(c.h((e=>e!==s.R.SpecialId.Premium)),u.U((e=>e===s.R.SpecialId.Priority?"priority":"all")),l.x());return n.Z.fromSideEffect((e=>{switch(e){case p.n.Actions.switchToAll:t.events.next({type:"switchToLens",id:s.R.SpecialId.AllAlerts,focusFirst:!1,actionSource:a.l$.sidebar});break;case p.n.Actions.switchToPriority:t.events.next({type:"switchToLens",id:s.R.SpecialId.Priority,focusFirst:!1,actionSource:a.l$.sidebar});break;case p.n.Actions.openSetGoals:t.events.next({type:"setGoals"});break;default:(0,i.vE)(e)}}),g.pipe(d.a(h,m,((e,t,r)=>({allAlertsCount:t,priorityAlertsCount:r,selectedLens:e})))))}},87667:(e,t,r)=>{r.d(t,{n:()=>i});var i,n=r(27378),s=r(38983),a=r(5739),o=r(8725),l=r(44060),c=r(63969),u=r(40219),d=r(30763),p=r(7046),h=r(95286),m=r(21474),g=r(2844),f=r(77176);!function(e){let t;!function(e){e.switchToPriority="switchToPriority",e.switchToAll="switchToAll",e.openSetGoals="openSetGoals"}(t=e.Actions||(e.Actions={}));e.Switch=o.UI.Node.make((({state:e,notify:r})=>{const i=n.useContext(d.m.Context).priorityLens,o=s.h.create(!1);return n.createElement(h.L,{name:"priorityLensSwitch",appearanceBehavior:"mouseClick",showDelay:0,closeDelay:100,vAlign:"bottom",theme:{dropdownContainer:k.dropdownContainer,dropdownList:k.dropdownContent},onVisibilityChange:e=>o.set(e),label:n.createElement(a.F.Fragment,null,g.aj([e,o]).pipe(f.U((([{selectedLens:e,priorityAlertsCount:t,allAlertsCount:r},s])=>{const a="priority"===e,o=a?t:r;return n.createElement("div",{className:s?k.labelOpened:k.labelClosed},a?i.prioritySuggestion:i.allSuggestion,o>0&&n.createElement("span",{className:k.alertCount}," ","· ",o," "),n.createElement(m.JO.Arrow,{direction:s?m.n4.up:m.n4.down,className:k.labelArrow}))}))))},n.createElement(a.F.Fragment,null,e.pipe(f.U((({selectedLens:e,priorityAlertsCount:s,allAlertsCount:a})=>{const o="priority"===e;return n.createElement(n.Fragment,null,n.createElement(p.zx.Flat,{name:"priorityAlerts",className:o?k.boldLensButton:k.lensButton,onClick:r(t.switchToPriority)},n.createElement(m.JO.Star,{width:12}),i.prioritySuggestion,o?n.createElement(m.JO.Yes,{className:k.checkMarkIcon}):null),o&&s===a?n.createElement("div",{className:k.disabledLensButton},n.createElement(m.JO.Formatting.BulletList,{width:21}),i.disabledAllSuggestion):n.createElement(p.zx.Flat,{name:"allAlerts",className:o?k.lensButton:k.boldLensButton,onClick:r(t.switchToAll)},n.createElement(m.JO.Formatting.BulletList,{width:21}),i.allSuggestion,o?null:n.createElement(m.JO.Yes,{className:k.checkMarkIcon})),n.createElement("div",{className:k.separator}),n.createElement("div",{className:k.description},n.createElement(m.JO.Info,{className:k.descriptionIcon}),n.createElement("div",null,i.description)))})))))}))}(i||(i={}));const y={display:"flex",width:c.u.rem(16)},v={zIndex:u.FY,marginTop:0,fontSize:c.u.rem(.875),lineHeight:c.u.rem(1.3125)},b={display:"flex",boxSizing:"border-box",padding:`${c.u.rem(.1875)} ${c.u.rem(.25)} ${c.u.rem(.1875)} ${c.u.rem(.25)}`,height:c.u.rem(1.5),borderRadius:c.u.rem(u.fx),color:l.Il.CoreNeutral90,textTransform:"uppercase",letterSpacing:c.u.rem(.025),fontSize:c.u.rem(.625),lineHeight:c.u.rem(1.125),cursor:"pointer",userSelect:"none",$nest:{"&:hover":{backgroundColor:l.Il.CoreNeutral20}}},w={backgroundColor:l.Il.CoreNeutral10},S={color:l.Il.CoreNeutral50,whiteSpace:"pre"},I={minWidth:c.u.rem(1),minHeight:c.u.rem(1),marginLeft:c.u.rem(.5625)},A={padding:`0 ${c.u.rem(.5)}`,color:l.Il.CoreNeutral90,$nest:{"& i:first-child":{margin:0}}},_={display:"flex",padding:`0 ${c.u.rem(.5)}`,height:c.u.rem(2),color:l.Il.CoreNeutral50,alignItems:"center",cursor:"not-allowed"},C={margin:`${c.u.rem(.5)} ${c.u.rem(1)}`,width:`calc(100% - ${c.u.rem(2)})`,height:c.u.px(1),backgroundColor:l.Il.CoreNeutral20},E={display:"flex",padding:`0 ${c.u.rem(.5)} ${c.u.rem(.5)} ${c.u.rem(.5)}`,fontSize:c.u.rem(.75),lineHeight:c.u.rem(1.125),alignItems:"center"},T={marginBottom:"auto",minHeight:c.u.rem(1.25)},x={color:l.Il.CoreBlue60,cursor:"pointer"},k=c.u.stylesheet({dropdownContainer:[y],dropdownContent:[v],labelClosed:[b],labelOpened:[b,w],alertCount:[S],labelArrow:[I],lensButton:[A],disabledLensButton:[_],boldLensButton:[A,{fontWeight:"bold"}],checkMarkIcon:[{marginLeft:"auto"}],separator:[C],description:[E],descriptionIcon:[T],descriptionLink:[x]})},22621:(e,t,r)=>{r.d(t,{R:()=>me});var i=r(27378),n=r(8725),s=r(63899),a=r(40327),o=r(5739),l=r(38983),c=r(12187),u=r(8125),d=r(5114),p=r(71284),h=r(30763),m=r(7046),g=r(77797),f=r(29245),y=r(3656),v=r(44060),b=r(63969),w=r(24588),S=r(40219),I=r(21474);const A=({upgradeAction:e,size:t,title:r,className:n})=>{const s=i.useContext(h.m.Context).goPremium,a=Boolean(r)?r:s;return i.createElement(m.zx,Object.assign({name:"upgrade"},(0,c.Sh)(n,"big"===t?O.baseBig:"link"===t?O.link:O.baseSmall),{onClick:e}),"link"===t?i.createElement(I.JO.PaidLink,{width:14,className:O.linkIcon}):i.createElement(I.JO.Paid,{className:"big"===t?O.bigIcon:O.icon}),a)},_={background:v.Il.CoreGreen60,borderRadius:b.u.rem(S.fx),boxShadow:`0 2px 5px ${b.u.color(w.UE).fade(.35).toRGBA().toString()}`,color:v.Il.CoreNeutral0,textTransform:"uppercase",letterSpacing:b.u.rem(S.rX),fontWeight:"bold",$nest:{"&:not([data-disabled='true'])[data-hovered='true']":{background:b.u.color(v.Il.CoreGreen60).tint(.1).toRGBA().toString()},"&:not([data-disabled='true']):active":{background:b.u.color(v.Il.CoreGreen60).tint(.2).toRGBA().toString()}}},C={padding:`0 ${b.u.rem(3)} 0 ${b.u.rem(2)}`,fontSize:b.u.rem(.8125),lineHeight:b.u.rem(3)},E={padding:`0 ${b.u.rem(2)} 0 ${b.u.rem(.5)}`,fontSize:b.u.rem(.6875),lineHeight:b.u.rem(2)},T={background:v.Il.CoreGreen60,$nest:{"&:not([data-disabled='true'])[data-hovered='true']":{background:b.u.color(v.Il.CoreGreen60).tint(.1).toRGBA().toString()},"&:not([data-disabled='true']):active":{background:b.u.color(v.Il.CoreGreen60).tint(.2).toRGBA().toString()}}},x={padding:`0 ${b.u.rem(3)} 0 ${b.u.rem(2)}`,fontSize:b.u.rem(.8125),lineHeight:b.u.rem(3)},k={padding:`0 ${b.u.rem(2)} 0 ${b.u.rem(.5)}`,fontSize:b.u.rem(.6875),lineHeight:b.u.rem(2)},M={fill:v.Il.CoreNeutral0,$nest:{"&:not([data-disabled='true'])[data-hovered='true']":{fill:v.Il.CoreNeutral0}}},L={marginRight:b.u.rem(.2)},R={color:v.Il.CoreGreen60,fontSize:b.u.rem(.75),transition:"transform .2s ease-out",$nest:{"&:not([data-disabled='true'])[data-hovered='true']":{transform:"scale(1.05)"},"&:not([data-disabled='true']):active":{transition:"none",transform:"scale(1)"}}},N={color:v.Il.CoreGreen60},U={fill:v.Il.CoreGreen60,$nest:{"&:not([data-disabled='true'])[data-hovered='true'], &:not([data-disabled='true'])[data-active='true']":{fill:v.Il.CoreGreen60}}},D={fill:v.Il.CoreGreen60,$nest:{"&:not([data-disabled='true'])[data-hovered='true'], &:not([data-disabled='true'])[data-active='true']":{fill:v.Il.CoreGreen60}}},O=b.u.stylesheet({base:[_],baseBig:[_,C],baseSmall:[_,E],baseUpHookRedesign:[_,T],baseBigUpHookRedesign:[C,T,x],baseSmallUpHookRedesign:[E,T,k],icon:[M],bigIcon:[M,L],link:[R],linkUpHookRedesign:[R,N],linkIconUpHookRedesign:[U],linkIcon:[D]});var P=r(98403),F=r(85255),z=r(77176),j=r(2844),B=r(2834),W=r(57050);const H=.8125,G={display:"flex",flexDirection:"column",maxHeight:"90vh",width:b.u.rem(41.5),backgroundColor:v.Il.CoreNeutral0,textAlign:"left"},$={padding:`${b.u.rem(1.125)} ${b.u.rem(2)} ${b.u.rem(1)}`,paddingBottom:b.u.rem(1)},Y={paddingBottom:0,backgroundColor:v.Il.CoreNeutral0,flexShrink:0,$nest:{"&:after":{position:"absolute",bottom:0,display:"block",width:`calc(100% - ${b.u.rem(4)})`,height:b.u.px(1),background:v.Il.CoreNeutral20,content:"''"}}},V={display:"block",margin:`${b.u.rem(H)} 0`,color:v.Il.CoreNeutral90,fontWeight:v.xv.SmallLightWeight,lineHeight:b.u.rem(1.5)},Z={minHeight:b.u.rem(4)},Q={display:"flex",$nest:{"&:not(:last-child)":{marginBottom:b.u.rem(1.25),borderBottom:`1px solid ${v.Il.CoreNeutral20}`}}},q="setGoalsToneButton",X={marginBottom:b.u.rem(-.5),maxWidth:b.u.rem(27),justifyContent:"initial",flexWrap:"wrap",$nest:{[`& > .${q}`]:{margin:`0 0 ${b.u.rem(.5)}`,marginLeft:b.u.important(0),$nest:{"&:not(:last-child)":{marginRight:b.u.rem(.5)}}}}},J={width:b.u.rem(7),textTransform:"capitalize",lineHeight:b.u.rem(2)},K={marginTop:b.u.rem(H)},ee={margin:`0 0 ${b.u.rem(1.5)} ${b.u.rem(7)}`},te={margin:`0 0 ${b.u.rem(1.5)} ${b.u.rem(7)}`},re={position:"absolute",top:b.u.rem(2.5)},ie={display:"flex",width:b.u.percent(100),justifyContent:"space-between"},ne={color:v.Il.CoreNeutral90,fontWeight:300,fontSize:b.u.rem(.8125)},se=b.u.stylesheet({wrapper:[G],modalBody:[$],modalHeader:[Y],itemDescription:[V],modalFooter:[Z],row:[Q],toneButtons:[X],rowHeader:[J],extraContent:[K],title:[ee],description:[te],image:[re],footerWrapper:[ie],checkboxText:[ne]}),ae=({name:e,items:t,sticky:r,theme:n={},extraContent:s,children:a})=>i.createElement("div",{className:se.row},i.createElement("div",null,i.createElement(y.H3,{className:se.rowHeader},e),s),i.createElement("div",null,i.createElement(m.zx.Group,{sticky:r,className:n.buttonsGroup},t.map((t=>i.createElement(m.zx.White,Object.assign({className:n.button,name:`context-${e}-${t.key}`},t))))),i.createElement(y.x4,{className:se.itemDescription},a))),oe=({items:e,current:t,shouldDisable:r,itemTitle:i=W.yR})=>({sticky:!0,items:e.map((e=>({key:e,active:t.view((t=>t===e)),onClick:()=>t.set(e),disabled:r&&r(e),children:i(e)})))}),le=({items:e,current:t},r)=>({items:e.map((e=>({key:e,active:t.view((t=>(0,a.pipe)(t,d.exists((t=>t.has(e)))))),onClick:()=>t.modify((t=>{const r=(0,a.pipe)(t,d.fold((()=>new Set),(e=>new Set(e))));return r.has(e)?r.delete(e):r.add(e),d.some(r)})),children:r(e)})))}),ce=({blocks:e,features:t,showOnLoad:r,close:n,upgrade:a,reset:o,showOnLoadChanged:l})=>{const c=i.useContext(p.a.Context),u=P.Dx(t),d=P.Dx(e),h=P.Dx(r),m=P.Dx(n);return i.createElement(s.u_,{className:se.wrapper},i.createElement(s.u_.Header,{className:se.modalHeader},i.createElement(de,null)),i.createElement(s.u_.Body,{name:"goalsBody",className:se.modalBody},i.createElement(ue,{features:u,upgradeAction:a,blocks:d})),i.createElement(s.u_.Footer,{className:se.modalFooter},i.createElement(pe,{supportsSetGoalsLoader:u.pipe(z.U((e=>!e.demoMode&&c.has(p.a.Flag.supportsSetGoalsLoader)))),onDone:m,reset:o,showOnLoad:h,showOnLoadChanged:l})))},ue=({blocks:e,features:t,upgradeAction:r})=>{const n=i.useContext(h.m.Context).goals;return i.createElement(o.F.Fragment,null,j.aj(e,t).pipe(z.U((([{audience:e,formality:t,domain:s,tone:l,intent:c},u])=>i.createElement(i.Fragment,null,i.createElement(ae,Object.assign({name:"audience"},oe(e)),e.current.view((t=>t&&n.sections.audience[t]((0,a.pipe)(e.default,d.exists((e=>e===t))))))),i.createElement(ae,Object.assign({name:"formality"},oe(t)),t.current.view((e=>e?n.sections.formality[e]:""))),i.createElement(ae,Object.assign({name:"domain"},oe(Object.assign(Object.assign({},s),{itemTitle:e=>"mail"===e?"email":e})),{extraContent:i.createElement(o.F.div,{className:se.extraContent},u.isFree?i.createElement(A,{size:"link",upgradeAction:r}):null)}),s.current.view((e=>u.isFree?n.sections.domain.free:e?n.sections.domain[e]:""))),i.createElement(ae,Object.assign({name:"tone",theme:{buttonsGroup:se.toneButtons,button:q}},le(l,(e=>i.createElement(f.dy,{key:e},n.sections.tone.options[e])))),n.sections.tone.experimental),i.createElement(ae,Object.assign({name:"intent"},le(c,(e=>n.sections.intent.options[e]))),n.sections.intent.experimental))))))},de=()=>{const e=i.useContext(h.m.Context).goals,t=i.useContext(s.u_.TitleIdContext);return i.createElement(i.Fragment,null,i.createElement(y.H1,{id:t,className:se.title},e.title),i.createElement(he,null),i.createElement(y.XY,{className:se.description},e.header))},pe=({supportsSetGoalsLoader:e,showOnLoad:t,showOnLoadChanged:r,reset:n,onDone:s})=>{const a=i.useContext(h.m.Context),d=l.h.create(!1);return F.P.useSubscriptionTo(t.pipe(B.b(P.wW(d)))),F.P.useSubscriptionTo(d.pipe(B.b(r))),i.createElement(o.F.div,Object.assign({},(0,c.Sh)(e.pipe(z.U((0,u.RN)(se.footerWrapper,null))))),e.pipe(z.U((0,u.RN)(i.createElement(g.Ys,{checked:d,name:"set-goals"},i.createElement(y.x4,{className:se.checkboxText},a.goals.footer.showModalOnStart)),null))),i.createElement(m.zx.Group,null,i.createElement(m.zx.Ghost,{name:"reset",onClick:n},a.goals.footer.reset),s.pipe(z.U((e=>i.createElement(m.zx.Primary,{name:"closeSetContext",onClick:e},a.done))))))},he=()=>i.createElement("svg",{className:se.image,width:"69",height:"80",viewBox:"0 0 69 80"},i.createElement("g",{fill:"none",fillRule:"evenodd"},i.createElement("path",{d:"M28.935 70C12.955 70 0 57.045 0 41.065 0 25.085 12.955 12.13 28.935 12.13c15.98 0 28.936 12.954 28.936 28.935C57.87 57.045 44.917 70 28.936 70zm0-12.242c9.22 0 16.694-7.474 16.694-16.693 0-9.22-7.475-16.694-16.695-16.694s-16.693 7.475-16.693 16.695 7.474 16.693 16.693 16.693z",fill:"#4C7AF1"}),i.createElement("path",{d:"M28.935 57.758c-9.22 0-16.693-7.474-16.693-16.693 0-9.22 7.474-16.694 16.693-16.694 9.22 0 16.694 7.475 16.694 16.695s-7.475 16.693-16.695 16.693zm0-11.13a5.564 5.564 0 1 0 0-11.128 5.565 5.565 0 0 0 .001 11.129z",fill:"#BCDBFB"}),i.createElement("circle",{fill:"#FFF",cx:"28.935",cy:"41.065",r:"5.565"}),i.createElement("path",{stroke:"#4C7AF1",strokeLinecap:"round",strokeWidth:"1.5",d:"M15.024 68.016L9.46 78.5m32.274-10.484L47.298 78.5"}),i.createElement("path",{d:"M61.96 13.367a.65.65 0 0 1 .645.656.65.65 0 0 1-.646.655h-6.075L29.35 41.7a.636.636 0 0 1-.913 0 .663.663 0 0 1 0-.927L54.972 13.75V7.59a.65.65 0 0 1 .645-.656.65.65 0 0 1 .646.656v5.777h5.696zm3.17-3.215a.65.65 0 0 1 .646.655.65.65 0 0 1-.646.655h-6.34a.65.65 0 0 1-.647-.655V4.372a.65.65 0 0 1 .646-.655.65.65 0 0 1 .644.655v5.78h5.696zm3.17-3.218a.65.65 0 0 1 .647.656.65.65 0 0 1-.646.655h-6.34a.65.65 0 0 1-.647-.655V1.155A.65.65 0 0 1 61.96.5a.65.65 0 0 1 .645.655v5.78H68.3z",fill:"#4C7AF1"}),i.createElement("path",{d:"M49.267 20.486l-8.586 8.757",stroke:"#FFF",strokeWidth:"1.3"})));var me,ge=r(50628);!function(e){let t;e.Modal=n.UI.Node.make((({state:e,view:r,notify:n})=>{F.P.useSubscriptionTo(r("source").pipe(ge.P(),B.b((e=>n({kind:t.open,source:e})()))));const a=e.pipe(z.U((e=>n({kind:t.close,source:e.source,context:e.context,showOnLoad:e.showOnLoad}))));return i.createElement(s.ay,{positionType:"fixed",animate:!0,smallResolution:"resize",onClose:a},i.createElement(ce,{blocks:r("blocks"),features:r("features"),close:a,upgrade:n({kind:t.upgrade}),reset:n({kind:t.reset}),showOnLoad:r("showOnLoad"),showOnLoadChanged:e=>n({kind:t.showOnLoadChanged,value:e})()}))})),function(e){e.open="open",e.close="close",e.upgrade="upgrade",e.reset="reset",e.showOnLoadChanged="showOnLoadChanged"}(t=e.ActionsKind||(e.ActionsKind={}))}(me||(me={}))},16797:(e,t,r)=>{r.d(t,{p:()=>d});var i=r(57050),n=r(5114),s=r(83078),a=r(8725),o=r(35416),l=r(25975),c=r(76974),u=r(77176);function d(e,t){return a.Z.composeKnot({content:a.Z.fromSideEffect(i.Q1,h(e,t)),root:p()})}const p=()=>()=>c.of({});function h(e,t){const r=e.view(t.getActiveAlertsCount).view((e=>0===e)),a=e.view(l.v.Prism.getFeedItems());return e.pipe(u.U(o.In.getActiveItem),u.U((e=>{if(n.isNone(e))return{root:"empty",card:{kind:"empty"}};const o=s.MH(e),l=a.get(),c=(0,i.zG)(l.getAt(l.size-1),n.exists((e=>e.id===o.id)));return{root:o.id,card:t.viewState(r.get(),c)(o)}})))}},43314:(e,t,r)=>{r.d(t,{c:()=>i});var i,n=r(27378),s=r(5739),a=r(5114),o=r(8725),l=r(63969);!function(e){let t;function r(t){return o.UI.Knot.make(e.IdProvider,{card:o.UI.Composite.make(e.CardStyleProvider,t)})}!function(e){e.onMount="onMount"}(t=e.ActionsKind||(e.ActionsKind={})),e.assistant=function(t){return o.UI.Knot.make(e.AssistantBox,{content:r(t)})},e.AssistantBox=o.UI.Grid.make((({notify:e,slots:r})=>n.createElement(s.F.div,{id:"assistant-feed-wrapper",mount:r=>e({kind:t.onMount,element:a.fromNullable(r)})()},r.content))),e.card=r,e.CardStyleProvider=o.UI.Grid.make((({slots:e})=>n.createElement("div",{className:u.cardWrapper},e.children))),e.IdProvider=o.UI.Grid.make((({slots:e,state:t})=>n.createElement(s.F.div,{"data-id":t},e.card)))}(i||(i={}));const c={margin:`${l.u.rem(.5)} 0`,background:"none",userSelect:"none",$nest:{"&:before":{position:"absolute",left:l.u.rem(-.5),width:l.u.rem(.5),height:l.u.percent(100),background:"none",content:"''"}}},u=l.u.stylesheet({disableUserActions:[{pointerEvents:"none"}],cardWrapper:[c]})},29317:(e,t,r)=>{r.d(t,{N:()=>i});var i,n=r(64015),s=r(57050),a=r(77176),o=r(60797),l=r(41398),c=r(85985),u=r(5114),d=r(51838),p=r(15646),h=r(35416);!function(e){let t;!function(e){let t;!function(e){e.fromCardActions=(0,s.ls)(a.U((e=>{if(p.lY.isSDUICardAction(e)){const t=(0,s.zG)(e.actions,n.hX(d.zx.Action.isTransitionAction));return e.actions.find((e=>e.type===d.zx.ActionType.prevCard))?u.some({kind:"prevClicked",transitions:t}):e.actions.find((e=>e.type===d.zx.ActionType.nextCard))?u.some({kind:"nextClicked",transitions:t}):u.none}return u.none})),o.oA)}(t=e.Events||(e.Events={})),e.sideEffect=(e,t,r)=>({id:"SingleCardAssistant.prevNextNavigation",when:h.nL.Effect.When.isSidebarOpen,what:h.nL.Effect.ItemsApplicator.create((0,s.zG)(e,l.M(t.pipe(c.h(h.nL.hasCards))),a.U((([e,t])=>(0,s.zG)(t.currentLens.cardIndex,u.chain((r=>(0,s.zG)(t.currentLens.items.getAt("nextClicked"===e.kind?r+1:r-1),u.map((t=>(0,s.bc)(t,e))))))))),o.oA,a.U((([e,t])=>i=>h.nL.Prism.getLensWithItems().modify(r.selectItemById(e.id,t.transitions),i)))))})}(t=e.PrevNextNavigation||(e.PrevNextNavigation={}))}(i||(i={}))},74859:(e,t,r)=>{r.d(t,{i:()=>i});var i,n=r(57050),s=r(8125),a=r(95195),o=r(5114),l=r(83078),c=r(81531),u=r(51838),d=r(22848),p=r(35416);!function(e){const t=(0,s.HP)(c.C8.Logging.getLogger);let r;!function(e){e.create=e=>{const r=t("SingleCardAssistant.Transformers.disablePrevNextButtons");return({state:t,metadata:i})=>p.nL.hasItems(t)?(0,n.zG)(t.currentLens.cardIndex,o.chain((e=>(0,n.zG)(p.In.getActiveItem(t.currentLens),o.map((t=>(0,n.bc)(t,e)))))),o.map((([r,i])=>p.nL.Prism.getLensWithItems().modify((n=>{if(d.e.isSDUIItem(r)&&o.isSome(r.cardDSL)){const s=e.clone(r),a=l.MH(s.cardDSL);return u.ab.walk(a,(e=>{e.type===u.hC.button&&"prev"===e.name&&(e.state=0===i?u.zx.State.disabled:u.zx.State.enabled),e.type===u.hC.button&&"next"===e.name&&(e.state=i===t.currentLens.items.size-1?u.zx.State.disabled:u.zx.State.enabled)})),Object.assign(Object.assign({},n),{items:n.items.add(s)})}return n}),t))),o.getOrElse((()=>t)),(e=>a.t$({state:e,metadata:i}))):(r.trace("state has no feed items, returning original state"),a.t$({state:t,metadata:i}))}}(r=e.DisablePrevNextButtons||(e.DisablePrevNextButtons={}))}(i||(i={}))},69621:(e,t,r)=>{r.d(t,{Q:()=>i});var i,n=r(27378),s=r(8725);!function(e){e.Success=s.UI.Node.make((()=>n.createElement("div",null,"success"))),e.Empty=s.UI.Node.make((()=>n.createElement("div",null)))}(i||(i={}))},39321:(e,t,r)=>{r.d(t,{q:()=>xe});var i=r(27378),n=r(5739),s=r(22232),a=r(8725),o=r(30763),l=r(25970),c=r(7046),u=r(63899);const d=()=>i.createElement("svg",{width:"128",height:"177"},i.createElement("defs",null,i.createElement("rect",{id:"a",y:"14",width:"128",height:"128",rx:"64"})),i.createElement("g",{fill:"none",fillRule:"evenodd"},i.createElement("ellipse",{fill:"#F1F2FA",cx:"64",cy:"173",rx:"48",ry:"4"}),i.createElement("path",{d:"M27 0h62a5 5 0 0 1 5 5v91a5 5 0 0 1-5 5H24a5 5 0 0 1-5-5V8a8 8 0 0 1 8-8z",fill:"#F1F2FA"}),i.createElement("mask",{id:"b",fill:"#fff"},i.createElement("use",{xlinkHref:"#a"})),i.createElement("use",{fill:"#A2BCFF",xlinkHref:"#a"}),i.createElement("path",{d:"M116.708 48.783a4.144 4.144 0 0 1 5.672-1.465 4.138 4.138 0 0 1 1.466 5.667l-17.955 30.462a4.141 4.141 0 0 1-3.57 2.039 4.145 4.145 0 0 1-2.879-1.164l-12.527-12.1a4.138 4.138 0 0 1-.099-5.855 4.144 4.144 0 0 1 5.858-.099l8.747 8.45 15.287-25.935zm-63.446 45.53h58.877a4.141 4.141 0 0 1 4.142 4.139 4.141 4.141 0 0 1-4.142 4.14H53.262a4.141 4.141 0 0 1-4.143-4.14 4.141 4.141 0 0 1 4.143-4.14zM8.793 17.33h31.735a4.141 4.141 0 0 1 4.143 4.14 4.141 4.141 0 0 1-4.143 4.14H8.793a4.141 4.141 0 0 1-4.143-4.14 4.141 4.141 0 0 1 4.143-4.14zm0 17.526h31.735a4.141 4.141 0 0 1 4.143 4.14 4.141 4.141 0 0 1-4.143 4.14H8.793a4.141 4.141 0 0 1-4.143-4.14 4.141 4.141 0 0 1 4.143-4.14zm4.99 68.985a4.74 4.74 0 0 1-4.686 4.794 4.74 4.74 0 0 1-.111-9.477 4.74 4.74 0 0 1 4.798 4.683zm16.757 16.106a4.141 4.141 0 0 1 4.142-4.14 4.141 4.141 0 0 1 4.143 4.14c0 9.416-7.665 17.076-17.087 17.076S4.65 129.363 4.65 119.947a4.141 4.141 0 0 1 4.143-4.14 4.141 4.141 0 0 1 4.143 4.14c0 4.85 3.948 8.796 8.802 8.796 4.853 0 8.802-3.946 8.802-8.796zM8.793 76.46c-1.06 0-2.12-.405-2.93-1.213a4.138 4.138 0 0 1 0-5.855l4.274-4.27-4.273-4.27a4.138 4.138 0 0 1 0-5.855 4.145 4.145 0 0 1 5.859 0l4.273 4.27 4.273-4.27a4.144 4.144 0 0 1 5.858 0 4.138 4.138 0 0 1 0 5.855l-4.273 4.27 4.274 4.27a4.138 4.138 0 0 1-2.93 7.068c-1.06 0-2.12-.405-2.929-1.213l-4.273-4.27-4.273 4.27a4.133 4.133 0 0 1-2.93 1.213zm87.342 44.285l13.678 9.075a4.138 4.138 0 0 1 1.16 5.739 4.144 4.144 0 0 1-5.743 1.159l-11.387-7.555-11.386 7.555a4.143 4.143 0 0 1-4.378.128l-12.844-7.478-11.078 7.35c-.705.468-1.5.691-2.288.691a4.14 4.14 0 0 1-2.295-7.589l13.227-8.776a4.144 4.144 0 0 1 4.377-.128l12.844 7.478 11.53-7.65a4.145 4.145 0 0 1 4.583 0zM31.23 86.814a4.141 4.141 0 0 1 4.142-4.14 4.141 4.141 0 0 1 4.143 4.14v19.402a4.141 4.141 0 0 1-4.143 4.14 4.141 4.141 0 0 1-4.142-4.14V86.814z",fill:"#BDCFFF",mask:"url(#b)"}),i.createElement("path",{d:"M36 12h65a5 5 0 0 1 5 5v88a8 8 0 0 1-8 8H36a5 5 0 0 1-5-5V17a5 5 0 0 1 5-5z",fill:"#7CA1FF",mask:"url(#b)"}),i.createElement("rect",{fill:"#FFF",x:"25",y:"6",width:"75",height:"101",rx:"5"}),i.createElement("path",{d:"M38 21h49a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H38a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1zm0 13h32a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H38a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1z",fill:"#F1F2FA"})));var p,h=r(42329),m=r(3656),g=r(77176),f=r(12187),y=r(76024);!function(e){function t(e,t){var r=t/60,i=y.nH(e/r);return i.s=i.h>0&&i.m>10?0:Math.floor(i.s),i}e.calculateReadingTime=function(e){return t(e,250)},e.calculateSpeakingTime=function(e){return t(e,130)},e.generateStats=function(t,r){var i={words:t,chars:r,sentences:Math.floor(t/5),readingTime:{},speakingTime:{},uniqueWords:40*Math.random(),uniqueWordsIndex:100*Math.random(),rareWords:20*Math.random(),rareWordsIndex:100*Math.random(),wordLength:5.4,wordLengthIndex:100*Math.random(),sentenceLength:16.7,sentenceLengthIndex:100*Math.random(),readabilityScore:73,readabilityDescription:"Your text is likely to be understood by a reader who has at least 7th grade education (age 12)"};return i.readingTime=e.calculateReadingTime(i.words),i.speakingTime=e.calculateSpeakingTime(i.words),i}}(p||(p={}));var v=r(18208),b=r(5114),w=r(44060),S=r(63969),I=r(24588),A=r(40219),_=r(21474),C=r(40327),E=r(38983),T=r(2844),x=r(66310),k=r(93508),M=r(16118),L=r(76974),R=r(13444);const N=e=>{const{score:t,documentIsEmpty:r,sidebarOpen:s=E.h.create(!0),successIcon:a,progressIcon:o,zeroIcon:l=null}=e,c=t.pipe(g.U(b.map((e=>e.rank)))),u=T.aj(t,r,((e,t)=>(0,C.pipe)(e,b.fold((()=>!1),(({rank:e})=>100===e&&!t))))),d=s.pipe(x.w((e=>e?c.pipe(k.O(b.none),M.G(),x.w((([e,t])=>(0,C.pipe)(t,b.fold((()=>L.of(l)),(t=>u.pipe(k.O(!1),M.G(),x.w((([r,i])=>i?L.of(a):(0,C.pipe)(e,b.filter((()=>!r)),b.fold((()=>L.of(o(t)).pipe(R.g(1),k.O(o(0)))),(()=>L.of(o(t)))))))))))))):L.of(null))),k.O(null));return i.createElement(n.F.Fragment,null,d)};var U=r(98403);function D({value:e,className:t,leftCustomClass:r,rightCustomClass:s}){const a=E.h.create(!1);requestAnimationFrame((()=>requestAnimationFrame((()=>a.set(!0)))));const o=T.aj(U.Dx(e),a,((e,t)=>t?`${Math.max(5,Math.abs(e-50))}%`:0)),l=(e,t,r)=>U.Dx(e).pipe(g.U((e=>e<50?t:r)));return i.createElement(n.F.div,Object.assign({},(0,f.Sh)((e=>U.Dx(e).pipe(g.U((e=>e<50?j.leftSideWrapper:j.rightSideWrapper))))(e),t)),i.createElement(n.F.div,Object.assign({},(0,f.Sh)(l(e,j.leftSideProgress,j.rightSideProgress),Boolean(r)&&Boolean(s)&&l(e,r,s)),{style:{width:o}})))}!function(e){e.Label=({value:e,className:t})=>{const r=i.useContext(o.m.Context).performance,n=e>66?r.aboveAverage:e>50?r.average:r.belowAverage;return i.createElement(m.x4,{className:t},n)}}(D||(D={}));const O={position:"relative",zIndex:1,display:"flex",width:S.u.percent(100),height:S.u.rem(.25),borderRadius:S.u.rem(A.fx)},P={height:S.u.percent(100),backgroundColor:I.FW,transition:"width .8s ease-in-out 0s"},F={marginRight:S.u.percent(50),borderTopLeftRadius:S.u.rem(.25),borderBottomLeftRadius:S.u.rem(.25)},z={marginLeft:S.u.percent(50),borderTopRightRadius:S.u.rem(.25),borderBottomRightRadius:S.u.rem(.25)},j=S.u.stylesheet({wrapper:[O],leftSideWrapper:[O,{justifyContent:"flex-end"}],rightSideWrapper:[O,{justifyContent:"flex-start"}],progress:[P],leftSideProgress:[P,F],rightSideProgress:[P,z]});var B=r(63847);const W={display:"flex",flexDirection:"column",maxHeight:"90vh",width:S.u.rem(32),height:S.u.rem(41),background:w.Il.CoreNeutral0},H={padding:`${S.u.rem(2.75)} ${S.u.rem(1)} 0 ${S.u.rem(2)}`,minHeight:S.u.rem(5.1),height:S.u.rem(5.1),backgroundColor:w.Il.CoreNeutral0},G={marginRight:S.u.rem(1),paddingBottom:S.u.rem(.3),borderBottom:`1px solid ${I.xO}`},$={padding:`0 ${S.u.rem(1)} ${S.u.rem(1)} ${S.u.rem(2)}`},Y={padding:`0 ${S.u.rem(1.9)}`,minHeight:S.u.rem(4),height:S.u.rem(4)},V={position:"absolute",top:S.u.rem(-5.15),right:0,bottom:0,left:0,margin:"auto"},Z={display:"flex",flexDirection:"column",marginTop:S.u.rem(7.15),marginBottom:S.u.rem(2),paddingRight:S.u.rem(1),alignItems:"center"},Q={wordSpacing:S.u.rem(.05),fontSize:S.u.rem(.875),lineHeight:S.u.rem(1.5)},q={padding:`${S.u.rem(1.3)} ${S.u.rem(2.6)}`,textAlign:"center"},X=S.u.prefixedStylesheet("statistics",{wrapper:[W],modalHeader:[H],modalHeaderUnderline:[G],modalReady:[{transition:"opacity .2s"}],modalEmpty:[{opacity:0}],modalBody:[$],modalFooter:[Y],loader:[V],zeroStateContainer:[Z],performanceText:[Q],zeroStateText:[Q,q]});var J;!function(e){e.number="number",e.time="time",e.percentage="percentage"}(J||(J={}));const K=e=>{switch(e){case J.number:case J.percentage:return Ee.numberRowData;case J.time:return Ee.timeRowData;default:return(0,s.vE)(e)}},ee=({type:e,value:t,info:r,children:n,dataName:a})=>i.createElement("div",{className:Ee.row,"data-name":a},i.createElement("div",{className:K(e)},i.createElement("div",{className:Ee.metricTitle},n),i.createElement("div",{className:Ee.metric},((e,t)=>{switch(e){case J.number:return(Math.round(10*t)/10).toLocaleString();case J.time:return y.g2(t);case J.percentage:return Math.round(t)+"%";default:return(0,s.vE)(e)}})(e,t))),Boolean(r)?i.createElement(c.RZ,{title:r}):null),te=({state:e})=>{const t=i.useContext(o.m.Context).performance,{stats:r,score:s,documentIsEmpty:a}=e;return i.createElement(i.Fragment,null,i.createElement("section",{className:Ee.titleSection},i.createElement("div",{className:Ee.titleColumns},i.createElement(n.F.div,Object.assign({},(0,f.Sh)(X.performanceText,Ee.headerDescription)),100===s.rank?t.score100:t.scoreUnder100(s.rank)),i.createElement(N,{score:L.of(b.some(s)),documentIsEmpty:L.of(a),successIcon:i.createElement(_.JO.CheckmarkAnimated,{key:"modal-checkmark",width:50,className:Ee.checkmark}),progressIcon:e=>i.createElement(B.P,{key:"modal-performance-progress",colorType:B.P.ColorType.royalBlue,fontSize:B.P.FontSize.small,percentage:e,theme:Te})}))),i.createElement("section",{className:Ee.wordCountSection},i.createElement(m.H2,{className:Ee.sectionHeaderUnderline},t.wordCount),i.createElement("div",{className:Ee.wordCountColumns},i.createElement("div",{className:Ee.firstColumn},i.createElement(ee,{type:J.number,value:Math.max(r.chars-1,0)},t.characters),i.createElement(ee,{type:J.number,value:r.words},t.words),i.createElement(ee,{type:J.number,value:r.sentences},v._6(r.sentences,t.sentence,t.sentences))),i.createElement("div",{className:Ee.secondColumn},i.createElement(ee,{type:J.time,value:p.calculateReadingTime(r.words)},t.readingTime),i.createElement(ee,{type:J.time,value:p.calculateSpeakingTime(r.words)},t.speakingTime)))),i.createElement("section",{className:Ee.readabilitySection},i.createElement("div",{className:Ee.sectionHeaderWrapper},i.createElement(m.H2,null,t.readability),i.createElement(m.CL,null,t.sectionTitleDescription)),i.createElement("div",{className:Ee.readabilityColumns},i.createElement("div",{className:Ee.firstColumn},i.createElement(ee,{type:J.number,value:r.wordLength},t.wordLengthTitle),i.createElement(ee,{type:J.number,value:r.sentenceLength},t.sentenceLengthTitle),i.createElement(ee,{type:J.number,value:r.readabilityScore,info:t.readabilityDescription,dataName:"readability"},t.readabilityScore)),i.createElement("div",{className:Ee.secondColumn},i.createElement("div",{className:Ee.row},i.createElement(D,{value:r.wordLengthIndex,className:Ee.progressBar,leftCustomClass:Ee.leftProgress,rightCustomClass:Ee.rightProgress}),i.createElement(D.Label,{value:r.wordLengthIndex,className:Ee.progressLabel})),i.createElement("div",{className:Ee.row},i.createElement(D,{value:r.sentenceLengthIndex,className:Ee.progressBar,leftCustomClass:Ee.leftProgress,rightCustomClass:Ee.rightProgress}),i.createElement(D.Label,{value:r.sentenceLengthIndex,className:Ee.progressLabel})),i.createElement("div",{className:Ee.verticalPillar}))),i.createElement(m.CL,{className:Ee.readabilityDescr},r.readabilityDescription)),i.createElement("section",null,i.createElement("div",{className:Ee.sectionHeaderWrapper},i.createElement(m.H2,null,t.vocabulary),i.createElement(m.CL,null,t.sectionTitleDescription)),i.createElement("div",{className:Ee.vocabularyColumns},i.createElement("div",{className:Ee.firstColumn},i.createElement(ee,{type:J.percentage,value:r.uniqueWords,info:t.uniqueWords},t.uniqueWordsTitle),i.createElement(ee,{type:J.percentage,value:r.rareWords,info:t.rareWords},t.rareWordsTitle)),i.createElement("div",{className:Ee.secondColumn},i.createElement("div",{className:Ee.row},i.createElement(D,{value:r.uniqueWords,className:Ee.progressBar,leftCustomClass:Ee.leftProgress,rightCustomClass:Ee.rightProgress}),i.createElement(D.Label,{value:r.uniqueWords,className:Ee.progressLabel})),i.createElement("div",{className:Ee.row},i.createElement(D,{value:r.rareWords,className:Ee.progressBar,leftCustomClass:Ee.leftProgress,rightCustomClass:Ee.rightProgress}),i.createElement(D.Label,{value:r.rareWords,className:Ee.progressLabel})),i.createElement("div",{className:Ee.verticalPillar})))))},re={marginBottom:S.u.rem(2.4)},ie={display:"flex",marginTop:S.u.rem(.9),marginRight:S.u.rem(1),justifyContent:"space-between"},ne={marginBottom:S.u.rem(1.5)},se={display:"flex",marginTop:S.u.rem(.8)},ae={marginBottom:S.u.rem(2.4)},oe={display:"flex",marginTop:S.u.rem(.8)},le={display:"flex",marginTop:S.u.rem(.8)},ce={flexBasis:S.u.percent(50)},ue={position:"relative",paddingLeft:S.u.rem(.5),flexBasis:S.u.percent(50)},de={display:"flex",height:S.u.rem(2),alignItems:"center"},pe={display:"flex",justifyContent:"space-between"},he={width:S.u.rem(10),fontFeatureSettings:`${A.Q9}, ${A.g_}`},me={width:S.u.rem(13)},ge={marginRight:S.u.rem(1),paddingBottom:S.u.rem(.5),borderBottom:`1px solid ${I.xO}`},fe={width:S.u.percent(80),whiteSpace:"pre-line"},ye={display:"inline-block",color:w.Il.CoreBlue50,textAlign:"right",fontWeight:"bold",fontSize:S.u.rem(.875),lineHeight:S.u.rem(2)},ve={display:"inline-block",color:w.Il.CoreNeutral90,fontSize:S.u.rem(.875),lineHeight:S.u.rem(2)},be={width:S.u.rem(3.2),height:S.u.rem(3.2),fontWeight:"bold"},we={width:S.u.rem(6),backgroundColor:I.xO},Se={marginLeft:S.u.rem(1.125)},Ie={backgroundImage:I.BZ},Ae={backgroundImage:I.Xd},_e={display:"block",paddingTop:S.u.rem(.5)},Ce={position:"absolute",top:S.u.rem(.5),left:S.u.rem(3.5),width:S.u.rem(.0625),height:S.u.rem(3),backgroundColor:I.jj},Ee=S.u.stylesheet({titleSection:[re],titleColumns:[ie],wordCountSection:[ne],wordCountColumns:[se],readabilitySection:[ae],readabilityColumns:[oe],vocabularyColumns:[le],firstColumn:[ce],secondColumn:[ue],row:[de],rowData:[pe],numberRowData:[pe,he],timeRowData:[pe,me],sectionHeaderUnderline:[ge],sectionHeaderWrapper:[ge,{display:"flex",alignItems:"baseline",justifyContent:"space-between"}],headerDescription:[fe],metric:[ye],metricTitle:[ve],checkmark:[{alignItems:"center"}],circleProgressBar:[be],progressBar:[we],progressLabel:[Se],leftProgress:[Ie],rightProgress:[Ae],readabilityDescr:[_e],verticalPillar:[Ce]}),Te={radialProgressBar:Ee.circleProgressBar};var xe;!function(e){let t;e.ModalView=a.UI.Grid.make((({slots:r,state:n,notify:s})=>{const a=s({kind:t.close});return i.createElement(u.ay,{positionType:"fixed",animate:!0,smallResolution:"resize",onClose:a},i.createElement(e.ModalContent,{state:n,downloadButton:r.downloadButton,onClose:a}))})),function(e){e.close="close"}(t=e.ActionsKind||(e.ActionsKind={})),e.ModalContent=({state:t,downloadButton:r,onClose:n})=>i.createElement(u.u_,{className:X.wrapper},i.createElement(u.u_.Header,{className:X.modalHeader},i.createElement(e.Header,{state:t})),i.createElement(u.u_.Body,{name:"performanceBody",className:X.modalBody,wrapperClassName:t.pipe(g.U((e=>e.type===l.g.State.Type.EMPTY?X.modalEmpty:X.modalReady)))},i.createElement(e.Body,{state:t})),i.createElement(u.u_.Footer,{className:X.modalFooter},i.createElement(f,{downloadButton:r,onClose:n})));const r=()=>{const e=i.useContext(o.m.Context);return i.createElement("div",{className:X.zeroStateContainer},i.createElement(d,null),i.createElement("div",{className:X.zeroStateText},e.performance.notEnoughTextToCalculateStats))};e.Header=({state:e})=>{const t=i.useContext(o.m.Context),r=i.useContext(u.u_.TitleIdContext);return i.createElement(n.F.Fragment,null,e.pipe(g.U((e=>i.createElement(m.H2,{key:"statisticsHeader",id:r,className:e.type===l.g.State.Type.READY?X.modalHeaderUnderline:""},t.performance.title)))))};const p=()=>i.createElement(h.$,{size:64,className:X.loader,variation:"blue"});e.Body=({state:e})=>i.createElement(n.F.Fragment,null,e.pipe(g.U((e=>{switch(e.type){case l.g.State.Type.EMPTY:return null;case l.g.State.Type.LOADING:case l.g.State.Type.ERROR:return i.createElement(p,{key:"statisticsLoading"});case l.g.State.Type.SHORT_CONTENT:return i.createElement(r,{key:"statisticsEmpty"});case l.g.State.Type.READY:return i.createElement(te,{key:"statisticsContent",state:e});default:return(0,s.vE)(e)}}))));const f=({downloadButton:e,onClose:t})=>i.createElement(i.Fragment,null,e,i.createElement(c.zx.Primary,{name:"close-stats",onClick:t},"Close"))}(xe||(xe={}))},89379:(e,t,r)=>{r.d(t,{wK:()=>m,JT:()=>g,hM:()=>f});var i=r(40327),n=r(5114),s=r(8125),a=r(22232),o=r(93756),l=r(8725),c=r(27125),u=r(77176);function d(e){return{title:e.title,firstLine:n.fromNullable(e.firstLine)}}const p=(e,t)=>{const r=t.successLens;switch(e){case c.g.SuccessType.zero:return r.emptyText;case c.g.SuccessType.small:return r.smallText;case c.g.SuccessType.large:return r.largeText;case c.g.SuccessType.applied:return{title:r.fixedText.titles[(0,s.TN)(9)]};case c.g.SuccessType.premiumOnboardingStart:return r.premiumOnboardingStartText;case c.g.SuccessType.premiumOnboardingComplete:return r.premiumOnboardingCompleteText;default:return(0,a.vE)(e)}};function h(e){switch(e){case c.g.SuccessType.applied:case c.g.SuccessType.large:return"growComplete";case c.g.SuccessType.premiumOnboardingStart:return"premiumOnboardingStart";case c.g.SuccessType.premiumOnboardingComplete:return"premiumOnboardingComplete";default:return"growStart"}}function m(e,t){return()=>e.pipe(u.U((e=>{const r=p(e,t);return{kind:h(e),caption:n.some(d(r))}})))}function g(e,t){return()=>e.pipe(u.U((e=>{const r=p(e,t);return{kind:h(e),caption:n.some(d(r))}})))}function f(e){return l.Z.animatingFlow(e,(e=>(0,i.pipe)(e,n.fold((()=>n.some(o.F2("fadein"))),(()=>n.some(o.Hk("fadeout","fadein")))))))}},28378:(e,t,r)=>{r.d(t,{q:()=>O});var i=r(27378),n=r(40327),s=r(5739),a=r(83078),o=r(8725),l=r(44060),c=r(63969),u=r(3656),d=r(77176),p=r(34685);const h=o.UI.Node.make((()=>i.createElement("svg",{width:"112",height:"126",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i.createElement("g",{clipPath:"url(#clip0)"},i.createElement("rect",{x:"27.482",y:"24.867",width:"57.037",height:"76.267",rx:"28.518",fill:"#D7F7F0"}),i.createElement("path",{d:"M62.399 71.25l11.766-6.85c1.994-1.14 4.587-.83 6.182.831L60.504 77.164",fill:"#D1CEF4"}),i.createElement("path",{d:"M62.399 71.25l11.766-6.85c1.994-1.14 4.587-.83 6.182.831L60.504 77.164",stroke:"#0E101A",strokeMiterlimit:"10"}),i.createElement("path",{d:"M63.994 66.787l9.074-10.48c1.795-2.075 4.787-2.801 7.28-1.66L64.194 74.674",fill:"#D1CEF4"}),i.createElement("path",{d:"M63.994 66.787l9.074-10.48c1.795-2.075 4.787-2.801 7.28-1.66L64.194 74.674",stroke:"#0E101A",strokeMiterlimit:"10"}),i.createElement("path",{d:"M62.897 59.213l2.393-5.396-.199-2.075c-.399-3.32 1.396-6.434 4.288-7.679l.997 10.377-5.883 20.234S47.442 87.229 46.743 89.2c-.598 1.66.2 11.311.698 15.046.4 3.217-20.64 4.047-19.943 1.246 1.297-4.462 4.587-15.046 5.186-17.537.997-3.528-.599-12.348 2.991-18.677 1.596-2.802 5.983-9.858 7.18-13.075 1.396-3.424 1.595-7.678 1.595-7.678 5.385 1.349 3.69 9.961 1.595 14.942-2.193 5.292 6.382 4.67 8.676.726 1.695-3.009 2.891-5.292 2.891-5.292l-.398-5.5-.4-.31c-2.492-2.283-3.29-6.019-1.794-9.235l6.382 7.263 1.495 8.094-1.495 11.206 1.495-11.206z",fill:"#D1CEF4"}),i.createElement("path",{d:"M62.897 59.213l2.393-5.396-.199-2.075c-.399-3.32 1.396-6.434 4.288-7.679l.997 10.377-5.883 20.234S47.442 87.229 46.743 89.2c-.598 1.66.2 11.311.698 15.046.4 3.217-20.64 4.047-19.943 1.246 1.297-4.462 4.587-15.046 5.186-17.537.997-3.528-.599-12.348 2.991-18.677 1.596-2.802 5.983-9.858 7.18-13.075 1.396-3.424 1.595-7.678 1.595-7.678 5.385 1.349 3.69 9.961 1.595 14.942-2.193 5.292 6.382 4.67 8.676.726 1.695-3.009 2.891-5.292 2.891-5.292l-.398-5.5-.4-.31c-2.492-2.283-3.29-6.019-1.794-9.235l6.382 7.263 1.495 8.094zm0 0l-1.495 11.206",stroke:"#0E101A",strokeMiterlimit:"10"})),i.createElement("path",{d:"M54.822 50.297c0 1.948-1.496 3.59-3.49 3.59-1.995 0-3.49-1.54-3.49-3.59 0-2.052 1.495-5.231 3.49-5.231 1.994 0 3.49 3.282 3.49 5.23z",fill:"#F6DF6C",stroke:"#0E101A",strokeMiterlimit:"10",strokeLinejoin:"round"}),i.createElement("path",{d:"M58.411 32.86s-2.194-4.307 1.596-7.897c3.09-2.974 8.276-4.41 10.07-4.923.3-.102.6.205.6.513-.1 1.436-.5 5.026-1.995 7.795-1.695 3.18-6.183 6.359-10.27 4.513zM54.123 37.066s3.49-8.41-9.273-13.334c-.3-.102-.698.206-.599.513.2 1.026.5 3.077.699 5.026.398 4.82 1.396 10.462 9.173 7.795z",fill:"#15C39A",stroke:"#0E101A",strokeMiterlimit:"10"}),i.createElement("path",{d:"M51.431 45.066c.598-4.41 2.393-9.334 7.28-12.513",stroke:"#0E101A",strokeMiterlimit:"10"}),i.createElement("defs",null,i.createElement("clipPath",{id:"clip0"},i.createElement("rect",{x:"27.482",y:"24.867",width:"57.037",height:"76.267",rx:"28.518",fill:"#fff"})))))),m=o.UI.Node.make((()=>i.createElement("svg",{width:"112",height:"126",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i.createElement("rect",{x:"28",y:"26.25",width:"56",height:"73.5",rx:"28",fill:"#DBEBFF"}),i.createElement("path",{d:"M78.5 103.284S73.702 64.99 25.9 42.79",stroke:"#0E101A",strokeMiterlimit:"10"}),i.createElement("path",{d:"M73.797 88.742s-4.895-9.307 4.512-21.619c0 0 6.91 7.465-4.512 21.619z",fill:"#D7E8A9",stroke:"#0E101A",strokeMiterlimit:"10",strokeLinejoin:"round"}),i.createElement("path",{d:"M73.701 88.839S69.958 78.95 54.696 77.98c0 0 .96 10.082 19.005 10.858zM63.239 71.195s-6.335-6.496-1.728-19.001c0 .096 7.583 4.362 1.728 19z",fill:"#D7E8A9",stroke:"#0E101A",strokeMiterlimit:"10",strokeLinejoin:"round"}),i.createElement("path",{d:"M63.143 71.292s-5.567-7.174-18.43-4.072c0 0 3.36 8.143 18.43 4.072zM50.089 57.526s-5.952-4.363-3.84-15.027c0 0 6.623 2.52 3.84 15.026z",fill:"#D7E8A9",stroke:"#0E101A",strokeMiterlimit:"10",strokeLinejoin:"round"}),i.createElement("path",{d:"M49.993 57.623s-5.376-5.042-15.358-.873c0 0 3.743 6.108 15.358.873z",fill:"#D7E8A9",stroke:"#0E101A",strokeMiterlimit:"10",strokeLinejoin:"round"}),i.createElement("path",{d:"M42.314 52.097c-4.8-3.297-10.27-6.399-16.414-9.21",stroke:"#0E101A",strokeMiterlimit:"10"}),i.createElement("path",{d:"M36.65 48.413s-4.607-2.327-4.319-9.986c0-.097 4.895.97 4.32 9.986z",fill:"#D7E8A9",stroke:"#0E101A",strokeMiterlimit:"10",strokeLinejoin:"round"}),i.createElement("path",{d:"M36.65 48.51S32.331 45.6 25.9 49.673c0-.097 3.264 3.78 10.75-1.163z",fill:"#D7E8A9",stroke:"#0E101A",strokeMiterlimit:"10",strokeLinejoin:"round"}),i.createElement("path",{d:"M42.778 85.615c0-2.917-2.194-5.216-4.978-5.216 2.785 0 4.978-2.298 4.978-5.216 0 2.918 2.194 5.216 4.979 5.216-2.785 0-4.979 2.299-4.979 5.216z",fill:"#D1CEF4",stroke:"#0E101A",strokeMiterlimit:"10",strokeLinejoin:"round"}),i.createElement("path",{d:"M56.597 42.094c0-2.652-1.994-4.742-4.525-4.742 2.531 0 4.525-2.09 4.525-4.741 0 2.652 1.995 4.742 4.526 4.742-2.531 0-4.526 2.09-4.526 4.741z",fill:"#FCF5D0",stroke:"#0E101A",strokeMiterlimit:"10",strokeLinejoin:"round"}),i.createElement("path",{d:"M80.06 61.062c0-3.13-2.354-5.596-5.341-5.596 2.987 0 5.34-2.465 5.34-5.595 0 3.13 2.354 5.595 5.341 5.595-2.987 0-5.34 2.466-5.34 5.596z",fill:"#F8C6DA",stroke:"#0E101A",strokeMiterlimit:"10",strokeLinejoin:"round"}),i.createElement("path",{d:"M77 43.212c5.412 0 9.8-4.43 9.8-9.895 0-5.464-4.388-9.894-9.8-9.894-5.412 0-9.8 4.43-9.8 9.894 0 5.465 4.388 9.895 9.8 9.895z",fill:"#15C39A",stroke:"#0E101A",strokeMiterlimit:"10"}),i.createElement("path",{d:"M83.037 29.695c-.35-.353-1.05-.353-1.487 0l-6.125 6.184-2.625-2.65c-.35-.353-1.05-.353-1.487 0-.175.177-.263.442-.263.707 0 .265.088.53.263.706l3.412 3.446c.175.176.438.265.7.265.263 0 .525-.089.7-.265l6.825-6.89c.438-.443.438-1.061.087-1.503z",fill:"#fff"})))),g=o.UI.Node.make((()=>i.createElement("video",{className:y.premiumOnboardingStartVideo,autoPlay:!0,loop:!0,muted:!0,poster:"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjY0IiBoZWlnaHQ9IjEyMCIgdmlld0JveD0iMCAwIDI2NCAxMjAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxwYXRoIGQ9Ik0xMTIuODA5IDgxLjcwNDVDMTEyLjgwOSA4OS4xMDY3IDEyOS40NDEgOTcuOTcxMiAxMjkuNDQxIDk3Ljk3MTJMMTI0LjE0MSAxMDkuMzk0IiBzdHJva2U9IiMxRjI0M0MiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIvPgo8cGF0aCBkPSJNMTEzLjA4MyA4Mi44OTI1QzExMy45OTcgODIuNjE4MyAxMTQuNDU0IDgyLjA3IDExNC42MzYgODEuNjEzMUMxMTQuOTExIDgxLjA2NDggMTE0LjgxOSA4MC40MjUxIDExNC40NTQgNzkuOTY4MUwxMTAuOTgxIDc1Ljk0NzFMMTEwLjM0MSA4MS4yNDc1QzExMC4yNSA4MS43OTU4IDExMC41MjQgODIuNDM1NSAxMTEuMDcyIDgyLjcwOTdDMTExLjUyOSA4Mi45ODM5IDExMi4xNjkgODMuMTY2NiAxMTMuMDgzIDgyLjg5MjVaIiBmaWxsPSIjMTVDMzlBIiBzdHJva2U9IiMxQzI1M0MiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjxwYXRoIGQ9Ik0xMTguNjU4IDcyLjIwMDRDMTE3LjEwNCA3NS43NjQ1IDExNC44MTkgNzguNTk3NCAxMTIuMDc4IDc5LjQxOTlDMTA1LjU4OSA4MS40MzA0IDk0Ljg5NzMgNzIuNjU3MyA5Mi42MTI2IDY0Ljk4MDlDOTAuNDE5NCA1Ny42NzAxIDk0LjI1NzYgNTAuMDg1IDEwMS4yMDMgNDcuMzQzNUMxMDEuNTY4IDQ3LjE2MDcgMTAxLjkzNCA0Ny4wNjkzIDEwMi4zIDQ2Ljk3NzlDMTA5Ljg4NSA0NC42OTMzIDExOC4wMTggNDguOTg4NCAxMjAuMzAzIDU2LjU3MzRDMTIxLjU4MiA2MS4wNTEzIDEyMC43NTkgNjcuMjY1NiAxMTguNjU4IDcyLjIwMDRaIiBmaWxsPSIjMTVDMzlBIiBzdHJva2U9IiMxQzI1M0MiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjxwYXRoIG9wYWNpdHk9IjAuNSIgZD0iTTEwMS41NjggNzEuMDEyM0MxMDMuODUzIDY5LjgyNDMgMTAwLjE5OCA2MS40MTY4IDk2Ljk5OSA2My4wNjE3QzkzLjE2MDggNjUuMDcyMiA5OC4wOTU2IDcyLjg0IDEwMS41NjggNzEuMDEyM1oiIGZpbGw9IndoaXRlIi8+CjxwYXRoIG9wYWNpdHk9IjAuMjUiIGQ9Ik0xMjAuMjExIDU2LjY2NDdDMTIxLjU4MiA2MS4wNTEzIDEyMC43NTkgNjcuMzU2OSAxMTguNjU3IDcyLjIwMDNDMTEwLjYxNSA2My45NzU2IDEwMS4xMTEgNTIuMjc4MiAxMDEuMTExIDQ3Ljg5MTdDMTAxLjExMSA0Ny43MDg5IDEwMS4xMTEgNDcuNTI2MiAxMDEuMjAzIDQ3LjM0MzRDMTAxLjU2OCA0Ny4xNjA2IDEwMS45MzQgNDcuMDY5MiAxMDIuMjk5IDQ2Ljk3NzhDMTA5Ljg4NCA0NC42OTMyIDExNy45MjYgNDguOTg4MyAxMjAuMjExIDU2LjY2NDdaIiBmaWxsPSIjMUYyNDNDIiBzdHJva2U9IiMxRjI0M0MiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIvPgo8cGF0aCBkPSJNMTUxLjAwOCA3Mi42NTczQzE0NS43MDggODQuNTM3NSAxMjkuNDQxIDk3Ljk3MTIgMTI5LjQ0MSA5Ny45NzEyTDEzNC41NTkgMTA3LjExIiBzdHJva2U9IiMxRjI0M0MiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIvPgo8cGF0aCBkPSJNMTUwLjkxNyA3My45MzY3QzE1MC4wMDMgNzMuNjYyNSAxNDkuNTQ2IDczLjExNDIgMTQ5LjM2MyA3Mi42NTczQzE0OS4wODkgNzIuMTA4OSAxNDkuMTggNzEuNDY5MiAxNDkuNTQ2IDcxLjAxMjNMMTUzLjAxOSA2Ni45OTEzTDE1My42NTggNzIuMjkxN0MxNTMuNzUgNzIuODQgMTUzLjQ3NiA3My40Nzk3IDE1Mi45MjcgNzMuNzUzOUMxNTIuNDcgNzQuMDI4IDE1MS44MzEgNzQuMTE5NCAxNTAuOTE3IDczLjkzNjdaIiBmaWxsPSIjODc4MEU0IiBzdHJva2U9IiMxQzI1M0MiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIi8+CjxwYXRoIGQ9Ik0xNzEuMzg3IDU2LjAyNTFDMTY5LjEwMyA2My42MTAxIDE1OC41MDIgNzIuNDc0NiAxNTEuOTIyIDcwLjQ2NDFDMTQ1LjQzNCA2OC40NTM2IDE0MS40MTMgNTUuMjk0IDE0My42OTcgNDcuNzA5QzE0NS45ODIgNDAuMTI0IDE1NC4wMjQgMzUuNzM3NCAxNjEuNyAzOC4xMTM1QzE2OS4zNzcgNDAuMzA2NyAxNzMuNjcyIDQ4LjM0ODcgMTcxLjM4NyA1Ni4wMjUxWiIgZmlsbD0iIzg3ODBFNCIgc3Ryb2tlPSIjMUMyNTNDIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIgc3Ryb2tlLWxpbmVqb2luPSJyb3VuZCIvPgo8cGF0aCBvcGFjaXR5PSIwLjQiIGQ9Ik0xNjcuOTE1IDUyLjkxOEMxNjMuODk0IDU0LjE5NzQgMTYxLjA2MSA0NC42MDE5IDE2NS4zNTYgNDQuMjM2M0MxNjkuMjg1IDQzLjg3MDggMTcwLjU2NSA1Mi4wOTU1IDE2Ny45MTUgNTIuOTE4WiIgZmlsbD0id2hpdGUiLz4KPHBhdGggb3BhY2l0eT0iMC4yNSIgZD0iTTE2Mi43OTcgMzguOTM1OUMxNjIuNzk3IDQzLjMyMjUgMTUzLjM4NCA1NC45Mjg1IDE0NS4zNDIgNjMuMTUzMkMxNDMuMjQgNTguMzA5NyAxNDIuNTA5IDUyLjA5NTUgMTQzLjc4OSA0Ny43MDlDMTQ2LjA3MyA0MC4xMjQgMTU0LjExNSAzNS43Mzc0IDE2MS43OTIgMzguMTEzNUMxNjIuMDY2IDM4LjIwNDkgMTYyLjQzMSAzOC4yOTYyIDE2Mi43MDUgMzguMzg3NkMxNjIuNzA1IDM4LjU3MDQgMTYyLjc5NyAzOC43NTMyIDE2Mi43OTcgMzguOTM1OVoiIGZpbGw9IiMxRjI0M0MiIHN0cm9rZT0iIzFGMjQzQyIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIi8+CjxwYXRoIGQ9Ik0xMjkuNDQxIDY2LjgwODdWMTEyLjEzNiIgc3Ryb2tlPSIjMUYyNDNDIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiLz4KPHBhdGggZD0iTTEyOS40NDEgNzQuNTc2NUMxMjguNDM2IDc0LjU3NjUgMTI3Ljc5NiA3NC4yMTEgMTI3LjQzMSA3My43NTQxQzEyNi45NzQgNzMuMjk3MSAxMjYuODgyIDcyLjU2NjEgMTI3LjE1NiA3Mi4wMTc3TDEyOS41MzIgNjYuNjI2TDEzMS45MDggNzIuMDE3N0MxMzIuMTgzIDcyLjU2NjEgMTMyLjA5MSA3My4yOTcxIDEzMS42MzQgNzMuNzU0MUMxMzEuMDg2IDc0LjIxMSAxMzAuNDQ2IDc0LjU3NjUgMTI5LjQ0MSA3NC41NzY1WiIgZmlsbD0iI0ZGQzk0MCIgc3Ryb2tlPSIjMUYyNDNDIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiLz4KPHBhdGggZD0iTTE0My41MTQgMjQuNDA1N0MxNDEuNDEzIDIzLjU4MzIgMTE3LjU2MSAyMy41ODMyIDExNS40NTkgMjQuNDA1N0MxMTMuMzU3IDI1LjIyODEgMTAyLjU3NCAzNS4zNzIgMTAyLjU3NCAzOS4zMDE2QzEwMi41NzQgNDUuOTcyNyAxMjUuNzg2IDcwLjY0NjkgMTI5LjUzMiA3MC42NDY5QzEzMy4yNzkgNzAuNjQ2OSAxNTYuNDkxIDQ1Ljk3MjcgMTU2LjQ5MSAzOS4zMDE2QzE1Ni40IDM1LjQ2MzQgMTQ1LjYxNiAyNS4yMjgxIDE0My41MTQgMjQuNDA1N1oiIGZpbGw9IiNGRkM5NDAiIHN0cm9rZT0iIzFGMjQzQyIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIi8+CjxwYXRoIG9wYWNpdHk9IjAuOCIgZD0iTTE0MS41MDQgMjYuMzI0OEMxMzkuMjE5IDI2LjIzMzQgMTM5LjIxOSAyOC44ODM2IDE0MC41OSAzMS4wNzY5QzE0Mi45NjYgMzUuMDA2NSAxNDYuMjU2IDM2LjY1MTQgMTQ3LjYyNyAzNi4xMDMxQzE1MS42NDggMzQuNjQwOSAxNDYuMzQ3IDI2LjQxNjIgMTQxLjUwNCAyNi4zMjQ4WiIgZmlsbD0id2hpdGUiIGZpbGwtb3BhY2l0eT0iMC44Ii8+CjxwYXRoIGQ9Ik0xNTYuNCAzOS4yMTAyTDE0MC44NjQgNDEuNjc3NkgxMTguMDE4TDEwMi40ODIgMzkuMjEwMiIgc3Ryb2tlPSIjMUYyNDNDIiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiLz4KPHBhdGggZD0iTTEzNS4wMTUgMjQuMDQwMkMxMzcuNTc0IDI4Ljc5MjIgMTQwLjg2NCAzOS45NDEzIDE0MC44NjQgNDEuNjc3NkMxNDAuODY0IDQzLjQxNCAxMzUuODM4IDU5LjA0MDkgMTI5LjQ0MSA3MC42NDY5IiBzdHJva2U9IiMxRjI0M0MiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIvPgo8cGF0aCBkPSJNMTIzLjg2NiAyNC4wNDAyQzEyMS4zMDggMjguNzkyMiAxMTguMDE4IDM5Ljk0MTMgMTE4LjAxOCA0MS42Nzc2QzExOC4wMTggNDMuNDE0IDEyMy4wNDQgNTkuMDQwOSAxMjkuNDQxIDcwLjY0NjkiIHN0cm9rZT0iIzFGMjQzQyIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIi8+CjxwYXRoIG9wYWNpdHk9IjAuOCIgZD0iTTExNy41NjEgNTUuNzUxMUMxMTYuMTkgNTYuMDI1MyAxMTAuNjE1IDUwLjM1OTQgMTA4LjMzMSA0Ni4zMzg0QzEwNy4yMzQgNDQuNDE5MyAxMDguMjM5IDQzLjMyMjcgMTA5LjMzNiA0My4wNDg1QzExMi41MzQgNDIuMjI2IDExMy45MDUgNDQuMzI3OSAxMTYuMDA3IDQ3Ljg5MkMxMTcuOTI2IDUxLjA5MDUgMTE5LjIwNiA1NS4zODU2IDExNy41NjEgNTUuNzUxMVoiIGZpbGw9IndoaXRlIiBmaWxsLW9wYWNpdHk9IjAuOCIvPgo8cGF0aCBkPSJNMTQxLjg2OSA5OS44OTA0QzE0My44OCA5MC4zODYzIDEyOS40NDEgOTcuNzg4NSAxMjkuNDQxIDk3Ljc4ODVDMTI5LjQ0MSA5Ny43ODg1IDE0MC4wNDIgMTA5LjAyOSAxNDEuODY5IDk5Ljg5MDRaIiBzdHJva2U9IiMxRjI0M0MiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIvPgo8cGF0aCBkPSJNMTE3LjAxMyA5OS44OTA0QzExNS4wMDIgOTAuMzg2MyAxMjkuNDQxIDk3Ljc4ODUgMTI5LjQ0MSA5Ny43ODg1QzEyOS40NDEgOTcuNzg4NSAxMTguODQgMTA5LjAyOSAxMTcuMDEzIDk5Ljg5MDRaIiBzdHJva2U9IiMxRjI0M0MiIHN0cm9rZS1taXRlcmxpbWl0PSIxMCIvPgo8L3N2Zz4K"},i.createElement("source",{src:`${p.yr}premiumOnboardingStart.mp4`})))),f=o.UI.Node.make((()=>i.createElement("svg",{width:"130",height:"82",viewBox:"0 0 130 82",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i.createElement("path",{opacity:"0.25",d:"M82.084 40.757L72.7367 30.3437C72.1869 29.6495 71.4996 29.3718 70.6748 29.3718H46.8943C46.0695 29.3718 45.3822 29.6495 44.8324 30.3437L35.4851 40.757C34.5229 41.8677 34.5229 43.5338 35.4851 44.6446L57.3412 68.9421C57.7536 69.3586 58.3034 69.6363 58.8533 69.6363C59.4031 69.6363 59.953 69.3586 60.3653 68.9421L82.084 44.6446C83.1837 43.5338 83.1837 41.8677 82.084 40.757Z",fill:"#494393"}),i.createElement("path",{d:"M66.1044 65.0148L87.9605 40.7173C88.6478 39.8843 88.6478 38.6347 87.9605 37.8016L78.4758 27.3884C78.0634 26.9719 77.5136 26.6942 76.8263 26.6942H53.1832C52.6333 26.6942 51.946 26.9719 51.5336 27.3884L42.1864 37.8016C41.4991 38.6347 41.4991 39.8843 42.1864 40.7173L64.0425 65.0148C64.5923 65.7091 65.5546 65.7091 66.1044 65.0148Z",fill:"#FFDF80",stroke:"#0E101A",strokeMiterlimit:"10"}),i.createElement("path",{d:"M88.5103 39.3289H41.6365",stroke:"#0E101A",strokeMiterlimit:"10"}),i.createElement("path",{d:"M60.4684 26.6942L55.7947 38.4958C55.6573 39.0512 55.6573 39.6066 55.7947 40.0231L65.142 65.5702",stroke:"#0E101A",strokeMiterlimit:"10"}),i.createElement("path",{d:"M69.6783 26.6942L74.3519 38.4958C74.4894 39.0512 74.4894 39.6066 74.3519 40.0231L65.0046 65.5702",stroke:"#0E101A",strokeMiterlimit:"10"}),i.createElement("rect",{x:"77.5491",y:"1",width:"8",height:"8",rx:"2",transform:"rotate(14.9627 77.5491 1)",fill:"#F8C6DA",stroke:"#0E101A"}),i.createElement("rect",{x:"13",y:"53.5762",width:"8",height:"8",rx:"2",transform:"rotate(-36.5938 13 53.5762)",fill:"#B8B4EF",stroke:"#0E101A"}),i.createElement("circle",{cx:"96",cy:"73",r:"4",fill:"#87E8D1",stroke:"#0E101A"}),i.createElement("path",{d:"M37 66V72",stroke:"#0E101A"}),i.createElement("path",{d:"M37 76V82",stroke:"#0E101A"}),i.createElement("path",{d:"M45 74L39 74",stroke:"#0E101A"}),i.createElement("path",{d:"M35 74L29 74",stroke:"#0E101A"}),i.createElement("path",{d:"M37.5 10V14.125",stroke:"#0E101A"}),i.createElement("path",{d:"M37.5 16.875V21",stroke:"#0E101A"}),i.createElement("path",{d:"M43 15.5L38.875 15.5",stroke:"#0E101A"}),i.createElement("path",{d:"M36.125 15.5L32 15.5",stroke:"#0E101A"}),i.createElement("path",{d:"M103 21V27",stroke:"#0E101A"}),i.createElement("path",{d:"M103 31V37",stroke:"#0E101A"}),i.createElement("path",{d:"M111 29L105 29",stroke:"#0E101A"}),i.createElement("path",{d:"M101 29L95 29",stroke:"#0E101A"})))),y=c.u.stylesheet({premiumOnboardingStartVideo:[{width:264,height:120}]}),v=o.UI.Node.make((({view:e})=>i.createElement("div",{"data-name":"success-lens-text",className:U.newSuccessText},i.createElement(u.H4,{key:"title"},e("title")),i.createElement("div",{className:U.newSuccessDescription},i.createElement(s.F.div,{className:U.newSuccessDescriptionText},(0,n.pipe)(e("firstLine"),d.U(a.QP))))))),b=o.UI.Union.asOption(v),w=o.UI.Grid.make((({slots:e})=>i.createElement(s.F.div,{className:U.newSuccessContainer},e.image,e.caption))),S=o.UI.Knot.make(w,{image:h,caption:b}),I=o.UI.Knot.make(w,{image:m,caption:b}),A=o.UI.Knot.make(o.UI.Grid.make((({slots:e})=>i.createElement(s.F.div,{className:U.premiumOnboardingStartSuccessContainer},e.animation,e.caption))),{animation:g,caption:b}),_=o.UI.Knot.make(w,{image:f,caption:b}),C=o.UI.Union.make("kind",{growStart:S,growComplete:I,premiumOnboardingStart:A,premiumOnboardingComplete:_}),E=c.u.keyframes({"0%":{opacity:0},"100%":{opacity:1}}),T=c.u.keyframes({"0%":{opacity:1},"100%":{opacity:0}}),x={animation:`${E} 300ms linear forwards`},k={position:"absolute",top:0,width:c.u.percent(100),animation:`${T} 200ms linear forwards`},M={textAlign:"center",background:l.Il.CoreNeutral0,padding:c.u.rem(.5)},L={width:c.u.percent(100),marginTop:c.u.rem(.5)},R={marginTop:c.u.rem(.25)},N={fontSize:c.u.rem(l.xv.NewSuccessDescriptionSize),color:l.Il.CoreNeutral50,letterSpacing:l.xv.NewSuccessDescriptionLetterSpacing,lineHeight:c.u.rem(l.xv.NewSuccessDescriptionLineHeight),fontWeight:l.xv.NewSuccessDescriptionWeight},U=c.u.stylesheet({success_fadein:[x],success_fadeout:[k],premiumOnboardingStartSuccessContainer:[M],newSuccessContainer:[{textAlign:"center"}],newSuccessText:[L],newSuccessDescription:[R],newSuccessDescriptionText:[N]}),D=o.UI.Transition.make({fadein:U.success_fadein},{fadeout:U.success_fadeout}),O=o.UI.Animated.make(D,C)},38819:(e,t,r)=>{r.d(t,{r:()=>f});var i=r(27378),n=r(40327),s=r(5114),a=r(8725),o=r(63969),l=r(40489),c=r(30763),u=r(21474),d=r(3656);const p=a.UI.Grid.make((({slots:e})=>i.createElement("div",{className:w.grid},i.createElement("div",{className:w.iconWrapper},e.icon),i.createElement("div",{className:w.titleWrapper},e.title),i.createElement("div",{className:w.bottomWrapper},e.bottom)))),h=a.UI.Node.make((()=>{const e=i.useContext(c.m.Context).successLens.paidView;return i.createElement(d.H4,null,e.title)})),m=a.UI.Node.make((()=>i.createElement(u.JO.GreenOk,{width:32}))),g=a.UI.Knot.make(p,{icon:m,title:h,bottom:a.UI.Union.make("kind",{[l.n.State.hidden]:a.UI.Node.empty,[l.n.State.expanded]:l.n.TogglableExpandedPanel})}),f=(0,n.pipe)(a.UI.squash(g),a.UI.contramapState((e=>(0,n.pipe)(e,s.fold((()=>({bottom:{kind:l.n.State.hidden}})),(e=>({bottom:{kind:l.n.State.expanded,showCloseButton:!1,alertsState:e}}))))))),y={marginTop:o.u.rem(3.5)},v={marginTop:o.u.rem(1.375)},b={marginTop:o.u.rem(2.675)},w=o.u.stylesheet({grid:[{display:"flex",flexDirection:"column",alignItems:"center"}],iconWrapper:[y],titleWrapper:[v],bottomWrapper:[b]})},79289:(e,t,r)=>{r.d(t,{V:()=>n});var i,n,s=r(27378),a=r(64015),o=r(57050),l=r(5739),c=r(28043),u=r(32952),d=r(2834),p=r(77176),h=r(22232),m=r(83078),g=r(5114),f=r(8725),y=r(10918),v=r(7826),b=r(54483),w=r(31820),S=r(85255),I=r(15646),A=r(45891),_=r(83591),C=r(60682);!function(e){function t(e,t){return{mini:f.Z.fromSideEffect((e=>{"onClick"===e.action&&t.next({type:I.lY.Type.miniItemClick,id:C.B.id})}),e),full:f.Z.fromSideEffect((e=>{"upgrade"===e.kind&&t.next({type:"upgradeHookAction",kind:_.E1.ActionsKind.onUpgrade}),"onUpgradeButtonMount"===e.kind&&t.next({type:"upgradeHookAction",kind:_.E1.ActionsKind.onUpgradeButtonMount,element:e.element})}),e),hidden:()=>e}}function r(e){switch(e){case"added":case"rendered":return"mini";case"focused":case"expanded":return"full";case"hidden":case"removed":return"hidden";case"presuccess":case"success":case"feedback_form":case"muted":throw new Error(`${e} is not supported for UpgradeHookCard`);default:(0,h.vE)(e)}}e.flow=function(e,i){return(0,o.zG)(f.Z.composeUnion(t(e,i),(()=>e.pipe(p.U((e=>({cardKind:r(e.visualState.transition.type)})))))))},e.shadeFlow=function(e,i){return f.Z.composeUnion(t(e,i),(()=>e.pipe(p.U((e=>({cardKind:(0,o.zG)(e.visualState.from,g.fold((()=>"hidden"),r))}))))))}}(i||(i={})),function(e){function t(){return(0,o.zG)(A.v,f.UI.contramapState((e=>({alertsCount:e.alerts.length}))))}function r(){return(0,o.zG)(_.Gx,f.UI.contramapState((e=>({showCloseButton:!1,alertsState:{count:e.alerts.length,alerts:e.groupedAlerts}}))))}e.ListCard=f.UI.Node.make((({view:e,notify:n})=>{const s=(0,o.zG)(e("view"),c.x(((e,t)=>e.visualState.transitionId===t.visualState.transitionId&&e.visualState.transition.type===t.visualState.transition.type))),a=new u.xQ;return S.P.useSubscriptionTo(a.pipe(d.b((e=>n(e)())))),f.UI.mount(b.G.make(f.UI.Union.make("cardKind",{mini:t(),full:r(),hidden:f.UI.Node.empty})),(0,o.zG)(w.g.flow(s,i.flow(s,a),i.shadeFlow(s,a)),w.g.extend((e=>a.next(e)))))})),e.SingleCard=f.UI.Node.make((({view:e,notify:t})=>{const r=e("view");return s.createElement(l.F.Fragment,null,r.pipe(c.x(((e,t)=>e.equals(t))),p.U((e=>((0,h.kG)(g.isSome(e.cardDSL),"upgrade hook must have SDUI content defined"),s.createElement(y.P,{content:m.MH(e.cardDSL),designSystem:v.k,notify:r=>t({type:I.lY.Type.sduiCardAction,cardId:e.id,actions:r})(),transitions:a.qo(e.transitions),prevContent:e.prevCardDSL,onAnimationEnd:t({type:I.eI.Kind.completeTransitionTo,id:e.id,transitionId:e.visualState.transitionId}),onMount:t({type:"onUpgradeHookCardMount"})}))))))}))}(n||(n={}))},282:(e,t,r)=>{r.d(t,{a:()=>w});var i=r(44060),n=r(63969),s=r(40219);const a={position:"relative",borderRadius:n.u.rem(s.fx),boxShadow:"0 1px 7px 0 rgba(129, 137, 169, .2)",userSelect:"none",backgroundColor:i.Il.CoreNeutral0},o={padding:`${n.u.rem(1)} ${n.u.rem(2)}`},l={position:"absolute",top:n.u.rem(.75),left:n.u.rem(.5)},c={display:"flex",boxSizing:"border-box",padding:n.u.rem(.5),height:n.u.rem(2.5),cursor:"pointer",justifyContent:"flex-start",alignItems:"center"},u={marginLeft:n.u.rem(.8),fontSize:n.u.rem(.85),lineHeight:n.u.rem(1)},d={display:"flex",width:n.u.percent(100),alignItems:"center",justifyContent:"space-between"},p={position:"absolute",top:n.u.rem(.2),right:n.u.rem(.3),cursor:"pointer"},h={paddingRight:n.u.rem(1),textAlign:"left",fontSize:n.u.rem(.75),lineHeight:n.u.rem(1.15)},m={marginTop:n.u.rem(.6),fontSize:n.u.rem(.875),flexShrink:0},g={display:"flex",marginBottom:n.u.rem(.6),justifyContent:"flex-end",flexShrink:0},f={marginRight:"auto",lineHeight:n.u.rem(1.3125)},y={marginTop:n.u.rem(.21),minWidth:n.u.rem(1.5),flexShrink:0},v={marginTop:n.u.rem(1)},b={display:"flex",justifyContent:"center",alignItems:"center",height:n.u.rem(2),backgroundColor:i.Il.CoreGreen60,borderRadius:n.u.rem(.25),fontSize:n.u.rem(.875),fontWeight:700,color:i.Il.CoreNeutral0,lineHeight:n.u.rem(2),$nest:{"&:not([data-disabled='true'])[data-hovered='true']":{background:n.u.color(i.Il.CoreGreen60).tint(.1).toRGBA().toString()},"&:not([data-disabled='true']):active":{background:n.u.color(i.Il.CoreGreen60).tint(.2).toRGBA().toString()}}},w=n.u.stylesheet({wrapper:[a],maximizedWrapper:[o],minimizedWrapper:[c],maximizedWrapperIcon:[l],shadowWrapper:[{position:"relative",zIndex:1}],minimizedText:[u],minimizedContent:[d],maximizedCloseButtonContainer:[p],maximizedHeader:[h],alertCategoryContainer:[m],alertCategory:[g],categoryHumanContainer:[f],alertCounterContainer:[y],premiumButtonContainer:[v],premiumButton:[b]})},83591:(e,t,r)=>{r.d(t,{E1:()=>v,Gx:()=>S});var i=r(27378),n=r(40327),s=r(5739),a=r(5114),o=r(22232),l=r(8725),c=r(30763),u=r(7046),d=r(87380),p=r(21474),h=r(3656),m=r(77176),g=r(282),f=r(87772);const y=l.UI.Node.make((({notify:e})=>i.createElement(s.F.div,{className:g.a.maximizedCloseButtonContainer},i.createElement(h.zx,{name:"close",onClick:e("onClick")},i.createElement(p.JO.Arrow,{width:11,direction:p.n4.up})))));var v;!function(e){let t,r;!function(e){e.onUpgrade="onUpgrade",e.onUpgradeButtonMount="onUpgradeButtonMount"}(t=e.ActionsKind||(e.ActionsKind={})),function(e){e.isOnUpgrade=function(e){return"onUpgrade"===e.kind},e.isOnUpgradeButtonMount=function(e){return"onUpgradeButtonMount"===e.kind}}(r=e.Actions||(e.Actions={}))}(v||(v={}));const b=l.UI.Node.make((({state:e,notify:t})=>{const r=i.useContext(c.m.Context);return i.createElement(i.Fragment,null,i.createElement("div",{className:g.a.maximizedHeader},i.createElement(s.F.Fragment,null,e.pipe(m.U((({count:e})=>e>0?e>1?i.createElement(i.Fragment,{key:"plural"},r.sidebar.content.premiumIssues.foundTitlePlural.description1," ",e," ",r.sidebar.content.premiumIssues.foundTitlePlural.description2):i.createElement(i.Fragment,{key:"singular"},r.sidebar.content.premiumIssues.foundTitleSingular.description1," ",e," ",r.sidebar.content.premiumIssues.foundTitleSingular.description2):null))))),i.createElement(s.F.div,{className:g.a.alertCategoryContainer},e.pipe(m.U((({alerts:e})=>e.map((e=>i.createElement("div",{key:e.category,className:g.a.alertCategory},i.createElement("div",{className:g.a.categoryHumanContainer},e.categoryHuman),i.createElement("div",{className:g.a.alertCounterContainer},i.createElement(d.x.Counter,{count:e.count,type:"yellowPremium"}))))))))),i.createElement("div",{className:g.a.premiumButtonContainer},i.createElement("div",{ref:e=>{t({type:"upgradeHookAction",kind:v.ActionsKind.onUpgradeButtonMount,element:a.fromNullable(e)})()}},i.createElement(u.zx,{name:"upgrade",className:g.a.premiumButton,onClick:t({type:"upgradeHookAction",kind:v.ActionsKind.onUpgrade})},i.createElement(p.JO.UpgradeHookPanel.ButtonDiamond,null),r.goPremium))))})),w=l.UI.Composite.make((0,f.W)(g.a.maximizedWrapper,g.a.maximizedWrapperIcon),l.UI.Group.make({closeButton:l.UI.Union.make("kind",{hidden:l.UI.Node.empty,visible:y}),content:b})),S=(0,n.pipe)(l.UI.squash(w),l.UI.mapAction((e=>{switch(e.key){case"content":switch(e.action.kind){case v.ActionsKind.onUpgrade:return{kind:"upgrade"};case v.ActionsKind.onUpgradeButtonMount:return{kind:"onUpgradeButtonMount",element:e.action.element};default:return(0,o.vE)(e.action)}case"closeButton":switch(e.action.action){case"onClick":return{kind:"collapse"};default:return(0,o.vE)(e.action.action)}default:return(0,o.vE)(e)}})),l.UI.contramapState((e=>({closeButton:{kind:e.showCloseButton?"visible":"hidden"},content:e.alertsState}))))},70023:(e,t,r)=>{r.d(t,{d:()=>d});var i=r(57050),n=r(5114),s=r(22232),a=r(77176),o=r(60797),l=r(93508),c=r(66310),u=r(40489);function d(e){return(0,i.ls)(a.U((e=>{switch(e.key){case u.n.State.expanded:switch(e.action.kind){case"collapse":return n.some(u.n.State.minimized);case"upgrade":case"onUpgradeButtonMount":return n.none;default:return(0,s.vE)(e.action)}case u.n.State.minimized:switch(e.action.action){case"onClick":return n.some(u.n.State.expanded);default:return(0,s.vE)(e.action.action)}default:return(0,s.vE)(e)}})),o.oA,l.O(u.n.State.minimized),c.w((t=>e.pipe(a.U(n.fold((()=>({kind:u.n.State.hidden})),(e=>{switch(t){case u.n.State.minimized:return{kind:u.n.State.minimized,alertsCount:e.count};case u.n.State.expanded:return{kind:u.n.State.expanded,showCloseButton:!0,alertsState:{count:e.count,alerts:e.alerts()}};case u.n.State.hidden:return{kind:u.n.State.hidden};default:return(0,s.vE)(t)}})))))))}},45891:(e,t,r)=>{r.d(t,{v:()=>g});var i=r(27378),n=r(40327),s=r(5739),a=r(8725),o=r(30763),l=r(87380),c=r(77176),u=r(282),d=r(87772);const p=a.UI.Node.make((({state:e})=>{const t=i.useContext(o.m.Context);return i.createElement(s.F.div,{className:u.a.minimizedContent},i.createElement("div",{className:u.a.minimizedText},t.premiumSuggestions),e.pipe(c.U((({alertsCount:e})=>e>0&&i.createElement(l.x.Counter,{type:"yellowPremium",key:"advancedCounter-counter",count:e})))))})),h=a.UI.Grid.make((({slots:e,notify:t})=>i.createElement("div",{className:u.a.shadowWrapper,onClick:t("onClick")},e.body))),m=a.UI.Knot.make(h,{body:a.UI.Composite.make((0,d.W)(u.a.minimizedWrapper),p)}),g=(0,n.pipe)(a.UI.squash(m),a.UI.contramapState((e=>({body:e}))))},40489:(e,t,r)=>{r.d(t,{n:()=>i});var i,n=r(8725),s=r(83591),a=r(45891);!function(e){let t;!function(e){e.hidden="hidden",e.minimized="minimized",e.expanded="expanded"}(t=e.State||(e.State={})),e.TogglableExpandedPanel=n.UI.Union.make("kind",{[t.hidden]:n.UI.Node.empty,[t.expanded]:s.Gx}),e.TogglablePanel=n.UI.Union.make("kind",{[t.hidden]:n.UI.Node.empty,[t.minimized]:a.v,[t.expanded]:s.Gx})}(i||(i={}))},87772:(e,t,r)=>{r.d(t,{W:()=>c});var i=r(27378),n=r(5739),s=r(12187),a=r(8725),o=r(21474),l=r(282);const c=(e,t)=>a.UI.Grid.make((({slots:r})=>i.createElement(n.F.div,Object.assign({},(0,s.Sh)(l.a.wrapper,e)),i.createElement(o.JO.UpgradeHookPanel.TitleDiamond,{className:t}),r.body)))},43743:(e,t,r)=>{r.d(t,{f:()=>i});var i,n=r(49708),s=r(77176),a=r(93508),o=r(85985),l=r(17343),c=r(36303),u=r(24209),d=r(83840),p=r(8473),h=r(15789),m=r(2768),g=r(50628),f=r(44586),y=r(28043),v=r(32952),b=r(66310),w=r(76974);!function(e){class t{static get observable(){return this._obs||(this._obs=n.R(document,"visibilitychange").pipe(s.U((()=>document.hidden)),a.O(document.hidden),o.h(Boolean),l.h(void 0),c.r(1)))}}function r(...e){return u.T(...e.map((e=>e.pipe(d.i())))).pipe(p.o((e=>e.hasValue)),h.D())}e.Hidden=t,e.mergeUntilAnyCompletes=r,e.createAnimationObservable=function(e,i,n){return r(function(e,t,r){return f.y.create((i=>{let n,s=self.requestAnimationFrame(a);function a(o){n||(n=o);const l=o-n;l<r?(i.next(Math.round(e+l/r*(t-e))),s=self.requestAnimationFrame(a)):(i.next(t),i.complete())}return()=>self.cancelAnimationFrame(s)})).pipe(y.x())}(e,i,n).pipe(m.R(t.observable)),t.observable.pipe(l.h(i),g.P()))},e.fadeOutState=function(e){const t=new v.xQ;return{state:e.pipe(b.w((e=>e?w.of("inProgress"):u.T(w.of("fadeOut"),t.pipe(l.h("end")))))),complete:()=>t.next(!0)}},e.rafSequence=function(e,t=!1){return f.y.create((r=>{let i;function n(){r.next(e.shift()),e.length&&(i=requestAnimationFrame(n))}return t?n():i=requestAnimationFrame(n),()=>cancelAnimationFrame(i)}))}}(i||(i={}))},21619:(e,t,r)=>{r.d(t,{mN:()=>_});var i,n,s=r(71249),a=r(57050),o=r(40327),l=r(38983),c=r(5114),u=r(45701),d=r(89943),p=r(8125),h=r(55415),m=r(83078),g=r(66896),f=r(77176),y=r(32952),v=r(67434),b=r(28043),w=r(41398),S=r(19751),I=r(17594),A=r(35416);!function(e){const t=e=>t=>(0,o.pipe)(t,c.map((0,a.ls)(s.DZ((t=>e.getAlertByMark(t))),s.DY(u.contramap((({alert:{lensType:e,lensPriority:t}})=>({type:e,priority:t})))(g.R.ord)))));e.fromMarksEvents=(e,r)=>({activeHighlights:(0,o.pipe)(r.activeMarks,f.U(t(e))),hoveredHighlights:(0,o.pipe)(r.hoveredMarks,f.U(t(e)))})}(i||(i={})),function(e){e.Mock=class{constructor(){this.alertHovered=new y.xQ,this.alertClicked=new y.xQ,this.highlightedAlert=l.h.create(c.none)}}}(n||(n={}));class _{constructor(e,t,r,n,s,a){this._ded=e,this._state=t,this._markAlertMapper=r,this._alertsReader=n,this._getActiveItemWithAlert=s,this._resolveClickedAlert=a,this._impl=new C(i.fromMarksEvents(this._markAlertMapper,this._ded),this._state,this._alertsReader,this._getActiveItemWithAlert,this._resolveClickedAlert),this.alertHovered=this._impl.alertHovered,this.alertClicked=this._impl.alertClicked}}class C{constructor(e,t,r,i,n){this._highlightEvents=e,this._state=t,this._alertsReader=r,this._getActiveItemWithAlert=i,this._resolveClickedAlert=n,this._focusedItem=this._state.view(A.nL.getActiveItem(this._getActiveItemWithAlert)),this._focusedLens=this._state.view("currentLens"),this.alertHovered=this._highlightEvents.hoveredHighlights.pipe(f.U(c.map(s.UI((({alert:e})=>e)))),v.R(((e,t)=>(0,o.pipe)(t,c.chain((t=>(0,o.pipe)(e,c.filter((e=>-1!==t.indexOf(e))),c.fold((()=>c.fromNullable(t[0])),c.some)))))),c.none),f.U(c.filter((e=>this._alertsReader.isInteractable(e.id)&&!I.$.isPlagiarism(e)))),b.x()),this.alertClicked=this._highlightEvents.activeHighlights.pipe(w.M(this._focusedItem,this._focusedLens),v.R(((e,[t,r,i])=>{const n=t=>(0,o.pipe)(e,c.exists((e=>e.alert.id===t.alert.id))),s=e=>(0,o.pipe)(r,c.exists((t=>t.activeAlert.id===e.alert.id))),a=e=>i.meta.filter(e.alert);return(0,o.pipe)(t,c.chain((e=>{var t;return(0,o.pipe)(e,null!==(t=this._resolveClickedAlert)&&void 0!==t?t:d.N6([(0,p.W9)(n,s),s,(0,p.W9)(n,a),a,n]),c.fold((()=>c.fromNullable(e[0])),c.some),c.map((e=>h.Vx(e,{highlightIndex:e.alert.hasNestedHighlights?0:e.highlightIndex}))))})))}),m.cS()),S.d({refCount:!0,bufferSize:1}))}}},54216:(e,t,r)=>{r.d(t,{t:()=>m});var i=r(57050),n=r(40327),s=r(77176),a=r(28043),o=r(8125),l=r(83078),c=r(40018),u=r(66896),d=r(25975);const p=(0,o.W9)(c.bZ.isRegistered,(0,i.ff)(c.bZ.isMuted)),h=e=>t=>(0,o.W9)(p,e(t));var m;!function(e){e.create=function(e,t){const r=h((t=>e[t]));return{lensFilters:new Map(Object.entries(e)),alertVisibleInText:(e,r)=>(0,o.W9)(h((e=>t[e]))(e),(e=>t=>e||c.bZ.isPriority(t))(r)),alertVisibleInSidebar:r,getLensesFilter:t=>e[t],alertCanBeDisplayed:p,alertIsBulkAcceptable:e=>(0,o.W9)(r(e),c.bZ.isBulkAcceptable)}};const t=e=>t=>e===t.lensId,r=e=>(0,o.W9)(t(u.R.OutcomeId.fromPriorityOutcomeId(e)),c.bZ.isPriority);e.getAlertVisibleInTextFilter=function(e,t){return t.pipe(s.U((e=>({id:e.currentLens.id,nonPriorityAlertsVisible:d.v.WithPriority.nonPriorityAlertsVisible(e)}))),a.x(((e,t)=>e.id===t.id&&e.nonPriorityAlertsVisible===t.nonPriorityAlertsVisible)),s.U((({id:t,nonPriorityAlertsVisible:r})=>e.alertVisibleInText(t,r))))},e.defaultLensFilters={[u.R.SpecialId.Clarity]:t(u.R.SpecialId.Clarity),[u.R.SpecialId.Correctness]:t(u.R.SpecialId.Correctness),[u.R.SpecialId.Delivery]:t(u.R.SpecialId.Delivery),[u.R.SpecialId.Engagement]:t(u.R.SpecialId.Engagement),[u.R.SpecialId.Vox]:t(u.R.SpecialId.Vox),[u.R.SpecialId.FreePremiumAlerts]:e=>(0,n.pipe)(e.extraProperties.freePremium,l.FX("unlocked")),[u.R.SpecialId.ClarityPriority]:r(u.R.SpecialId.ClarityPriority),[u.R.SpecialId.CorrectnessPriority]:r(u.R.SpecialId.CorrectnessPriority),[u.R.SpecialId.DeliveryPriority]:r(u.R.SpecialId.DeliveryPriority),[u.R.SpecialId.EngagementPriority]:r(u.R.SpecialId.EngagementPriority),[u.R.SpecialId.VoxPriority]:r(u.R.SpecialId.VoxPriority),[u.R.SpecialId.Plagiarism]:t(u.R.SpecialId.Plagiarism),[u.R.SpecialId.DraftAI]:i.jv,[u.R.SpecialId.Premium]:t(u.R.SpecialId.Premium),[u.R.SpecialId.AllAlerts]:c.bZ.belongsToAllAlerts,[u.R.SpecialId.Closed]:i.jv,[u.R.SpecialId.Priority]:c.bZ.belongsToPriorityLens,[u.R.SpecialId.PredictionTakeaways]:c.bZ.belongsToPredictionTakeaways,[u.R.SpecialId.PredictionEmogenie]:c.bZ.belongsToPredictionEmogenie,[u.R.SpecialId.RealTimeProofit]:t(u.R.SpecialId.RealTimeProofit)},e.defaultTextFilters=Object.assign(Object.assign({},e.defaultLensFilters),{[u.R.SpecialId.Closed]:c.bZ.isCriticalImpact,[u.R.SpecialId.Premium]:(0,o.Kg)(e.defaultLensFilters[u.R.SpecialId.Premium],c.bZ.belongsToAllAlerts)}),e.priorityTextFilters=e=>({[u.R.SpecialId.Premium]:(0,o.W9)(e[u.R.SpecialId.Premium],c.bZ.isPriority)})}(m||(m={}))},59368:(e,t,r)=>{r.d(t,{Oe:()=>i,rG:()=>n,Bd:()=>s});var i,n,s,a=r(73975),o=r(40018);!function(e){e.eq=(0,a.Uz)((e=>e.alert))(o.h$.ordId),e.isPending=e=>null!==e.state.scheduled&&(e.state.scheduled.visualState!==e.state.current.visualState||e.state.scheduled.updateRanges||e.state.scheduled.forceUpdate),e.isOneOf=(...e)=>t=>e.some((e=>e===t.state.current.visualState)),e.notAnyOf=(...e)=>t=>e.every((e=>e!==t.state.current.visualState)),e.canBeChanged=t=>r=>Boolean(t)&&s.applied===r.state.current.visualState?t===s.disposed:o.bZ.State.isBulkApplied(r.alert.state)||e.notAnyOf(s.applied,s.disposed)(r),e.isOrWillBe=e=>t=>null===t.state.scheduled?t.state.current.visualState===e:t.state.scheduled.visualState===e,e.willBe=e=>t=>null!==t.state.scheduled&&t.state.scheduled.visualState===e}(i||(i={})),function(e){e.updateRanges=function(e,t){return Object.assign(Object.assign({},e),{updateRanges:t})},e.forceUpdate=function(e,t){return Object.assign(Object.assign({},e),{forceUpdate:t})},e.updateVisualState=function(e,t){return Object.assign(Object.assign({},e),{visualState:t})},e.from=function(e){return{visualState:e,updateRanges:!1,forceUpdate:!1}}}(n||(n={})),function(e){e.initial="initial",e.highlighted="highlighted",e.visible="visible",e.faded="faded",e.hidden="hidden",e.success="success",e.applied="applied",e.disposed="disposed"}(s||(s={})),function(e){e.isApplied=function(t){return t===e.applied}}(s||(s={}))},16746:(e,t,r)=>{r.d(t,{v:()=>I});var i=r(71249),n=r(57050),s=r(40327),a=r(49524),o=r(25656),l=r(24645),c=r(51996),u=r(95195),d=r(5114),p=r(22232),h=r(83078),m=r(89943),g=r(68983),f=r(8125),y=r(81531),v=r(40018),b=r(17594),w=r(36156),S=r(59368);class I{constructor(e,t,r,i,o,l,c,p){this._alert=e,this._alertsService=t,this._alertRangeService=r,this._changeMarksInDEd=i,this._create=o,this._update=l,this._remove=c,this._onTransitionEnd=p,this._currentState=S.rG.from(S.Bd.initial),this._scheduledState=S.rG.from(S.Bd.visible),this.id=this._alert("id").id,this._marksMap=new Map,this._alertRef=this._alertsService.takeReference(this._alert("_alertRef"),"mark"),this._shouldInitMark=!0,this._tryToUpdateRangesInAlert=e=>{if(!e.to.updateRanges||!(0,s.pipe)(this._alertRangeService.hasNewRangesForUpdate(this.id),u.g_(n.jv,a.y)))return d.none;const t=(0,s.pipe)(this._alertRangeService.applyPendingRangesUpdate(this.id),u.Vn((e=>A("markAlert").error("cannot apply pending ranges",e))),d.fromEither,d.chain(a.y),d.filter((({addedHighlightedRanges:e,removedHighlightedRanges:t})=>e.length>0||t.length>0)));return(0,s.pipe)(t,d.map((e=>({commit:()=>e.removedHighlightedRanges[1](),ranges:{added:e.addedHighlightedRanges,removed:e.removedHighlightedRanges[0]}}))))},this._dispose=()=>{this._marksMap.clear(),u.wE.map(this._alertRef,(e=>e.dispose()))},this._disposeIfEmpty=()=>{0===this._marksMap.size&&this._dispose()},u.wE.mapLeft(this._alertRef,(e=>A("markAlert").warn("can not take alertRef",e)))}get state(){return{current:this._currentState,scheduled:this._scheduledState}}get alert(){return this._alert()}scheduleApply(e){return this._throwWhenNotAllowedState(e),this._throwWhenInFinaleState(e),(0,p.kG)(e!==S.Bd.initial,`Cannot schedule change ${this.id} from ${this._currentState.visualState} to initial state`),this._currentState.visualState!==S.Bd.initial||e!==S.Bd.disposed&&!S.Bd.isApplied(e)?this._scheduledState&&this._scheduledState.forceUpdate?this._scheduledState=S.rG.updateVisualState(this._scheduledState,e):this._currentState.visualState!==e||this._currentState.updateRanges?this._scheduledState=S.rG.updateVisualState(this._currentState,e):this._scheduledState=null:(this._scheduledState=null,this._currentState=S.rG.from(S.Bd.disposed),this._dispose()),this}scheduleUpdate(){this._throwWhenInFinaleState(),this._scheduledState=S.rG.updateRanges(this._scheduledState||this._currentState,!0)}scheduleForceUpdate(){this._throwWhenInFinaleState(),this._scheduledState=S.rG.forceUpdate(this._scheduledState||this._currentState,!0)}apply(){if(!S.Oe.isPending(this))return;this._throwWhenInFinaleState();const e=this._getTransition();(0,s.pipe)(this.change(),d.filter((e=>e.rawMark.length>0)),d.map((t=>{this._handleBasicEvent(t.rawMark),t.commit(),this._onTransitionEnd(e,this)})))}applyWith(e){const t=[this,...e];this._handleMultipleHighlights(t,(e=>e.change()))}markByIndex(e){try{return this._throwWhenInFinaleState(),this._shouldInitMark&&(this._shouldInitMark=!1,this.apply()),this._markbyIndex(e)}catch(e){return d.none}}get mark(){return this.markByIndex(0)}_iterateOverMarkAlerts(e,t){e.forEach((({change:e,ma:r})=>{e.rawMark.forEach((e=>{"create"===e.action?r._setMarkAndCheckFinaleState(e.id,(0,s.pipe)(t.created.get(e.id)||u.t$(new Error("Cannot get unknown mark")),d.fromEither)):"remove"===e.action&&r._removeMark(e.id)})),e.commit(),r._disposeIfEmpty()}))}_handleMultipleHighlights(e,t){const r=e.map((e=>[e,t(e)])).filter((([e,t])=>(0,s.pipe)(t,d.filter((t=>0!==t.rawMark.length||(A("markAlert").warn("rawAction must have rawMark array",{rawAction:t.action,state:Object.assign(Object.assign({},e.toJSON()),{alert:void 0})}),!1))),d.isSome))).map((([e,t])=>({ma:e,change:h.MH(t)})));if(0===r.length)return;const i=m.VS(r.map((e=>e.change.rawMark))),n=this._changeMarksInDEd(i);this._iterateOverMarkAlerts(r,n)}get _mark(){return this._markbyIndex(0)}_markbyIndex(e){return this._marksMap.size>e?0===e?this._marksMap.values().next().value:Array.from(this._marksMap.values())[e]:d.none}_setMarkAndCheckFinaleState(e,t){this._throwWhenInFinaleState(),this._setMark(e,t)}_setMark(e,t){this._shouldInitMark=!1,this._marksMap.set(e,t)}_removeMark(e){this._marksMap.delete(e)}change(){(0,p.kG)(S.Oe.isPending(this),"Next state should be scheduled to change it",(()=>JSON.stringify({currentState:this._currentState,aid:this.id})));const e=this._commitTransition();return e.from.visualState!==e.to.visualState||e.to.forceUpdate||e.to.updateRanges?d.some(this._getRawActionForApply(e)):d.none}_handleBasicEvent(e){const t=this._changeMarksInDEd(e);e.forEach((e=>{if(e.action===l.v.Change.ActionType.remove)this._removeMark(e.id);else{const r=(0,s.pipe)(d.fromNullable(this._marksMap.get(e.id)),d.chain(a.y),d.alt((()=>(0,s.pipe)((e.action===l.v.Change.ActionType.create?t.created.get(e.id):t.updated.get(e.id))||u.t$(new Error("Cannot get unknown mark")),d.fromEither))));this._setMark(e.id,r)}})),this._disposeIfEmpty()}_getTransition(){return(0,p.kG)(S.Oe.isPending(this),"Next state should be scheduled to change it",(()=>JSON.stringify({currentState:this._currentState,aid:this.id}))),{from:this._currentState,to:this._scheduledState}}_commitTransition(){const e=this._getTransition();return this._currentState=Object.assign(Object.assign({},e.to),{updateRanges:!1,forceUpdate:!1}),this._scheduledState=null,e}_getRawActionForApply(e){switch(e.from.visualState){case S.Bd.initial:return(0,s.pipe)(this._tryToUpdateRangesInAlert(e),d.map((e=>e.commit()))),{action:"create",commit:o.Z,rawMark:this._getHighlightRanges((t=>this._create((()=>t),e)(t.meta.id)))};default:switch(e.to.visualState){case S.Bd.disposed:const t=S.Bd.isApplied(e.from.visualState)||v.bZ.State.isRemoved(this.alert.state)&&b.$.isApplicableAlert(this.alert)&&this._getAppliedRanges(n.Q1).length>0?this._getAppliedRanges(((e,t)=>({id:t().meta.id,range:t}))):this._getHighlightRanges((e=>({id:e.meta.id,range:()=>e})));return{action:"remove",commit:(0,s.pipe)(this._tryToUpdateRangesInAlert(e),d.map((({commit:e})=>e)),d.getOrElse((()=>n.Q1))),rawMark:t.map((e=>this._remove(e.range)(e.id)))};case S.Bd.applied:const r=this._getHighlightRanges((e=>this._remove((()=>e))(e.meta.id)));return{action:"replace",commit:(0,s.pipe)(this._tryToUpdateRangesInAlert(e),d.map((({commit:e})=>e)),d.getOrElse((()=>n.Q1))),rawMark:[...r,...this._getAppliedRanges(((t,r)=>this._create(r,e)(r().meta.id)))]};default:const i=()=>v.bZ.State.isBulkApplied(this._alert("_getRawActionForApply").state)?this._getAppliedRanges(((e,t)=>t())):this._getHighlightRanges(a.y);return(0,s.pipe)(this._tryToUpdateRangesInAlert(e),d.map((({commit:t,ranges:r})=>this._getReplaceAction(e,i(),r.removed,t))),d.getOrElse((()=>({action:"update",commit:o.Z,rawMark:i().map((t=>this._update((()=>t),e)(t.meta.id)))}))))}}}_getReplaceAction(e,t,r,i){return{action:"replace",commit:i,rawMark:[...r.map((e=>this._remove((()=>e))(e.meta.id))),...t.map((t=>this._create((()=>t),e)(t.meta.id)))]}}_getAppliedRanges(e){return(0,s.pipe)(this._alertRangeService.getAppliedRanges(this.id),u.g_((e=>(A("markAlert").error("cannot get applied ranges",{error:e.message,alert:b.$.snapshot(this._alert("_getAppliedRanges"))}),[])),i.Su(e)))}_getHighlightRanges(e){return(0,s.pipe)(this._alertRangeService.getHighlightRanges(this.id),u.g_((t=>(A("markAlert").warn("cannot get highlight ranges via range service",{error:t,alert:this._alert("_getHighlightRanges")}),(0,s.pipe)(this._alert("_getHighlightRanges_Fallback").getHighlightRanges(),i.UI(e)))),i.UI(e)))}_throwWhenNotAllowedState(e){const t=this._alert("_throwWhenNotAllowedState");(0,p.kG)(!(!b.$.isDefault(t)&&!b.$.isSuper(t))||(!Boolean(e)||v.bZ.State.isBulkApplied(t.state)||!S.Bd.isApplied(e)),`Applied state isn't allowed for ${this.id}`)}_throwWhenInFinaleState(e){(0,p.kG)(Boolean(e)&&S.Oe.isOneOf(S.Bd.applied)(this)?e===S.Bd.disposed||v.bZ.State.isBulkApplied(this._alert("_throwWhenInFinaleState").state):S.Oe.notAnyOf(S.Bd.disposed)(this),`'${this._currentState.visualState}' MarkAlert '${this.id}' cannot be changed${Boolean(e)?` to '${e}' `:""}`)}toJSON(){return{current:this._currentState,scheduled:this._scheduledState,mark:{id:(0,s.pipe)(this._mark,d.map((e=>e.id)),d.toUndefined),range:(0,s.pipe)(this._mark,d.map((e=>e.range)),d.toUndefined)},alert:this._alert("toJSON")}}equals(e){return S.Oe.eq.equals(this,e)}hashCode(){return(0,w.AC)(this.id)}}!function(e){e.compareTo=e=>{const t=(0,g.W)(c.SV.distanceFrom)(e);return(e,r)=>(0,f.qu)(Math.min(...e.alert.getHighlightRanges().map(t)),Math.min(...r.alert.getHighlightRanges().map(t)))}}(I||(I={}));const A=(0,f.HP)(y.C8.Logging.getLogger)},25980:(e,t,r)=>{r.d(t,{v:()=>i});var i,n=r(57050),s=r(59443),a=r(95574),o=r(5114),l=r(81531),c=r(60797),u=r(66310),d=r(28043),p=r(17343),h=r(98403),m=r(91224),g=r(40151),f=r(38194),y=r(76974),v=r(77176),b=r(24209),w=r(74238),S=r(4890);!function(e){let t;!function(e){e[e.ANIMATE_ALL=0]="ANIMATE_ALL",e[e.ANIMATE_MARK=1]="ANIMATE_MARK",e[e.NO_ANIMATION=2]="NO_ANIMATION"}(t=e.Animation||(e.Animation={})),e.alignMarkToItem=function(e,r){return({animation:i,suggestedPosition:y})=>({id:v,renderOptions:{features:b},activeHighlightIndex:I,activeAlert:A})=>(0,n.zG)(e.getMarkAlertPosition({alert:A,highlightIndex:I}),c.oA,u.w((e=>{const t=a.MH(r.getCardSuggestedPositionInViewport(v,b.has(S.j.Features.showLabel),o.none,"cardContentTop"));return r.setCardPosition(v,b.has(S.j.Features.showLabel),!1,w.r.FromWindowTop.ISO.modify(w.L.concatC(-t.contentOffset))(e)).pipe(d.x(),p.h((0,n.zG)(y,o.filter((e=>r.willFitViewport(v,w.r.FromWindowTop.ISO.modify(w.L.concatC(-t.contentOffset))(e)))),o.getOrElse((()=>w.r.FromWindowTop.ISO.modify(w.L.concatC(t.contentOffset))(t.top))))))})),u.w((r=>e.moveAlertHighlightInViewport({alert:A,highlightIndex:I},r,i===t.ANIMATE_ALL?s.uq.fake:s.uq.none))),p.h(h.PU),m.K((e=>(l.C8.Logging.root.getLogger("AlignmentViewModel").error("Cannot align mark to card",e),g.E))),f.B())},e.alignItemToMark=function(t,r){return({animation:i,fitCardIntoViewport:c})=>({id:d,renderOptions:{features:I},activeAlert:A,activeHighlightIndex:_})=>(0,n.zG)(t.getMarkAlertPosition({alert:A,highlightIndex:_}),u.w(o.fold((()=>g.E),(e=>y.of(e)))),v.U((e=>({mark:e,card:a.MH(r.getCardSuggestedPositionInViewport(d,I.has(S.j.Features.showLabel),o.some(e),"cardContentTop"))}))),u.w((({card:n,mark:a})=>b.T(r.setCardPosition(d,I.has(S.j.Features.showLabel),i===e.Animation.ANIMATE_ALL,w.r.FromWindowTop.ISO.modify(w.L.concatC(-n.contentOffset))(a)),h.Ft(t.moveAlertHighlightInViewport({alert:A,highlightIndex:_},w.r.FromWindowTop.ISO.modify(w.L.concatC(n.contentOffset))(n.top),i===e.Animation.ANIMATE_ALL?s.uq.initial:s.uq.none))(c)))),p.h(h.PU),m.K((e=>(l.C8.Logging.root.getLogger("AlignmentViewModel").error("Cannot align card to mark",e),g.E))),f.B())}}(i||(i={}))},58562:(e,t,r)=>{r.d(t,{eZ:()=>G,UC:()=>$});var i=r(57050),n=r(40327),s=r(49524),a=r(12447),o=r(22232),l=r(95574),c=r(83078),u=r(8125),d=r(55415),p=r(5114),h=r(95195),m=r(40018),g=r(66896),f=r(60797),y=r(98403),v=r(85089),b=r(76974),w=r(77176),S=r(17343),I=r(93508),A=r(28043),_=r(40151),C=r(66310),E=r(598),T=r(83401),x=r(41398),k=r(55721),M=r(95093),L=r(24209),R=r(16118),N=r(85985),U=r(25980),D=r(15646),O=r(91402),P=r(35416),F=r(74238),z=r(14990),j=r(99116);var B,W,H;!function(e){e.CARD_CONTENT_OFFSET_REM=3.4,e.WITH_LABEL_CARD_CONTENT_OFFSET_REM=e.CARD_CONTENT_OFFSET_REM+1,e.contentOffsetGetter=(t=e.CARD_CONTENT_OFFSET_REM,r=e.WITH_LABEL_CARD_CONTENT_OFFSET_REM)=>(e,i)=>Math.round((e?r:t)*i)}(B||(B={})),function(e){e.cardPositionGetter=(e,t)=>(r,s)=>{const a=new z.Db.Impl(t.scrollTop.get(),t.viewport.get(),t.paddingTop.get());return l.vM((()=>(0,n.pipe)(e.view(P.nL.getLens).get(),p.chain((({items:e})=>(0,n.pipe)(e.get(r),p.map((({value:e})=>(0,n.pipe)(s,p.fold((()=>(0,i.ls)(F.L.AbsTop.ISO.wrap,a.converters.absTopToViewportTop,a.converters.viewportToWindow)(e.positionState.absTop)),i.yR))))))),c.MH)))},e.cardPositionInViewportGetter=(e,t)=>(r,s)=>{const a=new z.Db.Impl(t.scrollTop.get(),t.viewport.get(),t.paddingTop.get());return(0,n.pipe)(e.view(P.nL.getLens).get(),h.Yo((()=>new Error("Current lens is not WithItemsLensState"))),h.tS((({items:e,id:t})=>(0,n.pipe)(e.get(r),h.Yo((()=>new Error(`The item with id: ${r} does not exist in lens ${t}`))),h.tS((({value:t})=>{return(0,n.pipe)(s,p.map(a.converters.windowToViewport),p.alt((()=>p.some((0,i.ls)(F.L.AbsTop.ISO.wrap,a.converters.absTopToViewportTop)(t.positionState.absTop)))),p.map((o=t,l=((e,t)=>(0,n.pipe)(t.get(e),p.map((({index:e})=>({before:(0,n.pipe)(t.getAt(e-1),p.map((e=>e.positionState.height)),p.getOrElse((()=>0))),after:(0,n.pipe)(t.getAt(e+1),p.map((e=>e.positionState.height)),p.getOrElse((()=>0)))}))),p.getOrElse((()=>({before:0,after:0})))))(r,e),c=a.viewport,e=>{const t=(0,j.v_)({cardTop:e,cardHeight:o.positionState.height,viewportHeight:c.height,padding:l});return F.L.FromViewportTop.ISO.modify(F.L.concatC(-t))(e)})),p.map(a.converters.viewportToWindow),h.Yo((()=>new Error("Cannot get card position in viewport"))));var o,l,c}))))))}}(W||(W={})),function(e){const t=(e,t,r,i)=>{const s=i.viewport.get(),a=i.scrollTop.get(),c=F.L.converters(a,F.r.FromWindowTop.ISO.unwrap(s.top),i.paddingTop.get());return l.vM((()=>(0,n.pipe)(P.nL.getLens(r),p.chain((t=>t.items.get(e))),p.map((e=>F.L.AbsTop.ISO.wrap(e.value.positionState.absTop))),p.map((e=>c.absTopToViewportTop(e))),p.fold((()=>{throw new o.ej("Cannot get offset for unknown card")}),(e=>{const r=c.windowToViewport(t);return F.L.FromViewportTop.ISO.unwrap(e)-F.L.FromViewportTop.ISO.unwrap(r)})))))};e.moveCardToPositionSyncGetter=(e,r)=>i=>(0,n.pipe)(t(i.id,i.position,e.get(),r),h.tS((e=>r.moveCardsBy(e,"moveCardToPositionAnimated")))),e.moveCardToPositionAnimatedGetter=(e,r)=>i=>(0,n.pipe)(t(i.id,i.position,e.get(),r),h.g_((e=>O._(e)),(e=>r.moveCardsByAnimated(e,"moveCardToPositionAnimated"))))}(H||(H={}));var G,$,Y,V,Z=r(71841);class Q extends o.sH{}!function(e){e.cardSuggestedPositionGetter=(e,t)=>(r,i,s,a)=>{const o="cardTop"===a?0:t(i);return(0,n.pipe)(e(r,(0,n.pipe)(s,p.map(F.r.FromWindowTop.ISO.modify(F.L.concatC(-o))))),h.UI((e=>({top:e,contentOffset:o}))))},e.getSuperScrollMapper=(t,r,i)=>{const s=H.moveCardToPositionAnimatedGetter(t,r),a=H.moveCardToPositionSyncGetter(t,r),o=B.contentOffsetGetter();return{setCardPosition:(e,t,r,n)=>{const c={top:n,contentOffset:o(t,i.get())};return(r?s({id:e,position:n}):b.of(a({id:e,position:n})).pipe(w.U(l.MH))).pipe(S.h(c),I.O(c),A.x())},getCardSuggestedPosition:e.cardSuggestedPositionGetter(W.cardPositionGetter(t,r),(e=>o(e,i.get()))),getCardSuggestedPositionInViewport:e.cardSuggestedPositionGetter(W.cardPositionInViewportGetter(t,r),(e=>o(e,i.get()))),willFitViewport:(e,i)=>(0,n.pipe)(t.get(),(t=>!!P.nL.hasItems(t)&&((e,t)=>(r,i)=>{const s=new z.Db.Impl(t.scrollTop.get(),t.viewport.get(),t.paddingTop.get());return(0,n.pipe)(e.currentLens.items,(e=>(0,n.pipe)(e.get(r),p.map((({value:e})=>0===(0,j.v_)({cardTop:s.converters.windowToViewport(i),cardHeight:e.positionState.height,viewportHeight:s.viewport.height,padding:{before:0,after:0}}))))),c.MH)})(t,r)(e,i))),isAboveViewportTop:(u=r,e=>F.r.FromWindowTop.ISO.modify(F.L.concatC(u.scrollTop.get()+u.paddingTop.get()))(e)<u.viewport.get().top)};var u}}(G||(G={})),function(e){e.getMapper=(e,t,r)=>({moveAlertHighlightInViewport:(t,r,i)=>e.ensureAlertHighlightInViewport(t,F.r.FromWindowTop.ISO.unwrap(r),i),getMarkAlertPosition:i=>(0,n.pipe)(e.getMarkByAlert(i),h.Yo((()=>new Q("getMarkByAlert returned O.none"))),h.tS((s=>(0,n.pipe)(s.getRect(),h.UI(a.n.relativeToViewport),h.UI((e=>e.top)),h.vx((()=>(r.debug("Cached alert is missing, falling back to flush"),(r=>(t.flushChanges(),(0,n.pipe)(e.getMarkByAlert(r),h.Yo((()=>new Error("getMarkByAlert returned O.none"))),h.tS((e=>(0,n.pipe)(e.getRect(),h.UI(a.n.relativeToViewport),h.UI((e=>e.top))))))))(i)))),h.UI(F.r.FromWindowTop.ISO.wrap)))),h.Vn((e=>(e instanceof Q||r.warn("Cannot getMarkAlertPosition",e),e))),p.fromEither,(e=>b.of(e)))})}($||($={}));!function(e){e.Mock=class{constructor(){this.alignCardToMark=()=>_.E,this.alignCardTo=()=>_.E,this.alignMarkTo=()=>_.E,this.alignMarkToCard=()=>_.E}}}(Y||(Y={})),function(e){let t,r;!function(e){let t;!function(e){e.below="below",e.above="above",e.intersects="intersects"}(t=e.RelativePosition||(e.RelativePosition={})),e.getRelativePosition=(e,r,i)=>r.top+i>e.bottom?t.below:e.top>r.bottom?t.above:t.intersects}(t||(t={})),e.createAlignmentOnTypingEffect=(e,t,r,i,s)=>{const a=e.view(P.nL.mapper((({currentLens:e})=>(0,n.pipe)(p.some(e),p.filter((0,j.Bk)(s)))))).pipe(w.U(p.chain(i),p.filter(s.isValidToAlign)),f.cp((e=>r.pipe(C.w(y.b2.rafScheduler),C.w((()=>t.alignCardToMark(e,U.v.Animation.NO_ANIMATION,!1)))))));return{id:"alignmentOnTyping",when:g.R.isWithAlertsId,what:P.nL.Effect.Applicator.create(a.pipe(E.c(T.C)))}},e.createAlignOnDisjointedAreasEffect=(e,r,a,l)=>{const u=e.view((0,i.ls)(P.nL.getLens,p.filter((e=>p.isNone(P.In.getActiveItem(e))&&e.isCardsHeightValid&&e.items.size>0)))),d=u.pipe(w.U(p.isSome),A.x(),C.w(y.Ft(a.changes.pipe(I.O(y.PU),C.w(y.b2.rafScheduler),w.U((()=>p.some((e=>{const t=e.viewport.getValue();return{top:Math.min(t.text.top,t.wrapper.top),bottom:t.text.bottom}})(a)))),w.U(p.filter((e=>e.top-e.bottom!=0)))))),x.M(u.pipe(w.U(p.map((({items:e})=>e)))),c.vB(((i,s)=>(0,n.pipe)(Z.YA(e,l),p.map((e=>({top:F.r.FromWindowTop.ISO.unwrap(e.top),bottom:F.r.FromWindowTop.ISO.unwrap(e.bottom)}))),p.chain((e=>(0,n.pipe)(((e,r,i)=>{const s=(0,n.pipe)(e.getAt(0),p.map((e=>e.positionState.height)),p.getOrElse((()=>0))),a=t.getRelativePosition(r,i,s);switch(a){case t.RelativePosition.above:return(0,n.pipe)(e.getAt(0),p.map((e=>({card:e,top:r.top}))));case t.RelativePosition.below:return(0,n.pipe)(e.getAt(0),p.map((e=>({card:e,top:r.bottom-e.positionState.height}))));case t.RelativePosition.intersects:return p.none;default:return(0,o.vE)(a)}})(s,i,e),p.map((({card:e,top:t})=>r.alignCardTo(e,F.r.FromWindowTop.ISO.wrap(t),U.v.Animation.NO_ANIMATION)))))),p.getOrElse((()=>_.E)))))),C.w(p.fold((()=>_.E),s.y)));return{id:"alignOnDisjointedAreas",when:g.R.isWithAlertsId,what:P.nL.Effect.Applicator.create(d.pipe(E.c(T.C)))}},e.createAlignOnResizeSideEffect=(e,t,r,i,s,a=y.b2.rafScheduler)=>{const o=e.view(P.nL.mapper((({currentLens:e,alertSource:t})=>p.some({currentLens:e,alertSource:t})))).view(p.filter((({currentLens:e})=>(0,j.Bk)(s)(e)))).view(p.chain((({currentLens:e,alertSource:t})=>(0,n.pipe)(i(e),p.filter(s.isValidToAlign),p.map((r=>({item:r,source:t,lensId:e.id}))))))),l=v.Qr.pipe(k.p(100),M.T(r),x.M(o,((e,t)=>t)),C.w(a),C.w(p.fold((()=>_.E),(({item:e})=>t.alignCardToMark(e,U.v.Animation.NO_ANIMATION,!1)))));return{id:"alignOnResizeSideEffect",when:g.R.isWithAlertsId,what:P.nL.Effect.Applicator.create(l.pipe(E.c(T.C)))}},function(e){e.skip="skip"}(r=e.SkipAlertActionSource||(e.SkipAlertActionSource={})),e.createAlignmentSideEffect=(t,r,i=((e,t)=>t),n,s,a,o,l=y.b2.rafScheduler)=>{const c=e._createAlignmentSource(t,r,i,n,s,a,o,l);return{id:"alignmentSideEffect",when:g.R.isWithAlertsId,what:P.nL.Effect.Applicator.create(c.pipe(E.c(_.E)))}},e._createAlignmentSource=(e,t,a=((e,t)=>t),o,l,h,g,f=y.b2.rafScheduler)=>{const v=(0,u.Kg)(D.lY.isAlertMinicardButtonClick,D.lY.isSwitchToClosestByViewport,D.lY.isAlertCardShow,D.eI.isCardExpand,D.lY.isBulkAcceptItemShow,D.lY.isBulkHighlight),b=L.T(e.pipe(w.U(P.nL.mapper((({currentLens:e,alertSource:t})=>p.some({currentLens:e,alertSource:t})))),I.O(p.none),w.U(p.map((e=>e.currentLens.id))),R.G(),N.h((([e,t])=>(0,n.pipe)(c.vB(((e,t)=>e!==t))(e,t),p.exists(s.y)))),S.h(p.none)),e.pipe(w.U(P.nL.mapper((({currentLens:e,alertSource:t})=>p.some({currentLens:e,alertSource:t})))),N.h(p.exists((({currentLens:e})=>(0,j.Bk)(l)(e)))),w.U(p.chain((({currentLens:e,alertSource:t})=>(0,n.pipe)(o(e),p.filter(l.isValidToAlign),p.map((r=>({item:r,source:t,lensId:e.id}))))))))).pipe(A.x((0,i.ls)(c.vB(((e,t)=>e.lensId===t.lensId&&e.source===t.source&&e.item.activeAlert.id===t.item.activeAlert.id&&e.item.visualState.transition.type===t.item.visualState.transition.type&&e.item.activeHighlightIndex===t.item.activeHighlightIndex)),p.exists(s.y)))),E=(0,u.Kg)(D.lY.isBulkHighlight,D.lY.isAlertMinicardButtonClick),k=t.pipe(N.h(v),w.U(p.some),I.O(p.none),R.G(),N.h((0,i.ls)((0,i.og)(c.vB(((e,t)=>!D.lY.isAlertCardShow(t)||!D.lY.isAlertMinicardButtonClick(e)))),p.getOrElse(i.jv))),w.U((([,e])=>(0,n.pipe)(e,p.filter(E)))),I.O(p.none)).pipe(C.w((e=>b.pipe(N.h(p.exists((e=>e.source===m.l$.sidebar))),w.U(p.chain((t=>p.some(Object.assign(Object.assign({},t),{clickPoint:(0,n.pipe)(e,p.map(d.ei("clickPoint")))}))))))))),M=b.pipe(N.h(p.exists((e=>e.source!==m.l$.sidebar))),w.U((e=>(0,n.pipe)(e,p.chain((e=>p.some(Object.assign(Object.assign({},e),{clickPoint:p.none}))))))));return L.T(k,M).pipe(I.O(p.none),R.G(),w.U((([e,t])=>(0,n.pipe)(t,p.map((r=>({lensId:r.lensId,card:r.item,source:r.source,animate:(0,n.pipe)(e,c.wo((({lensId:e})=>e===r.lensId))),clickPoint:(0,n.pipe)(t,p.chain(d.ei("clickPoint")),p.map((0,i.ls)(d.ei("y"),F.r.FromWindowTop.ISO.wrap)))})))))),C.w(p.fold((()=>_.E),f)),x.M(e),C.w((([{card:e,source:t,animate:i,clickPoint:s,lensId:o},l])=>(0,n.pipe)(a(e,t),(t=>P.nL.hasItems(l)&&l.currentLens.items.has(e.id)&&o===l.currentLens.id&&t!==r.skip?((e,t,r,i)=>{if(r===m.l$.text)return(0,n.pipe)(e,g({animation:t?U.v.Animation.ANIMATE_ALL:U.v.Animation.NO_ANIMATION,fitCardIntoViewport:!0}));if(r===P.h8.forceText)return(0,n.pipe)(e,g({animation:U.v.Animation.NO_ANIMATION,fitCardIntoViewport:!1}));{const s=r===m.l$.sidebar?t?U.v.Animation.ANIMATE_ALL:U.v.Animation.ANIMATE_MARK:U.v.Animation.NO_ANIMATION;return(0,n.pipe)(e,h({animation:s,suggestedPosition:i}))}})(e,i,t,s):T.C)))))}}(V||(V={}))},63604:(e,t,r)=>{r.d(t,{sU:()=>de,dv:()=>ue,Xx:()=>we});var i={};r.r(i),r.d(i,{handleGbPrompt:()=>te,sendToIdeasGallery:()=>ee,sendToSignIn:()=>K});var n=r(11064),s=r(57050),a=r(40327),o=r(32952),l=r(38983),c=r(84966),u=r(59312);function d(e,t){return{map:function(r,i){return e.map(r,(function(e){return t.map(e,i)}))}}}var p,h=r(5114);function m(e){var t,r,i=(t=e,r=h.Applicative,{map:d(t,r).map,of:function(e){return t.of(r.of(e))},ap:function(e,i){return t.ap(t.map(e,(function(e){return function(t){return r.ap(e,t)}})),i)}}),n=e.of(h.none);return{map:i.map,ap:i.ap,of:i.of,chain:function(t,r){return e.chain(t,(0,h.fold)((function(){return n}),r))},alt:function(t,r){return e.chain(t,(0,h.fold)(r,(function(t){return e.of((0,h.some)(t))})))},fold:function(t,r,i){return e.chain(t,(0,h.fold)(r,i))},getOrElse:function(t,r){return e.chain(t,(0,h.fold)(r,e.of))},fromM:function(t){return e.map(t,h.some)},none:function(){return n}}}!function(e){var t;e.URI="IOOption",e.ioOption=(0,u.pi)({URI:e.URI},m(n.io)),t=(0,a.pipeable)(e.ioOption),e.map=t.map,e.chain=t.chain,e.ap=t.ap,e.alt=t.alt,e.apFirst=t.apFirst,e.apSecond=t.apSecond,e.of=e.ioOption.of,e.fold=function(t,r){return function(i){return e.ioOption.fold(i,t,r)}},e.fromM=e.ioOption.fromM}(p||(p={}));var g=r(22232),f=r(83078),y=r(8125),v=r(71249),b=r(95195),w=r(73975),S=r(81531),I=r(46680),A=r(51838),_=r(71284),C=r(40018),E=r(79227),T=r(66896),x=r(15646);class k{constructor(e,t=new URLSearchParams){this.base=e,this.params=t;const r=k._toString(e,t).length;(0,g.kG)(r<k.MAX_URL_LENGTH,"url exceeded length limit",String(r))}addParams(e){const t=Object.entries(e).reduce(((e,[t,r])=>(e.append(t,r),e)),(r=this.params,new URLSearchParams(r.toString())));var r;return new k(this.base,t)}toString(){return k._toString(this.base,this.params)}static _toString(e,t){const r=t.toString();return`${e}${r.length?`?${r}`:""}`}}k.MAX_URL_LENGTH=2083;var M=r(45586),L=r(95983),R=r(19751),N=r(598),U=r(40151),D=r(76974),O=r(66310),P=r(91402),F=r(77176),z=r(28043),j=r(44586),B=r(83401),W=r(77843),H=r(93508),G=r(95093),$=r(85985),Y=r(36919),V=r(2834),Z=r(67434),Q=r(38194),q=r(5920),X=r(25980),J=r(24209);const K=(e,t)=>(0,s.ls)($.h((e=>e.type===x.lY.Type.toSignIn)),F.U((()=>r=>(e.actions.openUrl(new k(t.funnel.signin).addParams({utm_medium:"internal",utm_source:"upHook",utm_campaign:"editorDenalianonymousUserGenericSignInPrompt"})),r)))),ee=(e,t)=>(0,s.ls)($.h(x.lY.isOpenIdeasGallery),V.b((()=>e.actions.openPopup(new k(t.ideas.galleryURL)))),N.c(U.E)),te=(e,t,r,i,n)=>s=>J.T((0,a.pipe)(s,$.h(x.lY.isGbPromptShow),V.b((e=>re(e.alertId,r,i,(e=>ie(e,n))))),N.c(U.E)),(0,a.pipe)(s,$.h(x.lY.isGbPromptApply),V.b((s=>re(s.alertId,r,i,(r=>ne(e,t,s,r,n))))),N.c(U.E)),(0,a.pipe)(s,$.h(x.lY.isGbPromptDismiss),V.b((e=>re(e.alertId,r,i,(t=>se(e,t,n))))),N.c(U.E))),re=(e,t,r,i)=>(0,a.pipe)(t.getById(e),h.map((e=>e)),f.bw(i),f.ew((()=>{r.error(`Can't find alert: ${e}`)}))),ie=(e,t)=>t.onShow(e.patternName),ne=(e,t,r,i,n)=>C.BY.isVox(r.gbPrompt)?ae(e,t,r,i,n):le(e,t,r.gbPrompt,i,n),se=(e,t,r)=>C.BY.isVox(e.gbPrompt)?oe(t,r):ce(t,r),ae=(e,t,r,i,n)=>{var s;e.actions.openPopup(new k(t.account.styleGuide).addParams({utm_medium:"internal",utm_source:"acHook",utm_campaign:"consistencySGprompt",action:"createRule",source:Array.from(new Set(i.highlightTexts)).join(","),target:(null!==(s=i.labels[r.alertApplyActionProps.alternativeIndex])&&void 0!==s?s:{replacementTexts:[""]}).replacementTexts[0]})),n.onAccept(i.patternName)},oe=(e,t)=>t.onDismiss(e.patternName),le=(e,t,r,i,n)=>{e.actions.openPopup(new k(t.account.writingStyle).addParams({utm_medium:"internal",utm_source:"acHook",utm_campaign:"consistencySGprompt",categoryTitle:r.categoryTitle})),n.onAccept(i.patternName)},ce=(e,t)=>t.onDismiss(e.patternName);var ue,de,pe=r(17594),he=r(26027),me=r(20594),ge=r(16892),fe=r(77610),ye=r(48521),ve=r(35416),be=r(25975);!function(e){const t=(e,t,r,i)=>(0,a.pipe)(i((t=>(t.lensId===e.id||T.R.isMainLens(e.id))&&!C.bZ.isPremium(t)),"middleOfTheViewport"),h.fold((()=>U.E),(i=>(0,a.pipe)(r(e),h.filter((e=>e.activeAlert.id===i.alert.id)),h.fold((()=>D.of(i)),(e=>((e,r)=>(0,a.pipe)(t,h.map((t=>t.alignMarkToCard(e,X.v.Animation.ANIMATE_ALL,h.none).pipe(N.c(U.E)))),h.getOrElse((()=>D.of(r)))))((0,s.MZ)(e),i)))))));e.changeAlertEffect=(e,r,i,n,s,o,l,c)=>({id:"changeAlertEffect",when:T.R.isWithAlertsId,what:ve.nL.Effect.SwitchAlert.create(r.actionEvents.pipe(O.w((r=>{const u=e.get();if(!ve.nL.hasCards(u))return P._(new g.ej("Cannot update state without cards"));switch(r.type){case x.lY.Type.alertMinicardButtonClick:return(0,a.pipe)(s.getRegistered(r.alertHighlight.alert.id),h.fold((()=>(c.error("somehow we got click on non registered alert",{alert:pe.$.snapshot(r.alertHighlight.alert),alertInRepo:(0,a.pipe)(s.getById(r.alertHighlight.alert.id),h.map(pe.$.fromModel),h.map(pe.$.snapshot)),state:ve.nL.snapshot(me.Mq.snapshot,n)(u)}),U.E)),(()=>D.of(r.alertHighlight))));case x.lY.Type.cardMatchesNavigationButtonClick:const e=r.transitionTo;switch(e.kind){case"anotherAlert":return(0,a.pipe)("right"===r.direction?i.nextAlert(e.card):(0,a.pipe)(i.prevAlert(e.card),f.vx(i.anyRegisteredAlert(e.card))),h.fold((()=>U.E),(e=>D.of({alert:e,highlightIndex:0}))));case"sameAlert":return(0,a.pipe)(s.getRegistered(e.card.activeAlert.id),h.fold((()=>U.E),(()=>D.of({alert:e.card.activeAlert,highlightIndex:e.highlightIndex}))));default:return(0,g.vE)(e)}case x.lY.Type.switchToClosestByViewport:return t(u.currentLens,o,n,l);default:return U.E}})),F.U((e=>({alertHighlight:e,alertSource:C.l$.sidebar,options:{order:"lensOrder"}})))))}),e.createSendActiveAlertFeedbacksEffect=function(e,t,r,i,n){const o=e.pipe(F.U(ve.nL.getActiveAlert(t)),z.x(h.getEq(w.f7(((e,t)=>pe.$.eq.equals(e,t)&&e.patternName===t.patternName))).equals),F.U(h.filter((e=>h.isSome(i.getRegistered(e.id))&&!C.bZ.isInPremiumLens(e)))),O.w(h.fold((()=>U.E),(t=>j.y.create((()=>((0,a.pipe)(r.applyFeedback(t.id,{kind:c.PZ.LOOKED,subtype:E.J.getSubTypeFromLens(e.get().currentLens.id)},C.l$.sidebar),b.g_(n.handler("Failed to send LOOKED feedback").error,y.Q1)),()=>{h.isSome(i.getRegistered(t.id))&&(0,a.pipe)(r.applyFeedback(t.id,{kind:c.PZ.CLOSED,subtype:E.J.getSubTypeFromLens(e.get().currentLens.id)},C.l$.sidebar),b.g_(n.handler("Failed to send CLOSED feedback: ").error,y.Q1))})))))));return{id:"sendActiveAlertFeedbacksEffect",when:s.W8,what:ve.nL.Effect.Applicator.create(o.pipe(N.c(B.C)))}}}(ue||(ue={}));class we{constructor(e,t,r,i,n,l,u,d,p,m,w,T,k,N=new _.A,U={bufferTransitions:!0,showGbPrompt:!1}){this._ops=e,this._navigationEvents=t,this._cardFactory=r,this._alertsService=i,this._sduiService=n,this._markOnboardingAsSeen=l,this._markMuteQuotedAdviceAsDismissed=u,this._sendToUrlExperiment=p,this._getActiveItemWithAlert=w,this._checksFeedCapabilities=T,this._lensState=k,this._platformEnvironment=N,this._settings=U,this._log=S.C8.Logging.getLogger("CardsViewModelImpl",I.i.DEBUG),this._subs=new M.w.Keeper,this._flushCompleteTransition=new o.xQ,this._flushPositionAnimation=new o.xQ,this.actionEvents=new o.xQ,this.completePositionAnimation=new o.xQ,this.changePosition=new o.xQ,this._transitionBuffer=W.F(100).pipe(H.O(0),G.T(this._flushCompleteTransition)),this._positionAnimationBuffer=W.F(100).pipe(H.O(0),G.T(this._flushPositionAnimation)),this._startTransitionStateChanges=this.actionEvents.pipe($.h(x.eI.isStartTransitionTo),F.U((e=>t=>de.itemsLens.set(this._applyStartVSChange(t.currentLens.items,[[e.id,e.transition]]),t)))),this._completeTransitionStateChanges=this.actionEvents.pipe($.h(x.eI.isCompleteTransitionTo),this._settings.bufferTransitions?Y.f(this._transitionBuffer):F.U((e=>[e])),$.h(y.Dw),F.U((e=>t=>{const r=t.currentLens,i=this._applyCompleteVSChange(r,e.map((e=>[e.id,e.transitionId])));return this._log.isEnabled(I.i.TRACE)&&this._log.trace("batch transition complete",{events:e,diff:L.aW.diff(r.items,i.items)}),ve.nL.Prism.getLens().set(i,t)}))),this._changePositionEffect=this.changePosition.pipe(F.U((({id:e,height:t})=>r=>{const i=(0,a.pipe)(q.l.update(r.currentLens.items,e,(e=>this._checksFeedCapabilities.changePosition(ge.s.PositionState.changeHeight(e.positionState,t))(e))),b.g_((()=>r.currentLens.items),s.yR));return de.itemsLens.set(i,r)}))),this._transitionEndStateChanges=this.completePositionAnimation.pipe(Y.f(this._positionAnimationBuffer),$.h(y.Dw),F.U((e=>t=>{const r=t.currentLens.items,i=e.map((e=>[e,!1])).reduce(((e,[t,r])=>(0,a.pipe)(q.l.update(e,t,(e=>this._checksFeedCapabilities.changePosition(ge.s.PositionState.changeAnimationInProgress(e.positionState,r))(e))),b.g_((()=>e),s.yR))),r);return de.itemsLens.set(i,t)}))),this._switchToNextChanges=this.actionEvents.pipe($.h((e=>e.type===x.lY.Type.switchToNext)),F.U((()=>e=>e.patch({currentLens:(0,a.pipe)(ve.nL.hasItems(e)?this._checksFeedCapabilities.findNextAlert(e.currentLens):h.none,h.fold((()=>(0,a.pipe)(ve.nL.getActiveAlert(this._getActiveItemWithAlert)(e),h.fold((()=>{throw new g.ej("Can not switch from non-existing card")}),(t=>this._checksFeedCapabilities.release(t)(e.currentLens))))),(t=>ve.nL.hasItems(e)?this._checksFeedCapabilities.selectItemByAlert(t,[])(e.currentLens):e.currentLens))),switchOrder:"lensOrder",alertSource:C.l$.sidebar})))),this._dismissMuteQuotedAdvice=this.actionEvents.pipe($.h(x.lY.isDismissMuteQuotedAdvice),V.b(this._markMuteQuotedAdviceAsDismissed),F.U((()=>e=>{const t=e.currentLens.items.filter((0,s.ls)(this._checksFeedCapabilities.hasActiveAlert,h.exists(pe.$.isInQuotes))).keys().map((e=>[e,!1])).reduce(((e,[t])=>(0,a.pipe)(q.l.update(e,t,this._cardFactory.hideMuteQuotedAdvice),b.g_((()=>e),s.yR))),e.currentLens.items);return de.itemsLens.set(t,e)}))),this._changeUserInput=this.actionEvents.pipe($.h(x.lY.isChangeUserInput),V.b((({alertId:e,userInput:t})=>{this._alertsService.changeGapValue(e,t)})),F.U((({cardId:e,userInput:t})=>r=>{const i=(0,a.pipe)(r.currentLens.items.update(e,this._checksFeedCapabilities.updateUserInput(t?h.some(t):h.none)),b.g_((()=>r.currentLens.items),s.yR));return de.itemsLens.set(i,r)}))),this._shortenItDismissEdit=this.actionEvents.pipe($.h(x.ut.isDismissEdit),F.U((({alertId:e,group:t,itemId:r})=>i=>(0,a.pipe)(this._alertsService.dismissShortenItTransformGroup(e,t),b.UI((e=>({newAlert:e,itemId:r}))),b.Zl((({newAlert:e,itemId:t})=>q.l.update(i.currentLens.items,t,this._checksFeedCapabilities.updateWithAlerts([e])))),b.g_((e=>(this._log.error("Error updating card/alert with dismissed transform groups.",e),i)),(e=>de.itemsLens.set(e,i))))))),this._focusChecksFeedItem=this.actionEvents.pipe($.h(x.lY.isMiniItemClick),F.U((e=>t=>t.patch({currentLens:(0,a.pipe)(t.currentLens.items.find((t=>t.id===e.id)),h.fold((()=>(this._log.error("Can not switch from non-existing item"),t.currentLens)),(()=>(0,s.MZ)((0,a.pipe)(t.currentLens,this._checksFeedCapabilities.selectItemById(e.id,[])))))),switchOrder:"lensOrder",alertSource:C.l$.sidebar})))),this._collapseChecklistItem=this.actionEvents.pipe($.h(x.lY.isChecklistItemCollapseButtonClick),F.U((()=>e=>e.patch({currentLens:ve.nL.hasItems(e)?this._checksFeedCapabilities.unselectItem()(e.currentLens):e.currentLens,switchOrder:"lensOrder",alertSource:C.l$.sidebar})))),this._toneAIChangeToneAlternative=this.actionEvents.pipe($.h(x.lY.isToneAIChangeToneAlternativeAction),F.U((({itemId:e,alertId:t,selectedToneAlternativeIdx:r})=>(0,a.pipe)(this._alertsService.changeToneAIToneAlternative(t,r),b.UI((t=>({newAlert:t,itemId:e})))))),F.U((e=>this._updateToneAICard(e)))),this._synfonyDrilldown=this.actionEvents.pipe($.h(x.GM.isDrilldown),F.U((({cardId:e,wordIndex:t})=>r=>(0,a.pipe)(q.l.update(r.currentLens.items,e,(e=>{const r=e;return he.X.changeSynfonySelection((0,a.pipe)(r.synfonySelection,h.getOrElse((()=>[])),(e=>h.some(e.concat([t])))))(r)})),b.g_((()=>r),(e=>ve.nL.Prism.getLens().compose(be.v.Prism.items).set(e,r))))))),this._synfonyBack=this.actionEvents.pipe($.h(x.GM.isBack),F.U((({cardId:e})=>t=>(0,a.pipe)(q.l.update(t.currentLens.items,e,(e=>{const t=e;return he.X.changeSynfonySelection((0,a.pipe)(t.synfonySelection,h.map((e=>e.slice(0,-1)))))(t)})),b.g_((()=>t),(e=>ve.nL.Prism.getLens().compose(be.v.Prism.items).set(e,t))))))),this._sendToUrl=(0,a.pipe)(this._sendToUrlExperiment,h.map((e=>Object.entries(e).filter((([e])=>"handleGbPrompt"!==e||this._settings.showGbPrompt)).map((([e,t])=>[t(this.actionEvents),e]))))),this._sendFeedback=(0,s.ls)(((e,t)=>this._alertsService.applyFeedback(e,Object.assign(Object.assign({},t),{subtype:E.J.getSubTypeFromLens(this._lensState.get().currentLens.id)}),C.l$.sidebar)),b.g_(this._log.handler("error calling alert service to send a feedback").error,y.Q1)),this._showSurveyForm=new o.xQ,this._showSurveyFormEffect=(0,a.pipe)(this._showSurveyForm,F.U((e=>t=>de.itemsLens.set(this._applyStartVSChange(t.currentLens.items,[[e.id,"survey"===e.formType?Object.assign({type:"feedback_form",formType:"survey",clockwise:!0,survey:e.survey},e.submitActionType===x.lY.Type.alertApplyFormSubmit?{submitActionType:x.lY.Type.alertApplyFormSubmit,alertApplyActionProps:e.alertApplyActionProps}:{submitActionType:x.lY.Type.alertIgnoreFormSubmit}):{type:"feedback_form",formType:"gbPrompt",clockwise:!0,gbPrompt:e.gbPrompt,alertApplyActionProps:e.alertApplyActionProps}]]),t)))),this._showMutedAlertSuccessEffect=this.actionEvents.pipe($.h(x.lY.isMuteCategoryAction),F.U((e=>t=>de.itemsLens.set(this._applyStartVSChange(t.currentLens.items,[[e.id,{type:"muted",clockwise:!0}]]),t)))),this._undoMutedAlertEffect=this.actionEvents.pipe($.h(x.lY.isUndoMuteCategoryAction),F.U((e=>t=>de.itemsLens.set(this._applyStartVSChange(t.currentLens.items,[[e.id,{type:"focused",clockwise:!0}]]),t)))),this._handleAlertIgnore=(0,s.ls)(Se((({alertId:e,drilldownSuggestionIds:t})=>()=>this._sendFeedback(e,{kind:c.PZ.IGNORE,drilldownSuggestionIds:t})),(e=>()=>this._showSurveyForm.next(e)),this._settings.showGbPrompt),(e=>this.actionEvents.pipe($.h(x.lY.isAlertIgnoreAction)).subscribe((t=>e(t)())))),this._handleApplyAlerts=(0,s.ls)(Se((e=>()=>this._applyAlert(e)),(e=>()=>this._showSurveyForm.next(e)),this._settings.showGbPrompt),(e=>this.actionEvents.pipe($.h(x.lY.isAlertApplyAction)).subscribe((t=>e(t)())))),this._sduiActionsHandler=this.actionEvents.pipe($.h(x.lY.isSDUICardAction),R.$f(x.lY.SDUICardAction.eq),F.U((({cardId:e,actions:t})=>r=>(this._log.info("sdui card action:",{cardId:e,actions:t}),(0,g.kG)(h.isSome(this._sduiService),"sduiService must be initialized to handle sdui actions"),(0,a.pipe)(t,v.u4(r,((r,i)=>{switch(i.type){case A.zx.ActionType.notify:return f.MH(this._sduiService).sendUserAction(i.id,i.userAction),r;case A.zx.ActionType.removeCard:const n=t.some(A.zx.Action.isApplyAlternativeAction)?r:de.itemsLens.set((0,a.pipe)(q.l.update(r.currentLens.items,e,(e=>this._checksFeedCapabilities.remove(s.W8,s.W8)(e))),b.g_((()=>r.currentLens.items),s.yR)),r);return(0,a.pipe)(r.currentLens.items.get(e),h.filterMap((e=>!fe.C.isWithAlertsItem(e.value)||pe.$.isPremium(e.value.activeAlert)||t.find((e=>e.type===A.zx.ActionType.applyAlternative))?h.none:h.some(e.value))),h.fold((()=>n),(e=>(requestAnimationFrame((()=>this.actionEvents.next({type:x.lY.Type.alertIgnore,alertId:e.activeAlert.id,id:e.id,eligibleForSurvey:he.X.isEligibleForDismissSurvey(e),drilldownSuggestionIds:fe.C.isSynfonyItem(e)?(0,a.pipe)(e.synfonySelection,h.getOrElse((()=>[]))):void 0}))),r))));case A.zx.ActionType.applyAlternative:return(0,a.pipe)(r.currentLens.items.get(e),h.map((e=>e.value)),b.Yo((()=>new Error(`unknown cardId: ${e}`))),b.Pd((e=>this._log.error("error in processing applyAlternative action",e)),(e=>{requestAnimationFrame((()=>this.actionEvents.next({type:x.lY.Type.alertApply,id:e.id,eligibleForSurvey:he.X.isEligibleForAcceptSurvey(e),eligibleForGbPrompt:he.X.isEligibleForGbPrompt(e),alertId:e.activeAlert.id,alternativeIndex:i.alternativeIndex,cardType:x.lY.getCardType(e)})))})),(()=>r));case A.zx.ActionType.closeCard:return r.patch({currentLens:ve.nL.hasItems(r)?this._checksFeedCapabilities.unselectItem()(r.currentLens):r.currentLens,switchOrder:"lensOrder",alertSource:C.l$.sidebar});case A.zx.ActionType.nextCard:case A.zx.ActionType.prevCard:case A.zx.ActionType.transition:case A.zx.ActionType.openSettings:case A.zx.ActionType.openToneDetector:case A.zx.ActionType.openFeedback:case A.zx.ActionType.upgradeToPremium:case A.zx.ActionType.transition:case A.zx.ActionType.selectAlternative:return r;default:return(0,g.L0)(i),r}})),(e=>e.patch({alertSource:C.l$.sidebar}))))))),this.hovered=this.actionEvents.pipe($.h(x.lY.isHoverAction),V.b((()=>this._ops.flush())),Z.R(((e,t)=>"hover"===t.kind?h.some(t.id):(0,a.pipe)(e,h.filter((e=>e!==t.id)))),h.none),Q.B()),this.flushTransitionTo=()=>this._flushCompleteTransition.next(),this.flushPositionAnimation=()=>this._flushPositionAnimation.next(),this._subs.push(this._handleAlertFeedbacks(),this._applyTakeawayFeedbacks(),this._sendTakeawayFeedbacks(),this._handleIgnoreFormSubmit(),this._handleApplyFormSubmit(),this._handleGbPromptDismiss(),this._handleGbPromptApply(),this._handleAlertIgnore(m),this._handleAlertResolve(),this._handleApplyAlerts(m),this._dismissAlertsBatch(),this._newFeatureSeen(),this._handleSentenceLevelBrandTonesFeedback(),this._handleDrilldown(),this._handleSnippetsOpenExternalLink()),(0,a.pipe)(d,f.bw((({model:e,openSuggestionsManagement:t})=>this._subs.push(this._handleCommitMuteCategories(e),this._handleSuggestionsManagementClick(t)))))}_applyStartVSChange(e,t){return t.reduce(((e,[t,r])=>(0,a.pipe)(q.l.update(e,t,(e=>this._checksFeedCapabilities.transitionTo(r)(e))),b.g_((()=>e),s.yR))),e)}_applyCompleteVSChange(e,t){return t.reduce(((e,[t,r])=>(0,a.pipe)(e.items.get(t),h.map((({value:e})=>e)),h.fold((()=>e),(i=>ye.o.isAnimatable(i)&&"removed"===i.visualState.transition.type?this._checksFeedCapabilities.removeItemById(t)(e):(0,a.pipe)(q.l.update(e.items,t,(e=>ye.o.isAnimatable(e)&&e.visualState.transitionId===r?this._checksFeedCapabilities.completeTransition(r)(e):e)),b.g_((()=>e),(t=>be.v.Prism.items.set(t,e)))))))),e)}_handleSentenceLevelBrandTonesFeedback(){return this.actionEvents.pipe($.h(x.lY.isSentenceLevelBrandTonesFeedbackAction)).subscribe((({alertId:e,feedbackType:t})=>(this._alertsService.changeSentenceLevelBrandTonesFeedback(e,t),this._sendFeedback(e,{kind:t===C.id.accurate?c.fA.EMOTION_SENTENCE_LIKE:c.fA.EMOTION_SENTENCE_DISLIKE}))))}_handleSnippetsOpenExternalLink(){return this.actionEvents.pipe($.h(x.lY.isSnippetsOpenExternalLink)).subscribe((({externalLink:e})=>this._platformEnvironment.actions.openPopup(new k(e))))}_updateToneAICard(e){return t=>(0,a.pipe)(e,b.Zl((({newAlert:e,itemId:r})=>q.l.update(t.currentLens.items,r,this._checksFeedCapabilities.updateWithAlerts([e])))),b.g_((e=>(this._log.error("Error updating card with ToneAI alert.",e),t)),(e=>ve.nL.Prism.getLens().compose(be.v.Prism.items).set(e,t))))}_handleAlertFeedbacks(){return this.actionEvents.pipe($.h(x.lY.isAlertFeedbackAction)).subscribe((({alertId:e,feedbackType:t})=>this._sendFeedback(e,{kind:t})))}_applyTakeawayFeedbacks(){return this.actionEvents.pipe($.h(x.lY.isTakeawayDetectionFeedbackAction)).subscribe((({alertId:e,type:t})=>this._alertsService.changeTakeawayFeedback(e,t===x.lY.Type.takeawayCorrectlyDetected?C.TO.correctlyDetected:t===x.lY.Type.takeawayIncorrectlyDetected?C.TO.incorrectlyDetected:(0,g.vE)(t))))}_sendTakeawayFeedbacks(){return this.actionEvents.pipe($.h(x.lY.isTakeawayAction)).subscribe((e=>{switch(e.type){case x.lY.Type.takeawayCorrectlyDetected:return e.isLikelyToBeRead?this._sendFeedback(e.alertId,{kind:c.PZ.ACKNOWLEDGED,text:e.takeawayText}):this._sendFeedback(e.alertId,{kind:c.PZ.ACCEPTED,replacementText:e.takeawayText});case x.lY.Type.takeawayIncorrectlyDetected:return this._sendFeedback(e.alertId,{kind:c.PZ.IGNORE});case x.lY.Type.takeawayDismiss:return this._sendFeedback(e.alertId,{kind:c.PZ.IGNORE,pnameQualifier:e.isLikelyToBeRead?c.N_.likelyToBeReadTakeaway:c.N_.unlikelyToBeReadTakeaway});case x.lY.Type.takeawayResolve:return this._sendFeedback(e.alertId,{kind:c.PZ.ACKNOWLEDGED,pnameQualifier:e.isLikelyToBeRead?c.N_.likelyToBeReadTakeaway:c.N_.unlikelyToBeReadTakeaway});default:(0,g.vE)(e)}}))}_handleAlertResolve(){return this.actionEvents.pipe($.h(x.lY.isAlertResolveAction)).subscribe((({alertId:e})=>this._sendFeedback(e,{kind:c.PZ.ACKNOWLEDGED})))}_handleIgnoreFormSubmit(){return this.actionEvents.pipe($.h(x.lY.isAlertIgnoreFeedbackFormSubmit)).subscribe((({alertId:e,reason:t})=>{this._sendFeedback(e,{kind:c.PZ.IGNORE,reason:t})}))}_handleApplyFormSubmit(){return this.actionEvents.pipe($.h(x.lY.isAlertApplyFeedbackFormSubmit)).subscribe((e=>{this._applyAlert(Object.assign(Object.assign({},e.alertApplyActionProps),{reason:e.reason})),e.alertApplyActionProps.actionsToDispatchAfterSurvey&&e.alertApplyActionProps.actionsToDispatchAfterSurvey.forEach((e=>this.actionEvents.next(e)))}))}_handleGbPromptDismiss(){return this.actionEvents.pipe($.h(x.lY.isGbPromptDismiss)).subscribe((e=>this._applyAlert(Object.assign(Object.assign({},e.alertApplyActionProps),{gbPrompt:c.Kd.DISMISSED}))))}_handleGbPromptApply(){return this.actionEvents.pipe($.h(x.lY.isGbPromptApply)).subscribe((e=>this._applyAlert(Object.assign(Object.assign({},e.alertApplyActionProps),{gbPrompt:c.Kd.ACCEPTED}))))}_handleCommitMuteCategories(e){return this.actionEvents.pipe($.h(x.lY.isMutedAlertCardDismissedAction)).subscribe((t=>(0,a.pipe)(e.muteCategories([t.categoryId]),b.g_(this._log.handler("error calling categories model to commit muted category").error,y.Q1))))}_handleSuggestionsManagementClick(e){return this.actionEvents.pipe($.h(x.lY.isMutedAlertSuggestionsManagementClick)).subscribe(e)}_applyAlert(e){return(0,a.pipe)(this._alertsService.apply(e.alertId,{alternativeIndex:e.alternativeIndex,source:C.l$.sidebar,feedbackSubtype:E.J.getSubTypeFromLens(this._lensState.get().currentLens.id),drilldownSuggestionIds:e.drilldownSuggestionIds,reason:e.reason,gbPrompt:e.gbPrompt}),b.g_(this._log.handler("error calling alert service to apply an alert").error,y.Q1))}_handleDrilldown(){return this.actionEvents.pipe($.h(x.GM.isDrilldown)).subscribe((e=>this._sendFeedback(e.alertId,{kind:c.P2.DRILLDOWN,drilldownSuggestionIds:e.drilldownSuggestionIds,alternativeIndex:e.alternativeId})))}_dismissAlertsBatch(){return this.actionEvents.pipe($.h(x.FG.isDismissAlertsBatchAction)).subscribe((e=>(0,a.pipe)(this._alertsService.dismissBatch(e.alerts,E.J.getSubTypeFromLens(this._lensState.get().currentLens.id)),b.g_(this._log.handler("error calling alert service to dismiss alerts batch").error,y.Q1))))}_newFeatureSeen(){return this.actionEvents.pipe($.h(x.lY.isOnboardingClose)).subscribe((e=>(0,a.pipe)(this._markOnboardingAsSeen(e.value))))}getApplicatorEffects(){return(0,a.pipe)([[this._startTransitionStateChanges,"startTransitionStateChanges"],[this._completeTransitionStateChanges,"completeTransitionStateChanges"],[this._changePositionEffect,"changePositionEffect"],[this._transitionEndStateChanges,"transitionEndStateChanges"],[this._switchToNextChanges,"switchToNextChanges"],[this._dismissMuteQuotedAdvice,"dismissMuteQuotedAdvice"],[this._changeUserInput,"changeUserInput"],[this._toneAIChangeToneAlternative,"toneAIChangeToneAlternative"],[this._synfonyDrilldown,"synfonyDrilldown"],[this._synfonyBack,"synfonyBack"],[this._focusChecksFeedItem,"focusChecksFeedItem"],[this._collapseChecklistItem,"collapseChecklistItem"],[this._shortenItDismissEdit,"shortenItDismissEdit"],[this.actionEvents.pipe($.h(x.lY.isNavigation),V.b(this._navigationEvents),N.c(U.E)),"navigationEvents"],...(0,a.pipe)(this._sendToUrl,h.getOrElse((0,s.a9)([]))),[this._showSurveyFormEffect,"showIgnoreFormEffect"],[this._showMutedAlertSuccessEffect,"showMutedAlertSuccessEffect"],[this._undoMutedAlertEffect,"undoMutedAlertEffect"],[this._sduiActionsHandler,"sduiActions"]],v.UI((([e,t])=>({id:`cardsViewModel.effects.${t}`,when:T.R.isWithAlertsId,what:ve.nL.Effect.Applicator.create(e)}))))}dispose(){this._subs.dispose()}}!function(e){e.itemsLens=ve.nL.Prism.getLens().compose(be.v.Prism.items);e.Mock=class{constructor(){this.animate=l.h.create(!0),this.clockwise=l.h.create(!0),this.toggleAnimations=()=>this.animate.modify((e=>!e)),this.completePositionAnimation=new o.xQ,this.actionEvents=new o.xQ,this.flushTransitionTo=y.Q1,this.sideEffect={id:"cardsViewModelMock",when:T.R.isWithAlertsId,what:ve.nL.Effect.Applicator.create(U.E)},this.changePosition=new o.xQ,this.dispose=y.Q1}},e.Experiments=i}(de||(de={}));const Se=(e,t,r)=>i=>s=>(0,a.pipe)(Ie(s,r),n.of,p.chain((e=>(0,a.pipe)(i,n.UI((t=>t?h.none:h.some(e)))))),p.fold((()=>e(s)),(e=>t(e)))),Ie=(e,t)=>x.lY.isAlertApplyAction(e)?Ae(e,t):_e(e),Ae=(e,t)=>(0,a.pipe)(e.eligibleForGbPrompt,h.filter((0,s.a9)(t)),h.map((t=>({id:e.id,formType:"gbPrompt",alertApplyActionProps:e,gbPrompt:t}))),f.vx((0,a.pipe)(e.eligibleForSurvey,h.map((t=>({id:e.id,formType:"survey",submitActionType:x.lY.Type.alertApplyFormSubmit,alertApplyActionProps:e,survey:t})))))),_e=e=>(0,a.pipe)(e.eligibleForSurvey,h.map((t=>({id:e.id,formType:"survey",submitActionType:x.lY.Type.alertIgnoreFormSubmit,survey:t}))))},48052:(e,t,r)=>{r.d(t,{$y:()=>Y});var i,n=r(71249),s=r(57050),a=r(40327),o=r(36991),l=r(67394),c=r(5114),u=r(95195),d=r(26328),p=r(40018),h=r(22232),m=r(84966),g=r(95574),f=r(98637);function y(e,{text:t,ops:r}){r.reduce(((t,r,i)=>l.JU.isInsertString(r)?(e.insertString(r.insert,r,i),t):l.JU.isInsertGap(r)?(e.insertGap("",r,i),t):l.JU.isInsert(r)?t:l.JU.isDelete(r)?(e.remove(t.slice(0,r.delete),r,i),t.slice(r.delete)):l.JU.isRetain(r)?(e.retain(t.slice(0,r.retain),r,i),t.slice(r.retain)):(0,h.vE)(r)),t)}function v(e){return 0===e.replace(/ /g,"").length}function b(e,t){(0,a.pipe)(e,n.Z$,c.fold((()=>{v(t.text)||e.push(t)}),(r=>{r.type===t.type?r.text+=t.text:e.push(t)})))}function w(e,t){return(0,a.pipe)(g.vM((()=>(0,a.pipe)(e,d.UI((r=>{const i=[];return y({insertString(t,{type:r}){if(r===l.JU.Type.Main)throw new N("Remove transform contains main insert",e)},insertGap(){throw new N("Remove transform contains gap insert",e)},retain(e,{type:t}){l.JU.isOptionalType(t)||b(i,{type:f.GP.Text,text:e})},remove(e,{type:r}){b(i,{type:r!==l.JU.Type.Main||v(e)&&t?f.GP.Text:f.GP.Delete,text:e})}},r),i})),n.xH))),u.tS((0,s.ls)(u.DT((e=>e.length>0),(()=>new N("Remove transform contains no data",e))),u.UI((e=>({type:i.Type.Remove,remove:e}))))))}function S(e,t){return(0,a.pipe)(g.vM((()=>(0,a.pipe)(e,d.UI((r=>{const i=[];return y({insertString(t,{type:r}){if(r===l.JU.Type.Main)throw new N("Multi-remove transform contains main insert",e)},insertGap(){throw new N("Multi-remove transform contains gap insert",e)},retain(e,{type:t}){l.JU.isOptionalType(t)||b(i,{type:f.GP.Text,text:e})},remove(e,{type:r}){b(i,{type:r!==l.JU.Type.Main||v(e)&&t?f.GP.Text:f.GP.Delete,text:e})}},r),i}))))),u.tS((0,s.ls)(u.DT((e=>e.length>=2&&e.every((e=>e.length>=2))),(()=>new N("Incomplete multi-remove",e))),u.UI((e=>({type:i.Type.RemoveOr,removes:e}))))))}function I(e){return(0,a.pipe)(g.vM((()=>(0,a.pipe)(e,d.UI((t=>{const r=[];return y({insertString(e,{type:t}){b(r,{type:l.JU.isOptionalType(t)?f.GP.Text:f.GP.Insert,text:e})},insertGap(){throw new N("Insert transform contains gap insert",e)},retain(e,{type:t}){(!l.JU.isOptionalType(t)||r.length>0)&&b(r,{type:f.GP.Text,text:e})},remove(t,{type:r}){if(r===l.JU.Type.Main)throw new N("Insert transform contains main delete",e)}},t),r}))))),u.tS((0,s.ls)(d.nI,u.Yo((()=>new N("Incomplete insert",e))),u.UI((e=>({type:i.Type.Insert,inserts:e}))))))}function A(e){const{substitutions:t,longestSubstitution:r,inserts:s}=e.reduce(((e,[t,r])=>{const i=t.map((e=>e.text)).join("");return e.substitutions.push(i),e.inserts.push(r),i.length>e.longestSubstitution.length&&(e.longestSubstitution=i),e}),{substitutions:[],inserts:[],longestSubstitution:""}),o=(0,a.pipe)(t,d.UI((e=>r.split(e).join(""))));return(0,a.pipe)(n.yL(s,o,((e,t)=>(t&&e.push({type:f.GP.Text,text:t}),e))),d.nI,u.Yo((()=>new Error("Substitution processing error"))),u.UI((e=>({type:i.Type.Substitution,remove:[{type:f.GP.Delete,text:r}],inserts:e}))))}function _(e,t){return(0,a.pipe)(C(e),u.tS((r=>(0,a.pipe)(g.vM((()=>{(0,h.kG)(t.length>0,"Drilldown transform - empty drilldown tree");return{inserts:(0,a.pipe)(t,d.UI((function e([t,i]){return(0,h.kG)(void 0!==r.inserts[t],"Drilldown transform - alternative insert not found"),{alternativeId:t,label:r.inserts[t],subLabels:i.map(e)}}))),remove:r.remove,type:i.Type.Drilldown}})),u.Vn(N.fromError(e))))))}function C(e){return(0,a.pipe)(g.vM((()=>(0,a.pipe)(e,d.UI((t=>{const r=[[],[]];return y({insertString(e){b(r[1],{type:f.GP.Insert,text:"\n"===e?"¶ ":e})},insertGap(){throw new N("Substitution transform contains gap insert",e)},remove(e){b(r[0],{type:f.GP.Delete,text:e})},retain(e,{type:t}){if(!l.JU.isOptionalType(t)||0!==r[0].length){const t={type:f.GP.Text,text:e};r[0].push(t),r[1].push(t)}}},t),(0,h.kG)(r[0].length>0,"Substituted part is empty"),(0,h.kG)(r[1].length>0,"Inserts are empty"),r}))))),u.tS(A),u.Vn(N.fromError(e)))}function E(e){if(!("list"in e))return c.none;switch(e.list){case"bullet":case"dashed":case"ordered":return c.some({kind:e.list,indent:"number"==typeof e.indent&&Number.isInteger(e.indent)?e.indent:0});default:return c.none}}function T(e){return(0,a.pipe)(e,u.DT((e=>1===e.length),(()=>new N("Expected full-sentence transform to have 1 alternative",e))),u.UI((0,s.ls)(d.YM,(t=>{let r={blockStart:0,ops:[],kind:f._k.PlainText};return y({insertString(e,t){const i=e.split("\n");if(1===i.length)r.ops.push({type:f.GP.Insert,text:e,shouldBeCollapsed:!1});else{const e=(0,a.pipe)(t.attributes,E,c.fold((()=>s.Q1),(({kind:e,indent:t})=>()=>{r.ops.splice(r.blockStart,1,{type:f.GP.List,kind:e,indent:t}),r={kind:f._k.WithFormatting,ops:r.ops,blockStart:r.blockStart}})));for(let t=0,n=i.length-1;t<=n;t++){const s=i[t];s&&r.ops.push({type:f.GP.Insert,text:s}),t<n&&(e(),r.blockStart=r.ops.length,r.ops.push({type:f.GP.Insert,text:"\n"}))}}},insertGap(){throw new N("Full sentence transform contains gap insert",e)},retain(e,t){r.ops.push({type:f.GP.Text,text:e,shouldBeCollapsed:x(t.type,e)})},remove(e,t){r.ops.push({type:f.GP.Delete,text:e,shouldBeCollapsed:x(t.type,e)})}},t),r}))),u.tS((0,s.ls)(c.fromPredicate((e=>e.ops.length>0)),u.Yo((()=>new N("Got empty full sentence transform",e))),u.UI((({ops:e,kind:t})=>({type:i.Type.FullSentence,ops:e,kind:t}))))))}!function(e){let t;!function(e){e[e.Remove=0]="Remove",e[e.RemoveOr=1]="RemoveOr",e[e.Insert=2]="Insert",e[e.Substitution=3]="Substitution",e[e.Drilldown=4]="Drilldown",e[e.FullSentence=5]="FullSentence",e[e.OneGap=6]="OneGap",e[e.ShortenIt=7]="ShortenIt",e[e.ToneAI=8]="ToneAI"}(t=e.Type||(e.Type={})),function(e){e.parse=function(t,r){const i=t[0];if(i.isFullSentence)return e.FullSentence;if(c.isSome(r.drilldown))return e.Drilldown;if(i.isShortenIt)return e.ShortenIt;if(i.isToneAI)return e.ToneAI;switch(i.type){case l.r3.Type.Insert:return e.Insert;case l.r3.Type.Remove:return t.length>1?e.RemoveOr:e.Remove;case l.r3.Type.Substitution:return i.ops.find(l.JU.isInsertGap)?e.OneGap:e.Substitution;default:return(0,h.vE)(i.type)}}}(t=e.Type||(e.Type={})),e.create=function(t){return r=>{const i=e.Type.parse(r,t);switch(i){case e.Type.Remove:return w(r,t.ignoreWhitespaceRemoves);case e.Type.RemoveOr:return S(r,t.ignoreWhitespaceRemoves);case e.Type.Insert:return I(r);case e.Type.Substitution:return C(r);case e.Type.Drilldown:return _(r,(0,a.pipe)(t.drilldown,c.getOrElse((()=>m.H5.empty))));case e.Type.FullSentence:return T(r);case e.Type.OneGap:return k(r);case e.Type.ShortenIt:return M(r);case e.Type.ToneAI:return L(r);default:return(0,h.vE)(i)}}}}(i||(i={}));const x=(e,t)=>e===l.JU.Type.Optional&&t.length>3;function k(e){return(0,a.pipe)(g.vM((()=>((0,h.kG)(1===e.length,"One gap transform does not contain exactly one alternative"),(0,a.pipe)(e,d.YM,(e=>{const t=[],r=[];let i=!1;return y({insertString(e,{type:n}){b(i?r:t,{type:l.JU.isOptionalType(n)?f.GP.Text:f.GP.Insert,text:e})},insertGap(){(0,h.kG)(!i,"One gap transform does not contain exactly one gap insert"),i=!0},retain(e,{type:n}){const s=i?r:t;(!l.JU.isOptionalType(n)||s.length>0)&&b(s,{type:f.GP.Text,text:e})},remove:s.Q1},e),(0,h.kG)(i,"One gap transform does not contain exactly one gap insert"),(0,h.kG)(t.length>0||r.length>0,"One gap transform does not contain at least one text insert"),{left:t,right:r}}))))),u.Pd(N.fromError(e),(({left:e,right:t})=>({type:i.Type.OneGap,left:e,right:t}))))}function M(e){return(0,a.pipe)(e,u.DT((e=>1===e.length),(()=>new N("Expected shorten-it transform to have 1 alternative",e))),u.tS(d.fw(u.wE)(R)),u.UI(d.YM),u.UI((e=>({type:i.Type.ShortenIt,ops:e}))))}function L(e){return(0,a.pipe)(g.vM((()=>(0,a.pipe)(e,d.UI((t=>{const r=[];return y({insertString(e){b(r,{type:f.GP.Insert,text:e})},insertGap(){throw new N("ToneAI transform should not include gap insert",e)},retain(e){b(r,{type:f.GP.Text,text:e})},remove(){}},t),r}))))),u.tS((0,s.ls)(d.nI,u.Yo((()=>new N("Incomplete ToneAI transform",e))),u.UI((e=>({type:i.Type.ToneAI,insertsOrTexts:e}))))))}function R(e){const t=[];return y({insertString(e,{group:r}){t.push({type:f.GP.Insert,text:e,group:r})},insertGap(){throw new N("ShortenIt transform contains gap insert",[e])},retain(e,{group:r}){t.push({type:f.GP.Text,text:e,group:r})},remove(e,{group:r}){t.push({type:f.GP.Delete,text:e,shouldBeCollapsed:!0,group:r})}},e),(0,a.pipe)(t,u.DT((e=>e.length>0),(()=>new N("Got empty ShortenIt transform",[e]))))}class N extends h.sH{constructor(e,t){super(e),this.alternatives=t}static fromError(e){return t=>{const r=new N(t.message,e);return r.stack=t.stack,r}}toString(){return`Hydration error: ${this.message}\n  ops: ${this.alternatives.map((e=>e.ops.map(l.JU.anonymize)))}`}}var U=r(8125),D=r(81531);const O=(e,t)=>{switch(e.kind){case"replacement":return function(e,t){(0,h.kG)((0,U.Dw)(e),"transforms should have at least one element");const[r]=e;return P(r)>-1?f.nV.create(F(r),e.map(z),t,!0):f.zE.create(e,t)}(e.content.map((e=>[{type:f.GP.Insert,text:e}])),t);case"transform":return function(e,t){(0,h.kG)((0,U.Dw)(e),"transforms should have at least one element");const[r]=e;return P(r)>-1?f.nV.create(F(r),e.map(z),t):function(e){return 2===e.length&&B(e)}(e)?f.fi.create(e[0],e[1],t):B(e)?f.zE.create(e,t):f.n6.create(e,t)}(e.content.map(G),t);default:return(0,h.vE)(e.kind)}};function P(e){return e.findIndex((e=>"arrow"===e.type))}function F(e){return e.slice(0,P(e))}function z(e){return e.slice(P(e)+1)}function j(e){return e.every((e=>"delete"!==e.type))}function B(e){return e.every(j)}function W(e,t){return{re:new RegExp(`^(${e})([\\s\\S]*)$`),createResult:t}}const H=[W("(?:\\<span class='gr_grammar_del'\\>([\\S\\s]*?)\\</span\\>)",(e=>({type:f.GP.Delete,text:e[2]}))),W("(?:\\<span class='gr_grammar_ins'\\>([\\S\\s]*?)\\</span\\>)",(e=>({type:f.GP.Insert,text:e[2]}))),W("(→)",(e=>({type:f.GP.Arrow}))),W("([^<>→]+)",(e=>({type:f.GP.Text,text:e[1]})))];function G(e){function t(e){for(const t of H){const r=e.match(t.re);if(null!==r)return[t.createResult(r),r[r.length-1]]}}function r(t){let r=["<span class='gr_grammar_del'>","<span class='gr_grammar_ins'>","→"].map((e=>t.indexOf(e)));if(r.findIndex((e=>0===e))>0)throw new Error(`Couldn't parse transform: ${e}`);if(r=r.filter((e=>e>0)),(0,U.Dw)(r)){const e=Math.min(...r);return[{type:f.GP.Text,text:t.substring(0,e)},t.substring(e)]}return[{type:f.GP.Text,text:t},""]}const i=[];let n,s=e,a=!1,o=0;for(;(0,U.Dw)(s);){const e=t(s);void 0===e&&(a=!0);const[l,c]=e||r(s);n&&n.type===f.GP.Text&&l.type===f.GP.Text?n.text+=l.text:(n&&n.type===f.GP.Delete&&l.type===f.GP.Insert&&(i.push({type:f.GP.Arrow}),o++),i.push(l)),l.type===f.GP.Arrow&&o++,n=i[i.length-1],s=c}return(a||!(0,U.Dw)(i)||o>1)&&D.C8.Logging.getLogger("model.editor.alert_replacement").warn("Bad parsing of transform",{transformHtml:e,transformPartCount:i.length,arrowCount:o}),i}const $={ignoreWhitespaceRemoves:!0},Y=(0,s.ls)((function(e,t=$){return r=>(0,a.pipe)(r.alternatives,V(e,{isFullSentence:p.eT.isFullSentence(r.cardType),isShortenIt:p.eT.isShortenIt(r.cardType),isToneAI:p.eT.isToneAI(r.cardType)}),u.tS(i.create(Object.assign(Object.assign({},t),{drilldown:r.drilldown}))))}),(e=>t=>(0,a.pipe)(t.content,u.g_((e=>u.F2(O(e,t.todo))),(0,s.ls)(e,u.UI((e=>function(e,t){switch(e.type){case i.Type.Drilldown:return f.ey.create(e.remove,e.inserts,t);case i.Type.Substitution:return f.nV.create(e.remove,e.inserts,t);case i.Type.Insert:return 2===e.inserts.length?f.fi.create(e.inserts[0],e.inserts[1],t):f.zE.create(e.inserts,t);case i.Type.Remove:return f.n6.create([e.remove],t);case i.Type.RemoveOr:return f.fz.create(e.removes,t);case i.Type.FullSentence:return function(e,t){switch(e.kind){case f._k.WithFormatting:return f.i3.createWithFormatting(e.ops,t);case f._k.PlainText:return f.i3.createPlainText(e.ops,t);default:return(0,h.vE)(e)}}(e,t);case i.Type.OneGap:return f.G7.create(e,t);case i.Type.ShortenIt:return function(e,t){return{type:f.b$.Type.ShortenIt,tooltipText:t,labels:e.ops}}(e,t);case i.Type.ToneAI:return function(e,t){return{type:f.b$.Type.ToneAI,tooltipText:t,labels:e.insertsOrTexts}}(e,t);default:return(0,h.vE)(e)}}(e,t.todo))))))));function V(e,t){const r=(0,s.ls)(e,(e=>e.delta.reduce(((e,t)=>o.s.isInsertString(t)?e+t.insert:e),"")));return(0,s.ls)(function(e,{isFullSentence:t,isShortenIt:r,isToneAI:i}){return s=>(0,a.pipe)(s,n.DZ((n=>(0,a.pipe)(n.type,c.map((s=>{if(l.r3.hasOptionalContext(n.ops)){const[a,...o]=n.ops,c=l.JU.length(a);return{text:e(c,n.lengthAffected-c),ops:o,type:s,isFullSentence:t,isShortenIt:r,isToneAI:i}}return{text:e(0,n.lengthAffected),ops:n.ops,type:s,isFullSentence:t,isShortenIt:r,isToneAI:i}}))))),d.nI)}(r,t),u.Yo((()=>new Error("Alternative array is empty"))))}},4330:(e,t,r)=>{r.d(t,{Py:()=>z,vM:()=>F,u0:()=>O,Dv:()=>U,VC:()=>D});var i,n,s,a=r(35214),o=r(57050),l=r(40327),c=r(38983),u=r(22232),d=r(8125),p=r(83078),h=r(5114),m=r(95195),g=r(81531),f=r(51838);!function(e){let t;!function(e){e.slideContentLeft={type:f.zx.ActionType.transition,fromName:"content",toName:"content",animateFrom:"slideLeft",animateTo:"slideLeft"},e.slideTitleLeft={type:f.zx.ActionType.transition,fromName:"title",toName:"title",animateFrom:"slideLeft",animateTo:"slideLeft"},e.slideContentRight={type:f.zx.ActionType.transition,fromName:"content",toName:"content",animateFrom:"slideRight",animateTo:"slideRight"},e.slideTitleRight={type:f.zx.ActionType.transition,fromName:"title",toName:"title",animateFrom:"slideRight",animateTo:"slideRight"}}(t=e.Actions||(e.Actions={}))}(i||(i={}));!function(e){e.substitution=function(e){return f.xv.create(e,f.xv.Size.regular,[f.xv.Format.strikeoutHorizontal,f.xv.Format.bold],"CoreRed50",void 0,void 0)},e.removeWeak=function(e){return f.xv.create(e,f.xv.Size.regular,[f.xv.Format.bold],"CoreRed50","CoreRed10",void 0)},e.removeStrong=function(e){return f.xv.create(e,f.xv.Size.regular,[f.xv.Format.bold],"CoreRed50","CoreRed20",void 0)},e.insertWeak=function(e){return f.xv.create(e,f.xv.Size.regular,[f.xv.Format.bold],"CoreGreen70","CoreGreen20",void 0)},e.insertText=function(e){return f.xv.create(e,f.xv.Size.regular,[f.xv.Format.bold],"CoreGreen70",void 0,void 0)},e.insertStrong=function(e){return f.xv.create(e,f.xv.Size.regular,[f.xv.Format.bold],"CoreGreen70","CoreGreen30",void 0)},e.text=function(e){return f.xv.create(e,f.xv.Size.regular,[],"CoreNeutral90",void 0,void 0)}}(n||(n={})),function(e){e.createRow=function(e,t){return{type:f.hC.row,left:e,right:t}},e.createColumn=function(e){return{type:f.hC.column,children:e}}}(s||(s={}));var y=r(40018),v=r(66896),b=r(19751),w=r(45586),S=r(98403),I=r(16118),A=r(50628),_=r(77176),C=r(93508),E=r(85985),T=r(66310),x=r(24209),k=r(2834),M=r(41398),L=r(35416),R=r(25975),N=r(73841);const U=(e,t,r,i=(()=>h.none))=>n=>{if(!e(n))return t(n);const{currentLens:s}=n;return s.kind===L._L.abstract?h.none:(0,l.pipe)(h.fromPredicate(L.nL.hasItems)(n),h.chain((e=>r.findNextAlert(e.currentLens))),h.alt((()=>i(n))),h.map(N.l.toLensAlert))},D=(e,t,r,i,n,s=R.v.WithSuccess.State.isInGlobalSuccess(n),a=(()=>!0))=>o=>{const{currentLens:c}=o;return c.kind===L._L.abstract?h.none:c.kind===L._L.persistent?(0,l.pipe)(L.nL.getActiveAlertHighlight(i)(o),h.fold((()=>L.nL.hasItems(o)?n.findNextAlert(o.currentLens):h.none),(t=>e.findNextAlertInTextByLens(t,c.id,R.v.WithPriority.nonPriorityAlertsVisible(o)))),h.alt((()=>a()&&(s(o)||v.R.isOutcomeId(o.currentLens.id)&&e.hasZeroFreeAlerts(r))?e.findPremiumAlert():h.none)),h.map(N.l.toLensAlert)):(0,l.pipe)((s=>(0,l.pipe)(h.fromPredicate(L.nL.hasItems)(s),h.chain((e=>n.findNextAlert(e.currentLens))),h.map(N.l.toLensAlert),h.alt((()=>(0,l.pipe)(L.nL.getActiveAlertHighlight(i)(s),h.fold((()=>t(y.bZ.isRegisteredApplicableAlert,"cursor")),(t=>e.findNextAlertInText(t,y.bZ.isApplicableAlert))),h.map((({alert:e,highlightIndex:t})=>({alert:e,highlightIndex:t,lensId:r.get()}))))))))(o),h.alt((()=>(0,l.pipe)(e.findPremiumAlert(),h.map(N.l.toLensAlert)))))};function O(e,t){return(r,i)=>t.findClosestAlertHighlight(e(i),r)}const P=e=>e.pipe(I.G(),A.P((([e,t])=>"idle"!==e&&"idle"===t)),_.U((()=>{})));class F{constructor(e,t){this._subs=new w.w.Keeper,this.firstOpeningOfDocumentWithAlerts=c.h.create(!1);const r=P(e),i=(e=>(0,l.pipe)(e,E.h((e=>L.nL.hasCards(e)&&h.isSome(L.In.getActiveItem(e.currentLens)))),_.U((()=>{}))))(t);this._subs.push((0,l.pipe)(t,A.P((e=>L.nL.hasCards(e))),T.w((()=>(0,l.pipe)(x.T(i,r),_.U(o.jv),C.O(!0)))),k.b(S.wW(this.firstOpeningOfDocumentWithAlerts))).subscribe())}dispose(){this._subs.dispose()}}var z;!function(e){const t=(0,d.HP)(g.C8.Logging.getLogger);e.focusFirstCardAfterBigCheck=(e,r,i,n,s)=>{const a=P(r),o=r.pipe(C.O("idle"),I.G(),A.P((([e,t])=>"idle"===t)),E.h((([e])=>"full"===e)),_.U((()=>{})));const c=((e,t)=>{const r=P(e);return t.bigPaste.pipe(T.w((()=>r)),_.U((()=>{})),b.d({bufferSize:1,refCount:!0}))})(r,n);return(0,l.pipe)(x.T(a,o,c),M.M(e,s,i),E.h((([e,t,r,i])=>i&&!r&&L.nL.hasCards(t)&&h.isNone(L.In.getActiveItem(t.currentLens)))),_.U((()=>L.nL.Effect.FocusBehavior.focusFirst)),k.b((e=>t("AutoFocus.sideEffects.focusFirstCardAfterBigCheck").trace("emit: ",e))))},e.getSideEffect=(e,t)=>{const r=(0,l.pipe)(e,_.U((e=>t=>r=>{switch(t.kind){case L.nL.Effect.FocusBehaviorType.noFocus:return r;case L.nL.Effect.FocusBehaviorType.unFocus:return L.nL.Prism.getLensWithItems().modify(e.unselectItem(),r);case L.nL.Effect.FocusBehaviorType.focusFirst:return(0,l.pipe)(e.findFirstAlert(r.currentLens),h.fold((()=>r),(t=>L.nL.Prism.getLensWithItems().modify(e.selectItemByAlert(t,[]),r))));case L.nL.Effect.FocusBehaviorType.focusNext:return(0,l.pipe)(e.findNextAlert(r.currentLens),h.fold((()=>r),(t=>L.nL.Prism.getLensWithItems().modify(e.selectItemByAlert(t,[]),r))));case L.nL.Effect.FocusBehaviorType.focusAlert:return L.nL.Prism.getLensWithItems().modify(e.selectItemByAlert(t.alertHighlight,[]),r);default:(0,u.vE)(t)}})(t)));return{id:"autoFocusEffect",when:v.R.isWithAlertsId,what:L.nL.Effect.ItemsApplicator.create(r)}},e.whenFirstOpeningDocumentWithAlerts=e=>()=>e.firstOpeningOfDocumentWithAlerts.get(),e.whenShouldVerifyCurrentLens=(e,r)=>i=>{const n="AutoFocus.stateValidator.whenShouldVerifyCurrentLens";return!(!L.nL.hasItems(i)||!r.shouldVerify(i.currentLens))&&((0,l.pipe)(L.nL.getActiveAlert(e)(i),h.filter(y.bZ.isInDuplicatedState),h.fold((()=>t(n).debug("Current alert removed, should verify current lens...")),(e=>t(n).info("Current alert removed as it's a duplicate, should verify current lens...",e.toString())))),!0)},e.whenNoActiveCard=e=>e.currentLens.items.size>0&&h.isNone(L.In.getActiveItem(e.currentLens)),e.behaviorToEffect=e=>r=>i=>(0,l.pipe)(r(i)?e(i):h.none,p.bw((e=>t("AutoFocus.stateValidator").debug(`'behavior triggered: ${e.kind}`)))),e.getDefaultBehavior=(t,r)=>(0,l.pipe)([(0,l.pipe)(e.whenShouldVerifyCurrentLens(t,r),e.behaviorToEffect((()=>h.some(L.nL.Effect.FocusBehavior.focusNext))))],(0,a.fold)((0,a.getFunctionMonoid)(h.getFirstMonoid())())),e.getAlwaysFocusBehavior=(t,r)=>(0,l.pipe)([(0,l.pipe)((0,d.Kg)(e.whenNoActiveCard,e.whenShouldVerifyCurrentLens(t,r)),e.behaviorToEffect((()=>h.some(L.nL.Effect.FocusBehavior.focusNext))))],(0,a.fold)((0,a.getFunctionMonoid)(h.getFirstMonoid())())),e.getFocusFromCacheBehavior=(t,r,i,n,s,c)=>(0,l.pipe)([(0,l.pipe)(e.whenShouldVerifyCurrentLens(n,s),e.behaviorToEffect((()=>h.some(L.nL.Effect.FocusBehavior.focusNext)))),(0,l.pipe)((0,d.W9)((()=>r.get()),(0,d.W9)((0,d.W9)((0,d.W9)(e.whenFirstOpeningDocumentWithAlerts(i),(()=>t)),e.whenNoActiveCard),(0,l.pipe)(c,h.map((e=>(0,o.ff)(e.willShowBulkAccept))),h.getOrElse((()=>o.W8))))),e.behaviorToEffect((()=>h.some(L.nL.Effect.FocusBehavior.focusFirst))))],(0,a.fold)((0,a.getFunctionMonoid)(h.getFirstMonoid())())),e.getFirstApiAlignmentOverride=function(){const e=c.h.create(!0);return(t,r)=>{let i=r;return e.get()&&r===y.l$.api&&(i=y.l$.text),e.set(!1),i}},e.getShouldAutoFocus=(e,t,r)=>i=>e.get()&&(0,l.pipe)(i,L.nL.getActiveAlert(r),h.chain((({id:e})=>t.getById(e))),h.filter((0,d.Kg)((e=>"APPLIED"===e.state.type&&"ByCard"===e.state.method),y.bZ.isDuplicated)),h.isSome),e.getSDUITransitions=({prevItemIndex:e,nextItemIndex:t})=>t>e?[i.Actions.slideContentLeft,i.Actions.slideTitleLeft]:[i.Actions.slideContentRight,i.Actions.slideTitleRight],e.getStateTransformer=(e,r,i,n,s,a,c,d=(()=>[]))=>({state:g,metadata:f})=>{const y=t("AutoFocus.stateTransformer");if(!L.nL.hasCards(g)||!L.nL.hasItems(g))return y.trace("state has no items, returning original state"),m.t$({state:g,metadata:f});const v=e(g);if(y.trace("effect: ",{state:g,metadata:f,effect:v}),h.isNone(v))return y.trace("no effect selected, returning original state"),m.t$({state:g,metadata:f});if(a(v.value),v.value.kind===L.nL.Effect.FocusBehaviorType.unFocus||v.value.kind===L.nL.Effect.FocusBehaviorType.noFocus)return m.t$({state:L.nL.Prism.getLensWithItems().modify(n.unselectItem(),g),metadata:f});const b=s(g);return y.trace("shouldAutoFocus",{alertSource:g.alertSource,shouldAutoFocus:b}),(0,l.pipe)(v,h.chain((e=>{switch(e.kind){case L.nL.Effect.FocusBehaviorType.noFocus:case L.nL.Effect.FocusBehaviorType.unFocus:return h.none;case L.nL.Effect.FocusBehaviorType.focusFirst:return(0,l.pipe)(n.findFirstAlert(g.currentLens),h.map((e=>Object.assign(Object.assign({},e),{lensId:g.currentLens.id}))));case L.nL.Effect.FocusBehaviorType.focusNext:return r(g);case L.nL.Effect.FocusBehaviorType.focusAlert:return h.some(Object.assign(Object.assign({},e.alertHighlight),{lensId:g.currentLens.id}));default:(0,u.vE)(e)}})),h.map((e=>((0,u.kG)(h.isSome(i.getRegistered(e.alert.id)),"lens alert should be in registered state",(()=>e.alert.toString())),e))),h.fold((()=>(y.trace("no alert selected, returning original state"),g.currentLens.kind===L._L.active?m.F2(m.F2({lensId:c.get(),alertSource:g.alertSource,options:{order:g.switchOrder,toFocus:L.nL.Effect.FocusBehavior.noFocus}})):m.t$({state:g,metadata:f}))),(({alert:e,highlightIndex:t,lensId:r})=>{if(y.trace("selected alert to focus",e),g.currentLens.meta.filter(e)){if(b){const r=g.currentLens.cardIndex,i=(0,l.pipe)(r,h.chain((e=>(0,l.pipe)(g.currentLens.items.getAt(e),h.map((t=>({prevItem:t,prevItemIndex:e}))))))),s={alert:e,highlightIndex:t},a=g.currentLens.items.find(n.isSelectableByAlert(s)),c=(0,l.pipe)((0,o.bc)(i,a),(0,o.og)(p.vB((({prevItemIndex:e,prevItem:t},{value:r,index:i})=>d({prevItem:t,prevItemIndex:e,nextItem:r,nextItemIndex:i})))),h.getOrElse((()=>[]))),u=L.nL.Prism.getLensWithItems().modify(n.selectItemByAlert(s,c),g);return m.t$({state:u,metadata:{sourceId:"LSM.updateActiveState"}})}return m.t$({state:g,metadata:f})}return m.F2(b?m.t$({alertHighlight:{alert:e,highlightIndex:t},alertSource:g.alertSource,options:{lensId:r,order:g.switchOrder,toFocus:L.nL.Effect.FocusBehavior.focusFirst}}):m.F2({lensId:r,alertSource:g.alertSource,options:{order:g.switchOrder,toFocus:L.nL.Effect.FocusBehavior.noFocus}}))})))}}(z||(z={}))},20291:(e,t,r)=>{r.d(t,{R7:()=>b,XU:()=>w});var i=r(40327),n=r(5114),s=r(66896),a=r(15646),o=r(48521),l=r(98403),c=r(77176),u=r(66310),d=r(85985),p=r(2834),h=r(24209),m=r(598),g=r(83401),f=r(35416),y=r(99116);const v={cardsBeyondViewport:5,cardsAroundActive:100},b=(e,t,r,i,u=v,d=l.b2.rafScheduler)=>{const p=e=>!e.positionState.visible&&o.o.isAnimatable(e)&&e.visualState.incomplete?(i.next({type:a.eI.Kind.completeTransitionTo,id:e.id,transitionId:e.visualState.transitionId}),r.completeTransition(e.visualState.transitionId)(e)):e,h=e.pipe(c.U(f.nL.mapper((({currentLens:e,alertSource:t})=>n.some({currentLens:e,alertSource:t}))))),m=(0,y.nM)(r)(h,t.viewport,t.scrollTop,t.paddingTop,d).pipe(c.U((({viewport:e,scrollTop:t,paddingTop:r})=>({viewport:e,scrollTop:t,paddingTop:r,completeTransition:p}))),c.U((0,y.GC)({cardsBeyondViewport:u.cardsBeyondViewport,cardsAroundActive:u.cardsAroundActive,changePosition:r})));return{id:"manageCardsVisibility",when:s.R.isWithAlertsId,what:f.nL.Effect.Applicator.create(m)}},w=(e,t,r)=>{const a=(0,i.pipe)(e,c.U(f.nL.mapper((({currentLens:e,alertSource:t})=>n.some({currentLens:e,alertSource:t})))),(0,y.SW)(r),u.w(l.b2.rafScheduler),d.h((e=>0!==e)),p.b((e=>t.moveCardsBy(e,"freezeActiveCardOnCardsListUpdate"))));return{id:"freezeActiveCardOnCardsListUpdate",when:s.R.isWithAlertsId,what:f.nL.Effect.Applicator.create(h.T(h.T(a).pipe(m.c(g.C))))}}},71841:(e,t,r)=>{r.d(t,{i$:()=>h,YA:()=>m});var i=r(57050),n=r(40327),s=r(5114),a=r(98403),o=r(55935),l=r(93508),c=r(19751),u=r(35416),d=r(74238),p=r(14990);const h=e=>a.Hl(e.scrollTop.pipe(o.T(1)),100,!0).pipe(l.O(!1),c.d({bufferSize:1,refCount:!0})),m=(e,t)=>{const r=new p.Db.Impl(t.scrollTop.get(),t.viewport.get(),t.paddingTop.get());return(0,n.pipe)(e.view(u.nL.getLens).get(),s.chain((({items:e,cardsHeight:t})=>(0,n.pipe)(e.getAt(0),s.map((e=>{const n=(0,i.ls)(d.L.AbsTop.ISO.wrap,r.converters.absTopToViewportTop,r.converters.viewportToWindow)(e.positionState.absTop);return{top:n,bottom:d.r.FromWindowTop.ISO.modify(d.L.concatC(t))(n)}}))))))}},35607:(e,t,r)=>{r.d(t,{o:()=>f});var i=r(40327),n=r(38983),s=r(95195),a=r(8125),o=r(81531),l=r(32952),c=r(44586),u=r(43743),d=r(16118),p=r(77176),h=r(93508),m=r(2834),g=r(74238);class f{constructor(e){this._validateOffset=e,this._log=o.C8.Logging.getLogger("CardsListScrollManager"),this.scrollTop=n.h.create(0),this.paddingTop=n.h.create(0),this.viewport=n.h.create({top:g.r.FromWindowTop.ISO.wrap(0),height:0}),this.scrollOffset=new l.xQ,this.moveCardsBy=(e,t)=>(this._log.debug(`Cards list moved by ${e}, from: ${t}`),this.scrollOffset.next(e),s.F2(void 0)),this.moveCardsByAnimated=(e,t)=>(this._log.debug(`Cards list moved by ${e}, from: ${t}`),c.y.create((t=>(0,i.pipe)(this._validateOffset(e,this),s.g_((e=>(t.thrownError(e),a.Q1)),(()=>{const r=2*this.viewport.get().height,i=Math.abs(e)>r?(e>0?1:-1)*r:e,n=e-i,s=u.f.createAnimationObservable(0,i,200).pipe(d.G(),p.U((([e,t])=>t-e)),h.O(n),m.b((e=>this.scrollOffset.next(e)))).subscribe({error:e=>t.error(e),complete:()=>t.complete()});return()=>s.unsubscribe()}))))))}}},74238:(e,t,r)=>{r.d(t,{r:()=>i,L:()=>n});var i,n,s=r(73975),a=r(50479),o=r(64681);!function(e){let t;!function(e){e.ISO=(0,o.k4)()}(t=e.FromWindowTop||(e.FromWindowTop={}))}(i||(i={})),function(e){let t,r,i;!function(e){e.ISO=(0,o.k4)(),e.equals=(0,o.Eh)(s.lr).equals}(t=e.FromViewportTop||(e.FromViewportTop={})),function(e){e.ISO=(0,o.k4)()}(r=e.AbsTop||(e.AbsTop={})),function(e){e.ISO=(0,o.k4)()}(i=e.CardTop||(e.CardTop={})),e.concatC=e=>t=>e+t;const n=e=>new a.aD(e);e.converters=function(t,r,i){const s=n(e.concatC(i)).get,a=n(e.concatC(-t)).get;return{windowToViewport:n(e.concatC(-r)).get,viewportToWindow:n(e.concatC(r)).get,cardTopToViewport:a,viewportToCardTop:n(e.concatC(t)).get,absTopToViewportTop:e=>a(s(e)),absTopToCardTop:s}}}(n||(n={}))},14990:(e,t,r)=>{r.d(t,{Db:()=>n});var i,n,s,a=r(73975),o=r(74238);!function(e){e.above="above",e.below="below",e.hidden="hidden"}(i||(i={})),function(e){e.Impl=class{constructor(e,t,r){this.scrollTop=e,this.viewport=t,this.converters=o.L.converters(e,o.r.FromWindowTop.ISO.unwrap(t.top),r)}}}(n||(n={})),function(e){const t=(0,a.MW)({top:a.lr,height:a.lr});e.eqDimensionsTuple=(0,a.IP)(t,t)}(s||(s={}))},99116:(e,t,r)=>{r.d(t,{Bk:()=>A,v_:()=>C,SW:()=>E,Sd:()=>T,nM:()=>x,GC:()=>k});var i=r(17771),n=r(29909),s=r(57050),a=r(40327),o=r(83078),l=r(5114),c=r(73975),u=r(89943),d=r(95983),p=r(77176),h=r(16118),m=r(85985),g=r(28043),f=r(66310),y=r(98403),v=r(2844),b=r(16892),w=r(35416),S=r(25975),I=r(74238);const A=e=>t=>t.isCardsHeightValid&&(0,a.pipe)(w.In.getActiveItem(t),o.wo((t=>!e.isScheduledToDispose(t)))),_=e=>t=>t.isCardsHeightValid&&(0,a.pipe)(w.In.getActiveItem(t),o.wo((t=>!e.isScheduledToDispose(t))));function C({cardTop:e,cardHeight:t,viewportHeight:r,padding:i}){const n=I.L.FromViewportTop.ISO.unwrap(e),s=n+t;return t>r?n:n<0?t+i.before<r?n-i.before:n:s>r?t+i.after<r?s-r+i.after:s-r:n<i.before?t+i.after+i.before<r?n-i.before:t+i.after<r?n-i.after:i.before:r-s<i.after&&t+i.after<r?i.after-(r-s):0}const E=e=>t=>t.pipe(T(e),p.U(l.map((e=>e.currentLens))),h.G(),m.h((([e,t])=>(0,a.pipe)((0,s.bc)(e,t),(0,s.og)(o.vB(((e,t)=>e.id===t.id&&(0,a.pipe)((0,s.bc)(w.In.getActiveItem(e),e.cardIndex,w.In.getActiveItem(t),t.cardIndex),(0,s.og)(i.g(l.option)),l.map((([e,t,r,i])=>e.id===r.id&&t!==i)))))),l.getOrElse((()=>!1))))),p.U((0,s.ls)(n.Pd(l.chain(w.In.getActiveItem),l.chain(w.In.getActiveItem)),(0,s.og)(o.vB(((e,t)=>t.positionState.absTop-e.positionState.absTop))),l.getOrElse((()=>0))))),T=e=>t=>t.pipe(p.U(l.filter((({currentLens:t})=>_(e)(t))))),x=e=>(t,r,i,n,s)=>{const o=(e=>l.getEq(c.f7(((t,r)=>{const i=w.In.getActiveItem(t),n=w.In.getActiveItem(r);return l.getEq(e.visualStateEq).equals(i,n)&&t.items.size===r.items.size&&u.Hx(t.items.keys(),r.items.keys(),((e,t)=>e===t))}))))(e);return t.pipe(p.U(l.map((e=>e.currentLens.id))),g.x(c.w4.equals),p.U(l.isSome),f.w(y.Ft(v.aj(r,i,n,T(e)(t).pipe(p.U(l.map((e=>e.currentLens))),g.x(o.equals),f.w(s))))),m.h((([t,r,i,n])=>(0,a.pipe)(n,l.exists(_(e))))),p.U((([e,t,r])=>({viewport:e,scrollTop:t,paddingTop:r}))))},k=({cardsBeyondViewport:e,cardsAroundActive:t,changePosition:r})=>({viewport:i,scrollTop:n,paddingTop:c,completeTransition:u})=>p=>{const h=p.currentLens,m=((e,t,r,i)=>e.size<2||Math.floor(t.height/Math.min(o.MH(e.getAt(0)).positionState.height,o.MH(e.getAt(1)).positionState.height))>=e.size?{from:0,to:e.size}:{from:Math.max(0,d.aW.lowerBound(e,(e=>e.positionState.absTop+e.positionState.height<r))-i),to:Math.min(e.size,d.aW.lowerBound(e,(e=>e.positionState.absTop<r+t.height))+i)})(h.items,i,n-c,e);let g=!1;const f=h.items.map(((e,i,n)=>{const o=(0,s.ls)((c=r,d=e.positionState.watched||(e=>m.from<=e&&m.to>e||(0,a.pipe)(h.cardIndex,l.exists((r=>e>=r-t&&e<=r+t))))(n),e=>e.positionState.visible!==d?c.changePosition(b.s.PositionState.changeVisible(e.positionState,d))(e):e),(e=>t=>!t.positionState.visible&&t.positionState.animationInProgress?e.changePosition(b.s.PositionState.changeAnimationInProgress(t.positionState,!1))(t):t)(r),u)(e);var c,d;return o!==e?(g=!0,o):e}));return g?w.nL.Prism.getLens().compose(S.v.Prism.items).set(f,p):p}},33806:(e,t,r)=>{r.d(t,{c:()=>n,E:()=>s});var i=r(86775);class n{constructor(e,t,r,i,n,s){this._checklistItemFactory=e,this._checklistItems=t,this._alertsReader=r,this._lensPredicate=i,this._inner=n,this._itemEq=s}create(e,t){return this._lensPredicate(t)?i.G.create(this._checklistItemFactory,this._checklistItems.get(),this._alertsReader,e,t,this._itemEq):this._inner.create(e,t)}}const s=(e,t,r,n,s,a)=>o=>n(o)?i.G.getAlertsHandler(e,t,r,a):s(o)},11245:(e,t,r)=>{r.d(t,{U:()=>w});var i=r(17889),n=r(40327),s=r(5114),a=r(22232),o=r(40018),l=r(17594),c=r(26027),u=r(55567),d=r(91549),p=r(20594),h=r(48521),m=r(77610),g=r(69345),f=r(40966),y=r(76974),v=r(70100),b=r(47306);function w(e,t,r,b){const w=p.Mq.getCardSelections(t),I=e=>t=>Object.assign(Object.assign({},t),{positionState:e}),A=e=>t=>Object.assign(Object.assign({},t),{visualState:e}),_=p.Mq.getTransitionTo(A,I),C=(e,t,i)=>n=>{const s=m.C.getAlertByIndex(i,e),a=l.$.isApplicableAlert(s)?p.Mq.getApplicableCardMeta(s,n.visualState,r):u.n.empty(void 0);return Object.assign(Object.assign({},n),{meta:a,alerts:e,activeAlert:s,removedAlertsIds:t,activeAlertIndex:i})},E=e=>t=>Object.assign(Object.assign({},t),{cachedTransform:e,transform:(0,n.pipe)(e,s.map((e=>e.labels)))}),T=t=>p.Mq.getCardHydrator((e=>e.cachedTransform),c.X.canHydrate,E,e)(t),x=p.Mq.getSelectByAlert(C,(e=>t=>Object.assign(Object.assign({},t),{userInput:e})),A,I,(e=>t=>Object.assign(Object.assign({},t),{meta:e})),T,t,r),k=p.Mq.getSelectFirstAlert(x),M=p.Mq.getSelectNextAlert(p.Mq.getCardSelections(t),x),L=p.Mq.getUnselectItem(A,I),R=p.Mq.getRemove(C,_),N=p.Mq.getChangeVisualState(A,T),U=(e,t)=>p.Mq.getCreate(S(e,t),s.none,N,(()=>y.of(s.none)),r),D=(e,t,i,a,o)=>{const l=v.X.create(e,t,i,g.Z.empty,f.t.initial({type:"rendered",clockwise:!0},!1),p.IG.toCardRenderOptions(r,a,y.of(s.none)));return(0,n.pipe)(o,s.fold((()=>l),(e=>v.X.changeVisualState(e)(l))))};return Object.assign({changePositionState:I,changeVisualState:A,completeTransition:e=>t=>A(h.o.VisualState.complete(t.visualState,e))(t),transitionTo:_,selectByAlert:x,selectFirstAlert:k,selectNextAlert:M,unselect:L,removeAlerts:R,updateWith:e=>t=>{(0,a.kG)(e.every((e=>o.bZ.isRegistered(e))),"cannot add non registered alerts");const r=new Set(e.map((e=>e.id))),i=new Set(t.removedAlertsIds);r.forEach((e=>{i.delete(e)}));const s=t.alerts.filter((e=>!r.has(e.id))).concat(e.map(l.$.fromModel)).sort(b.compare);return(0,n.pipe)(t,C(s,i,m.C.getIndexByAlert(t.activeAlert.id,s)),T)},updateMeta:e=>t=>Object.assign(Object.assign({},t),{itemMeta:e}),createDefault:D,createWithAlerts:(e,t,r,i,s,a,o)=>(0,n.pipe)(U(t,d.R.getAlertOutcomeBundle(r[0])),(t=>t(e,r,i,0,s,a,o,b))),createRenderedEmpty:(e,t,r,i)=>D(t,r,i,e,s.some(f.t.initial({type:"rendered",clockwise:!0},!1))),createRenderedWithAlerts:(e,t,i,n,a)=>{const o=h.o.VisualState.initial({type:"rendered",clockwise:!0},!1);return U(i,n)(t,a,0,0,p.Mq.getApplicableCardMeta(a[0],o,r),e,s.some(o),b)},createFocusedEmpty:(e,t,r,i)=>D(t,r,i,e,s.some(f.t.initial({type:"focused",clockwise:!0},!0))),createFocusedWithAlerts:(e,t,a,o,l,c)=>(0,n.pipe)(c,s.fold((()=>(0,n.pipe)(l,i.DY(b),(e=>({alerts:e,activeAlertIdx:0})))),(e=>({alerts:l,activeAlertIdx:e}))),(i=>{const n=h.o.VisualState.initial({type:"focused",clockwise:!0},!0);return U(a,o)(t,i.alerts,i.activeAlertIdx,0,p.Mq.getApplicableCardMeta(i.alerts[i.activeAlertIdx],n,r),e,s.some(n),b)}))},w)}const S=(e,t)=>(r,i)=>{const n=new u.n.Impl(i.meta.percentile,i.meta.explanation,i.meta.checking,i.meta.ranges,i.meta.showMuteQuotedAdvice);return b.J.create(r,e,t,i.alerts,i.activeAlertIndex,i.activeHighlightIndex,i.positionState,i.visualState,n,i.lensId,i.renderOptions,i.muteCategory,i.order,i.initialAlertId,i.removedAlertsIds,i.cachedTransform,i.userInput,i.synfonySelection)}},60682:(e,t,r)=>{r.d(t,{B:()=>i});var i,n=r(57050),s=r(38983),a=r(76974),o=r(32952),l=r(2844),c=r(77176),u=r(28043),d=r(73975),p=r(5114),h=r(8125),m=r(71249),g=r(22232),f=r(18208),y=r(83078),v=r(81531),b=r(51838),w=r(66896),S=r(40018),I=r(6782),A=r(4390),_=r(17594),C=r(55567),E=r(15646),T=r(20594),x=r(35416),k=r(25975),M=r(45586),L=r(5920),R=r(48521),N=r(22848),U=r(77610);!function(e){function t(t){return t.id===e.id}let r,i,D;function O(e){switch(e){case w.R.Type.Critical:case w.R.Type.Correctness:return"CoreRed50";case w.R.Type.Clarity:return"CoreBlue50";case w.R.Type.Engagement:return"CoreGreen60";case w.R.Type.Delivery:return"CorePurple40";case w.R.Type.Vox:return"CoreNeutral50";case w.R.Type.Plagiarism:return"CoreCyan50";case w.R.Type.Advanced:case w.R.Type.Other:return;default:return(0,g.vE)(e)}}e.id="UpgradeHookId",e.Kind="UpgradeHook",e.eq={equals:(e,t)=>d.yv.equals(e.id,t.id)&&U.C.eq.equals(e,t)&&N.e.eq.equals(e,t)},e.isUpgradeHookItem=t,function(e){e.create=e=>{const t=T.Mq.getCreate(i.createItem,p.none,i.changeVisualState,(()=>a.of(p.none)),e);return{createAdded:e=>(r,i)=>{const n=R.o.VisualState.initial({type:"added",clockwise:!0},!0);return t(r,i,0,0,C.n.empty(void 0),e,p.some(n))}}}}(r=e.ItemFactory||(e.ItemFactory={})),function(t){t.createItem=(t,r)=>Object.assign({kind:e.Kind,id:t,activeAlert:r.alerts[0],cardDSL:p.none,prevCardDSL:p.none,transitions:[],equals(t){return e.eq.equals(this,t)},hashCode(){return U.C.hashCode(Object.assign(Object.assign({},this),{userInput:p.none}))},groupedAlerts:e.getGroupedLiteAlerts(r.alertModels)},r);const r=R.o.Capabilities.getPojoUpdates(),i=U.C.Capabilities.getPojoUpdates(),s=N.e.Capabilities.getPojoUpdates();t.updateSDUIState=s.setSDUIState,t.sduiSelect=N.e.Capabilities.getSelect(t.updateSDUIState),t.changeVisualState=T.Mq.getChangeVisualState(r.setVisualState,n.yR),t.changePosition=r.setPosition,t.transitionTo=T.Mq.getTransitionTo(t.changeVisualState,t.changePosition);const a=N.e.Capabilities.getCompleteTransition(t.updateSDUIState);t.animatable={completeTransition:e=>r=>(0,n.zG)(r,t.changeVisualState(R.o.VisualState.complete(r.visualState,e)),a),transitionTo:t.transitionTo,changeVisualState:t.changeVisualState},t.updateAlerts=i.setAlerts,t.select={selectByAlert:()=>n.yR,select:(e,r,i)=>s=>(0,n.zG)(s,T.Mq.getSelectItem(t.changeVisualState,t.changePosition)(e,r),t.sduiSelect(e,i)),unselect:T.Mq.getUnselectItem(t.changeVisualState,t.changePosition)},t.remove={remove:(e,r)=>i=>e(i)?t.transitionTo({type:"removed",clockwise:r(i)})(i):i}}(i=e.Capabilities||(e.Capabilities={})),function(e){let t;!function(e){e.empty={onShowUpgradeHook:n.Q1,onOpenUpgradeUrl:n.Q1,onDismissUpgradeHook:n.Q1}}(t=e.EventHandlers||(e.EventHandlers={}));e.UpgradeHookItemViewModelImpl=class{constructor(e,t,r,i,n){this._subs=new M.w.Keeper,this.events=new o.xQ,this.upgradeHookDismissed=s.h.create(!1),this._subs.push(this.events.subscribe((r=>{"showedUpgradeHook"===r.type?n.onShowUpgradeHook():(E.lY.isSDUICardAction(r)&&r.actions.find((e=>e.type===b.zx.ActionType.upgradeToPremium))&&(t.openUpgradeUrl(i),n.onOpenUpgradeUrl()),E.lY.isSDUICardAction(r)&&r.actions.find((e=>e.type===b.zx.ActionType.removeCard))&&(this.upgradeHookDismissed.set(!0),n.onDismissUpgradeHook()),e.actionEvents.next(r))}))),this._subs.push(r.subscribe((()=>{this.upgradeHookDismissed.set(!1)})))}dispose(){this._subs.dispose()}}}(D=e.ViewModel||(e.ViewModel={})),e.getPremiumAlerts=(e,t)=>l.aj([t.view("currentLens").view("id").view(w.R.isPriority).view((e=>e?e=>S.bZ.isRegistered(e)&&S.bZ.isPremium(e)&&S.bZ.isPriority(e):e=>S.bZ.isRegistered(e)&&S.bZ.isPremium(e))),e]).pipe(c.U((([e,t])=>A.p.reduce([],((t,{alert:r})=>(e(r)&&t.push(r),t)))(t)))),e.getGroupedLiteAlerts=e=>I.Q.group(e.map((e=>e.toLiteAlert()))),e.formatLiteAlerts=(e,t=5)=>{const r=e.slice(0,t),i=e.slice(t).map((e=>e.count)).reduce(h.Sm,0);return i>0?[...r,{group:"",category:"",categoryHuman:"more...",count:i,lensName:"more...",bundleInfo:p.some("more...")}]:r},e.groupPremiumAlerts=e=>Object.values(e.reduce(((e,t)=>{const r=t.lensType;return null!=e[r]?e[r]=Object.assign(Object.assign({},e[r]),{lensNames:m.jj(d.w4)([...e[r].lensNames,t.lensName]),alertsCount:e[r].alertsCount+1}):e[r]={lensNames:[t.lensName],lensType:t.lensType,alertsCount:1},e}),{})),e.llamaSDUI=e=>{const t=e.map((e=>{var t;return b.X2.create([{type:b.hC.block,fraction:1,horizontalAlign:b.Kq.center,name:"counter",parts:[b.XF.create(e.alertsCount.toString(),null!==(t=O(e.lensType))&&void 0!==t?t:"CoreNeutral50")]},{type:b.hC.block,fraction:11,name:"alertGroup",parts:[b.xv.create(f.kC(e.lensType),b.xv.Size.regular,[],"CoreNeutral90",void 0,void 0),b.xv.create(` · ${e.lensNames.join(", ")}`,b.xv.Size.regular,[],"CoreNeutral50",void 0,void 0)]}],[],b.Ki.create("0.5","0.25","0.25","0.75"))}));return b.sg.create([b.X2.create([b.gO.create("title",void 0,void 0,b.xv.create("Premium suggestions available:",b.xv.Size.regular,[b.xv.Format.bold],"CoreNeutral90",void 0,void 0))],[b.gO.create("right-top-buttons",void 0,void 0,b.zx.createIcon("feedback",b.JO.Source.createKnown("feedback"),[{type:b.zx.ActionType.openFeedback}],"secondary","Provide feedback"),b.zx.createIcon("settings",b.JO.Source.createKnown("gear"),[{type:b.zx.ActionType.openSettings}],"secondary","Options"),b.zx.createIcon("close",b.JO.Source.createKnown("close"),[{type:b.zx.ActionType.closeCard}],"secondary","Close panel"))],b.Ki.create("0.75","0.25","0.5","0.75")),b.gO.create("content",void 0,void 0,...t),b.X2.create([{type:b.hC.button,id:"goPremium",name:"goPremium",actions:[{type:b.zx.ActionType.upgradeToPremium}],kind:"primary",state:b.zx.State.enabled,label:b.gO.create("",void 0,void 0,b.JO.create(b.JO.Source.createKnown("diamond"),void 0),b.xv.create("Unlock Premium",b.xv.Size.regular,[],"CoreNeutral0",void 0,void 0))},b.zx.create("dismiss","Dismiss",[{type:b.zx.ActionType.removeCard}],"secondary",void 0)],[b.gO.create("navigation-arrows",void 0,void 0,b.zx.createIcon("prev",b.JO.Source.createKnown("arrow-left"),[{type:b.zx.ActionType.prevCard},{type:b.zx.ActionType.transition,fromName:"content",toName:"content",animateFrom:"slideRight",animateTo:"slideRight"},{type:b.zx.ActionType.transition,fromName:"title",toName:"title",animateFrom:"slideRight",animateTo:"slideRight"}],"secondary","Previous suggestion"),b.zx.createIcon("next",b.JO.Source.createKnown("arrow-right"),[{type:b.zx.ActionType.nextCard}],"secondary","Next suggestion"))],b.Ki.create("0.5","0.25","1","0.75"))])};const P=(0,h.HP)(v.C8.Logging.getLogger);e.getSideEffect=(s,a,o,d,h,g=r.create(h))=>{const f=P("UpgradeHook.sideEffect"),v=x.nL.Prism.getLensWithItems().compose(k.v.Prism.getFeedItems()),b=a.pipe(c.U((e=>e.currentLens.id)),u.x());return{id:"upgradeHookEffect",when:w.R.isWithAlertsId,what:x.nL.Effect.ItemsApplicator.create((0,n.zG)(l.aj([s,b]),c.U((([r])=>s=>{const a=L.l.find(s.currentLens.items,t);if(o.get())return s;if(0===r.length)return p.isSome(a)?(f.trace("no more premium alerts, removing UpgradeHook item from the current lens"),v.set(s.currentLens.items.remove(e.id),s)):s;let l,c=s;return p.isNone(a)?(f.trace("premium alerts found, adding upgrade hook item to lens state",r),l=(0,n.zG)(g.createAdded(s.currentLens.id)(e.id,r),(t=>i.updateSDUIState(p.some(e.llamaSDUI(e.groupPremiumAlerts(t.alerts))),p.none,[])(t))),c=v.set(s.currentLens.items.add(l),s)):l=y.MH(a).value,c=(0,n.zG)(i.updateAlerts((0,n.zG)(r,m.UI(_.$.fromModel)))(l),(e=>s.currentLens.items.add(e)),(e=>v.set(e,c))),1===c.currentLens.items.size&&(f.trace("auto focusing upgrade hook item"),c=x.nL.Prism.getLensWithItems().modify(d.selectItemById(e.id,[]),c)),c}))))}}}(i||(i={}))},73841:(e,t,r)=>{r.d(t,{l:()=>L});var i=r(31542),n=r(11064),s=r(40327),a=r(95195),o=r(5114),l=r(8125),c=r(22232),u=r(81531),d=r(46680),p=r(66896),h=r(32952),m=r(77176),g=r(76974),f=r(95300),y=r(24209),v=r(66310),b=r(98403),w=r(69935),S=r(91224),I=r(41398),A=r(2834),_=r(28043),C=r(598),E=r(83401),T=r(17594),x=r(48521),k=r(35416),M=r(89770);class L{constructor(e,t,r,c,C,E,x){this._state=e,this._stateProvider=t,this._alertsReader=r,this._alertsService=c,this._stateSideEffects=C,this._getActiveAlert=E,this._stateTransformer=x,this.focusLens=(e,t,r={toFocus:k.Zz.defaultOptions.focusBehavior})=>{this._log.debug("focusLens "+e),this._switchLensActions.next({lensId:e,alertSource:t,options:r})},this.focusAlert=(e,t,r)=>{this._switchAlertActions.next({alertHighlight:e,alertSource:t,options:{order:r}})},this._log=u.C8.Logging.getLogger("FocusedLensManagerImpl"),this._ts=u.C8.TimeSeries.root.getMetric("lens_state.manager"),this._switchLensActions=new h.xQ,this._switchAlertActions=new h.xQ,this._addMetadata=e=>t=>t.pipe(m.U((t=>({source:t,metadata:e})))),this._focusLensEffect=({lensId:e,alertSource:t,options:{toFocus:r=k.Zz.defaultOptions.focusBehavior,order:i}})=>{if(this._log.debug("_focusLensEffect ",{alertSource:t,lensId:e}),p.R.isClosedId(e))return(0,s.pipe)(g.of(k.nL.Effect.Applicator.Source.override((0,M.T)())),this._addMetadata({sourceId:"LSM.focusLensEffect"}));if(p.R.isDraftAIId(e))return(0,s.pipe)(g.of(k.nL.Effect.Applicator.Source.override((0,M.zc)())),this._addMetadata({sourceId:"LSM.focusLensEffect"}));const n=this._state.get(),a=n.patch({switchOrder:Boolean(i)?i:n.switchOrder,alertSource:t});return(0,s.pipe)(this._stateProvider.getLensEventsByLensId(a,e,{focusBehavior:r}),this._addMetadata({sourceId:"LSM.focusLensEffect"}))},this._focusAlertEffect=({alertHighlight:e,alertSource:t,options:r})=>{this._log.isEnabled(d.i.TRACE)&&this._log.trace(`focusAlert(${e.alert})`);const i=this._state.get(),n=i.patch({switchOrder:Boolean(r.order)?r.order:i.switchOrder,alertSource:t});return(0,s.pipe)(this._stateProvider.getLensEventsByAlert(n,function(e,t,r){if(e===p.R.SpecialId.Priority||e===p.R.SpecialId.PredictionTakeaways||e===p.R.SpecialId.PredictionEmogenie||e===p.R.SpecialId.RealTimeProofit||e===p.R.SpecialId.FreePremiumAlerts)return e;if(void 0!==r)return r;if(e===p.R.SpecialId.Closed||e===p.R.SpecialId.AllAlerts)return p.R.SpecialId.AllAlerts;return t}(i.currentLens.id,e.alert.lensId,r.lensId),e),this._addMetadata({sourceId:"LSM.focusAlertEffect"}))};const L=this._state.get(),R=this._stateTransformer,N=new f.X(L);this._effects=y.T(...this._stateSideEffects.map((({when:e,what:t,id:r})=>this._state.view("currentLens","id").view(e).pipe(v.w(b.Ft((0,s.pipe)(this._effectToApplicator(t),this._addMetadata({sourceId:r}))))))),y.T(this._switchAlertActions.pipe(m.U(this._focusAlertEffect)),this._switchLensActions.pipe(m.U(this._focusLensEffect))).pipe(w.B()));const U=this._ts.getTimer("batched.long_state_change");this._subs=[this._effects.pipe(S.K(((e,t)=>(this._log.error("Got error from effects: ",e),t))),I.M(N,(({source:e,metadata:t},r)=>({state:e(r),metadata:t}))),S.K(((e,t)=>(this._log.error("Got error while applying new state: ",e),t))),A.b((e=>{this._log.isEnabled(d.i.TRACE)&&this._log.trace("lens state before state transformer: ",e)})),m.U(R),S.K(((e,t)=>(this._log.error("Got error while transforming state: ",e),t)))).subscribe((e=>(0,s.pipe)(e,a.g_((({state:e,metadata:t})=>{this._log.isEnabled(d.i.TRACE)&&this._log.trace(`lens state from: ${t.sourceId}`,e),(0,s.pipe)(this._checkState(e),a.g_((t=>this._log.error("incorrect state transition detected",{error:t,state:e})),(()=>N.next(e))))}),a.g_((e=>this._switchAlertActions.next(e)),(e=>this._switchLensActions.next(e))))))),(0,s.pipe)(N,m.U(k.nL.getActiveAlert(this._getActiveAlert)),A.b((e=>this._log.trace("active alert: ",e))),_.x(o.getEq(T.$.eq).equals),v.w(b.aI((e=>(0,s.pipe)(this._alertsService.takeReference(e,"activeCard"),a.Vn((e=>this._log.error("can not take alertRef",e))),a.g_(n.of(l.Q1),(e=>e.dispose))))))).subscribe(),(0,s.pipe)(N,m.U((e=>{const t=performance.now();i.unstable_batchedUpdates((()=>{this._state.set(e)}));const r=performance.now()-t;r>16&&U.recordTime(r)}))).subscribe()],k.nL.hasCards(L)&&(0,s.pipe)(k.nL.getActiveAlertHighlight(this._getActiveAlert)(L),o.filter((e=>this._alertsReader.isRegistered(e.alert.id))),o.fold((()=>this._switchLensActions.next({lensId:L.currentLens.id,alertSource:L.alertSource,options:{order:L.switchOrder,toFocus:k.nL.Effect.FocusBehavior.noFocus}})),(e=>this._switchAlertActions.next({alertHighlight:e,alertSource:L.alertSource,options:{lensId:L.currentLens.id,order:L.switchOrder}}))))}dispose(){this._subs.forEach((e=>e.unsubscribe())),this._subs=[]}_effectToApplicator(e){switch(e.type){case k.nL.Effect.Type.Applicator:case k.nL.Effect.Type.ItemsApplicator:return e.source;case k.nL.Effect.Type.SwitchLens:return e.source.pipe(A.b((e=>this._switchLensActions.next(e))),C.c(E.C));case k.nL.Effect.Type.SwitchAlert:return e.source.pipe(A.b((e=>this._switchAlertActions.next(e))),C.c(E.C));default:return(0,c.vE)(e)}}_checkState(e){try{if(k.nL.hasCards(e)){const t=e.currentLens.items.filter((0,l.W9)(x.o.isAnimatable,x.o.isFocused));(0,c.kG)(t.size<=1,"cannot have more than one focused card",(()=>JSON.stringify(t)))}}catch(e){return a.t$(e)}return a.F2(void 0)}}L.toLensAlert=({alert:e,highlightIndex:t})=>({alert:e,highlightIndex:t,lensId:e.lensId})},89770:(e,t,r)=>{r.d(t,{T:()=>R,zc:()=>N,oq:()=>U});var i=r(57050),n=r(40327),s=r(73975),a=r(22232),o=r(92843),l=r(5114),c=r(8125),u=r(83078),d=r(81531),p=r(46680),h=r(51374),m=r(40018),g=r(66896),f=r(4390),y=r(89772),v=r(76974),b=r(85985),w=r(28043),S=r(77176),I=r(24209),A=r(16118),_=r(2834),C=r(66310),E=r(93508),T=r(17594),x=r(35416),k=r(25975),M=r(93265);const L=(0,i.ff)(m.bZ.isMuted),R=()=>x.nL.create({alertSource:m.l$.api,switchOrder:"lensOrder",currentLens:k.v.Closed.create(i.jv,s.f7(i.jv))}),N=()=>x.nL.create({alertSource:m.l$.api,switchOrder:"lensOrder",currentLens:k.v.DraftAI.create()});class U{constructor(e,t,r,i,s,a,o,l,c,u=x.nL.FocusFirstFilter.defaultFilter){this._checkingState=e,this._alertsReader=t,this._lenses=r,this._positionManager=i,this._lensPreviewVM=s,this._lensViewFactory=a,this._alertsHandlerFactory=o,this._capabilities=l,this._alertsFilterService=c,this._focusFirstFilter=u,this._transformAlertsDiffToApplicator=e=>t=>r=>x.nL.hasItems(r)?r.patch({currentLens:e(t,L)(r.currentLens)}):r,this._log=d.C8.Logging.getLogger("FocusedLensManagerImpl"),this._updateMetaSource=e=>t=>r=>e===r.currentLens.id&&x.nL.hasItems(r)?x.nL.Prism.getLensWithItems().modify(this._capabilities.updateMeta(t),r):r,this._lensAlerts=e=>{const t=this._alertsFilterService.alertVisibleInSidebar(e.id);return(0,n.pipe)(this._checkingState.get(),f.p.reduce([],((e,{alert:r})=>t(r)?[...e,r]:e)),(e=>e.sort(m.h$.ord.compare)))}}static _mapByActiveLensId(e,t,r,i){if(g.R.isOutcomeId(e))return i();switch(e){case g.R.SpecialId.Plagiarism:return t();case g.R.SpecialId.Premium:return r();case g.R.SpecialId.AllAlerts:case g.R.SpecialId.Priority:case g.R.SpecialId.PredictionTakeaways:case g.R.SpecialId.PredictionEmogenie:case g.R.SpecialId.RealTimeProofit:case g.R.SpecialId.FreePremiumAlerts:return i();default:return(0,a.vE)(e)}}_conditionedApplicator(e,t){return r=>i=>e(i,r)?t(r)(i):i}static _filterALEvents(e,t){return r=>v.of((0,n.pipe)(r,f.p.Diff.filter((t=>e(t.alert))),(e=>(t.isEnabled(p.i.TRACE)&&t.trace("diff after filter",e),e)))).pipe(b.h((0,i.ff)(o.v.isEmpty)))}emptyState(e=g.R.SpecialId.AllAlerts){return x.nL.create({currentLens:this._createLens({lensId:e,initialLens:this._lensPreviewVM.getLens(e).get(),visibleAlerts:[],alertHighlight:l.none,alertSource:m.l$.api}),alertSource:m.l$.api,switchOrder:"lensOrder"})}getLensEventsByLensId(e,t,r={}){const i=this._getActiveLensMeta(t),s=this._lensAlerts(i),a=this._createState(e,l.none,i,t,s),o=r.focusBehavior?this._getAlertToFocus(r.focusBehavior,a):l.none;e.currentLens.id===t&&x.nL.hasItems(e)&&this._capabilities.getActiveAlertsCount(e.currentLens)!==s.length&&this._log.warn("Lens contains inconsistent number of alerts",i.id);const c=x.nL.hasItems(a)?(0,n.pipe)(o,l.fold((()=>a),(r=>this._createState(e,l.some(r),i,t,s)))):a;return this._generateEventsFromState(c,this._alertsHandlerFactory(t))}getLensEventsByAlert(e,t,r){(0,a.kG)(l.isSome(this._alertsReader.getById(r.alert.id)),"Can't focus non existing alert",r.alert.id);const i=this._getActiveLensMeta(t),n=e.currentLens.meta.id===t&&e.currentLens.meta.filter(r.alert)&&x.nL.hasItems(e)?x.nL.Prism.getLensWithItems().modify(this._capabilities.selectItemByAlert(r,[]),e):this._createState(e,l.some(r),i,t,this._lensAlerts(i));return this._generateEventsFromState(n,this._alertsHandlerFactory(t))}findClosestAlertHighlight(e,t){return(0,n.pipe)(this._positionManager.findClosestToPosition(e,(e=>h.P.is(e)&&h.x.isVisible(e)&&!h.x.isApplied(e)&&(0,n.pipe)(this._alertsReader.getRegistered(e.meta.alertId),l.exists((r=>this._alertsFilterService.alertCanBeDisplayed(r)&&t(r)&&r.getHighlightRanges().some((t=>t.meta.id===e.meta.id))))))),l.chain((e=>(0,n.pipe)(this._alertsReader.getRegistered(e.meta.alertId),l.map((t=>{const r={alert:T.$.fromModel(t),highlightIndex:t.getHighlightRanges().findIndex((t=>t.meta.id===e.meta.id))};return r.highlightIndex<0&&(this._log.error("findClosestAlertRange returned a range which doesn't exist in alert.highlightRanges",{alert:r.alert.toString(),range:JSON.stringify(e),positionManagerRanges:JSON.stringify(this._positionManager.findRanges((e=>h.P.is(e)&&e.meta.alertId===t.id))),hasPendingRanges:t.hasNewRangesForUpdate}),r.highlightIndex=0),r}))))))}findNextAlertInText({alert:e,highlightIndex:t},r){const i=e.getHighlightRanges();return(0,a.kG)(t<i.length,"AHI is out of highlightRanges length",`hr length: ${i.length}, ahi: ${t}`),this.findClosestAlertHighlight(i[t].end,r)}findNextAlertInTextByLens(e,t,r){return this.findNextAlertInText(e,this._alertsFilterService.alertVisibleInText(t,r))}findPremiumAlert(){return this._lensPreviewVM.getLens(g.R.SpecialId.Premium).get().count>0?(0,n.pipe)(this._checkingState.get(),f.p.find((0,i.ls)(m.bZ.fromAlertModel,(0,c.W9)(m.bZ.isRegistered,m.bZ.isPremium))),l.map((e=>({alert:T.$.fromModel(e.alert),highlightIndex:0})))):l.none}hasZeroFreeAlerts(e){return 0===this._lensPreviewVM.getLens(e.get()).get().priorityCount}_getMetaChangesObservable(e){return x.nL.hasItems(e)&&e.currentLens.kind===x._L.persistent?this._lensPreviewVM.getLens(e.currentLens.id).view(this._updateMetaSource(e.currentLens.id)):x.nL.hasItems(e)&&e.currentLens.type===x.Nm.lensview?this._lenses.pipe(w.x(y.w.eq.equals),S.U((0,i.ls)(y.w.lookup(e.currentLens.id),l.map(this._updateMetaSource(e.currentLens.id)),l.getOrElse((()=>x.nL.Effect.Applicator.Source.identity))))):x.nL.Effect.Applicator.Source.empty}_generateEventsFromState(e,t){return I.T(this._checkingState.pipe(A.G(),S.U((([e,t])=>f.p.diff(e,t))),_.b((e=>{this._log.isEnabled(p.i.TRACE)&&this._log.trace("new alerts diff",e)})),C.w(U._filterALEvents(e.currentLens.meta.filter,this._log)),S.U(this._conditionedApplicator(((e,t)=>{const r=this._alertsFilterService.getLensesFilter(e.currentLens.id),s=(0,n.pipe)(t,f.p.Diff.filter((0,i.ff)((({alert:e})=>r(e)))));return o.v.isEmpty(s)||this._log.info("tried to send event with alerts that do not fit current lens, skipping",{diff:f.p.Diff.show.show(s)}),o.v.isEmpty(s)}),this._transformAlertsDiffToApplicator(t)))),this._getMetaChangesObservable(e)).pipe(E.O(x.nL.Effect.Applicator.Source.override(e)))}_getActiveLensMeta(e){const t=U._mapByActiveLensId(e,(()=>this._lensPreviewVM.getLens(g.R.SpecialId.Plagiarism).get()),(()=>this._lensPreviewVM.getLens(g.R.SpecialId.Premium).get()),(()=>this._lensPreviewVM.getLens(e).get()));return(0,a.kG)(void 0!==t,`unknown lensId:${e}`),t}_createState({alertSource:e,switchOrder:t},r,i,s,o){(0,a.kG)(u.wo((({alert:e})=>l.isSome(this._alertsReader.getInteractable(e.id))))(r),"we can create state only with alert in registered state",(()=>(0,n.pipe)(r,l.fold((()=>"null"),(e=>e.toString())))));const c=this._createLens({lensId:s,initialLens:i,visibleAlerts:o,alertHighlight:r,alertSource:e});return x.nL.create({currentLens:c,alertSource:e,switchOrder:t})}_createLens(e){const t=this._focusFirstFilter(e);return M.v.createWithInitialAlerts(this._lensViewFactory,this._alertsHandlerFactory,this._alertsFilterService,L,this._capabilities)(e.lensId,e.initialLens,e.visibleAlerts,t)}_getAlertToFocus(e,t){switch(e.kind){case x.nL.Effect.FocusBehaviorType.noFocus:case x.nL.Effect.FocusBehaviorType.unFocus:return l.none;case x.nL.Effect.FocusBehaviorType.focusFirst:return x.nL.hasItems(t)?this._capabilities.findFirstAlert(t.currentLens):l.none;case x.nL.Effect.FocusBehaviorType.focusNext:return x.nL.hasItems(t)?this._capabilities.findNextAlert(t.currentLens):l.none;case x.nL.Effect.FocusBehaviorType.focusAlert:return l.some(e.alertHighlight);default:(0,a.vE)(e)}}}},39920:(e,t,r)=>{r.d(t,{is:()=>l,kn:()=>c,ad:()=>u,gi:()=>d});var i,n=r(22232),s=r(66896),a=r(35416),o=r(25975);!function(e){e.compose=function(e){return t=>a.CX.compose(e.map((e=>e(t))))},e.map=function(e,t){return r=>t(e(r))}}(i||(i={}));const l=(e,t)=>r=>{if(s.R.isOutcomeId(r))return o.v.WithSuccess.getAlertHandler(e,t);switch(r){case s.R.SpecialId.Premium:return o.v.Premium.getAlertsHandler(e,t);case s.R.SpecialId.AllAlerts:case s.R.SpecialId.Priority:case s.R.SpecialId.PredictionTakeaways:case s.R.SpecialId.PredictionEmogenie:case s.R.SpecialId.RealTimeProofit:case s.R.SpecialId.FreePremiumAlerts:return o.v.WithSuccess.getAlertHandler(e,t);default:return(0,n.vE)(r)}},c=(e,t,r,i,n)=>s=>r(s)?o.v.WithBundles.getAlertsHandler(e,t,n):i(s);class u{constructor(e,t,r,i){this._lensPredicate=e,this._inner=t,this._itemEq=r,this._itemOrd=i}create(e,t){return this._lensPredicate(t)?o.v.WithBundles.create(e,t,this._itemEq,this._itemOrd):this._inner.create(e,t)}}class d{constructor(e,t){this._itemEq=e,this._itemOrd=t}create(e,t){const r=()=>o.v.WithSuccess.create(e,t,this._itemEq,this._itemOrd);if(s.R.isOutcomeId(e))return r();switch(e){case s.R.SpecialId.Premium:return o.v.Premium.create(t,this._itemEq,this._itemOrd);case s.R.SpecialId.AllAlerts:case s.R.SpecialId.Priority:case s.R.SpecialId.PredictionTakeaways:case s.R.SpecialId.PredictionEmogenie:case s.R.SpecialId.RealTimeProofit:case s.R.SpecialId.FreePremiumAlerts:return r();default:return(0,n.vE)(e)}}}},88772:(e,t,r)=>{r.d(t,{t:()=>i});var i,n=r(95195),s=r(35416);!function(e){e.nothing=n.t$,e.liftLensState=function(e){return t=>n.t$(Object.assign(Object.assign({},t),{state:e(t.state)}))},e.liftWithItemsState=function(e){return t=>n.t$(Object.assign(Object.assign({},t),{state:s.nL.hasItems(t.state)?s.nL.Prism.getLensWithItems().modify(e,t.state):t.state}))},e.liftLensView=function(e){return t=>n.t$(Object.assign(Object.assign({},t),{state:s.nL.hasCards(t.state)?s.nL.Prism.getLens().modify(e,t.state):t.state}))}}(i||(i={}))},74364:(e,t,r)=>{r.d(t,{EQ:()=>D,ay:()=>N,$A:()=>U});var i,n=r(57050),s=r(40327),a=r(8125),o=r(95574),l=r(22232),c=r(83078),u=r(5114),d=r(95195),p=r(40018),h=r(66896),m=r(98403),g=r(19751),f=r(60797),y=r(32952),v=r(28043),b=r(66310),w=r(40151),S=r(44586),I=r(78674),A=r(77176),_=r(93508),C=r(598),E=r(83401),T=r(2834),x=r(55935),k=r(85985),M=r(41398),L=r(73975),R=r(71249);!function(e){e.eq=(0,L.MW)({alert:(0,L.Uz)((e=>e.id))(L.w4),highlightIndex:L.w4}),e.getEq=()=>e.eq,e.getHighlightRange=e=>R.P5(e.highlightIndex)(e.alert.getHighlightRanges())}(i||(i={}));var N,U,D,O=r(35416);!function(e){let t;!function(e){e.AppliedAlertAnimationFinished="AppliedAlertAnimationFinished"}(t=e.Type||(e.Type={}))}(N||(N={})),function(e){e.Mock=class{constructor(){this.events=new y.xQ,this.focusAlertHighlight=()=>d.t$(new Error("Method not implemented.")),this.highlightAlertHighlight=()=>d.t$(new Error("Method not implemented.")),this.moveCursorToHighlight=a.Q1}ensureAlertHighlightInViewport(){throw new Error("Method not implemented.")}getMarkByAlert(e){throw new Error("Method not implemented.")}getAlertByMark(e){throw new Error("Method not implemented.")}},e.getHighlightIndex=function(e,t){return(0,s.pipe)(t,d.Vn((()=>new Error("Mark is collapsed"))),d.tS((t=>o.vM((()=>{const r=e.getHighlightRanges(),i=r.length>1?r.findIndex((e=>e.start===t.start&&e.end===t.end)):0;return(0,l.kG)(-1!==i,"Could not find highlight index by Range for provided Alert",(()=>JSON.stringify({alertRanges:r,targetRange:t}))),i})))))}}(U||(U={})),function(e){e.getHighlightSubscribtion=(e,t,r)=>e.pipe(v.x(u.getEq(p.h$.ord).equals),b.w((e=>(0,s.pipe)(e,u.fold((()=>w.E),(e=>S.y.create((()=>(r.debug(`highlight mark: ${e.id}`),(0,s.pipe)(t.highlightAlertHighlight(e),d.g_((t=>(r.error(`Cannot highlight mark: ${e.id}`,t),a.Q1)),(t=>()=>{r.debug(`unhighlight mark: ${e.id}`),t.dispose()})))))))))))),e.getHoverAlertHightlightSource=(e,t,r,i)=>(0,s.pipe)(i,I.b(100),A.U((0,n.ls)(u.chain((i=>{const n=e.get();return O.nL.hasCards(n)?n.currentLens.items.find((e=>(0,s.pipe)(t.hasActiveAlert(e),u.exists((t=>e.id===i&&r.isRegistered(t.id)))))):u.none})),u.chain((({value:e})=>t.hasActiveAlert(e))))),v.x(u.getEq(p.h$.ord).equals),A.U(u.map((t=>({alert:t,highlightIndex:0,source:e.get().alertSource})))),_.O(u.none)),e.highlightMarkByHighlightedCard=(t,r,i,a,o,l)=>{const c=e.getHighlightSubscribtion(t.hovered.pipe(I.b(100),A.U((0,n.ls)(u.chain((e=>{const t=r.get();return O.nL.hasCards(t)?t.currentLens.items.find((t=>(0,s.pipe)(o.hasActiveAlert(t),u.exists((r=>t.id===e&&a.isRegistered(r.id)))))):u.none})),u.chain((({value:e})=>o.hasActiveAlert(e)))))),i,l);return{id:"highlightMarkByHighlightedAlert",when:h.R.isWithAlertsId,what:O.nL.Effect.Applicator.create(c.pipe(C.c(E.C)))}},e.getAlertHighlightSource=e=>t=>(0,s.pipe)(t,v.x(u.getEq(p.h$.ord).equals),A.U(u.map((t=>({alert:t,source:e,highlightIndex:0})))),_.O(u.none)),e.getActiveHighlightSource=(e,t,r)=>e.view(O.nL.mapper((({currentLens:e,alertSource:t})=>(0,s.pipe)(r(e),u.map((e=>({alert:e.activeAlert,source:t,highlightIndex:e.activeHighlightIndex}))))))).pipe(b.w(m.b2.rafScheduler),g.$f(u.getEq(i.getEq())),A.U(u.filter((e=>u.isSome(t.getRegistered(e.alert.id)))))),e.focusMarkByActiveAlert=(t,r,i,n,o)=>{const l=(0,s.pipe)(e.getActiveHighlightSource(t,i,n),T.b(c.bw((e=>o.trace("new alert highlight: ",e)))),b.w(u.fold((()=>(o.debug("Nothing to focus"),w.E)),(e=>S.y.create((()=>(o.debug(`Focus mark: ${e.alert.id} | ${e.highlightIndex}`),e.source===p.l$.sidebar&&r.moveCursorToHighlight(e,"start"),(0,s.pipe)(r.focusAlertHighlight(e),d.g_((t=>(o.error("Cannot focus mark",t,{alertId:e.alert.id,highlightIndex:e.highlightIndex}),a.Q1)),(t=>()=>{o.debug(`Unfocus mark: ${e.alert.id} | ${e.highlightIndex}'`),t.dispose()}))))))))));return{id:"focusMarkByActiveAlert",when:h.R.isWithAlertsId,what:O.nL.Effect.Applicator.create(l.pipe(C.c(E.C)))}},e.focusAlertByClickedMark=(e,t)=>({id:"focusAlertByActiveMark",when:O.nL.Effect.When.isSidebarOpen,what:O.nL.Effect.SwitchAlert.create(e.alertClicked.pipe(x.T(1),f.oA,k.h((e=>p.bZ.State.isRegistered(e.alert.state))),M.M(t.pipe(k.h(O.nL.hasCards)),((e,t)=>e)),A.U((({alert:e,highlightIndex:t})=>({alertHighlight:{alert:e,highlightIndex:t},alertSource:p.l$.text,options:{order:"textOrder"}})))))}),e.createOnAlertApplySideEffect=function(e,t){const r=e.pipe(A.U((e=>r=>e.type===N.Type.AppliedAlertAnimationFinished&&r.currentLens.meta.filter(e.alert)&&p.bZ.isApplicableAlert(e.alert)&&O.nL.hasItems(r)?r.patch({currentLens:t.finishApplyAnimation([e.alert])(r.currentLens),alertSource:e.alert.state.source}):r)));return{id:"onAlertApply",when:O.nL.Effect.When.isSidebarOpen,what:O.nL.Effect.Applicator.create(r)}}}(D||(D={}))},64992:(e,t,r)=>{r.d(t,{x:()=>y,O:()=>v});var i=r(45701),n=r(18208),s=r(68983),a=r(66896),o=r(26653);function l(e){return`${e} ${n._6(e,"alert","alerts")}`}const c=e=>(t,r,i,n,s)=>t?l(r.count):e(r,i,n,s),u=(e,t)=>(r,i,n,s)=>{const a=s?r.count:r.priorityCount;return a>0?l(a):n&y.IsDocumentEmpty?e:t},d={description:"Improves spelling, grammar, and punctuation.",stateMessage:c(u("No alerts","Looking good"))},p={description:"Helps make your writing easier to understand.",stateMessage:c(((e,t,r)=>{const n=(0,s.W)(i.lt(o.g.ord))(t);if(r&y.IsDocumentEmpty)return"So far so good";if(e.count>0){if(o.g.isMin(t))return l(e.count);if(n(o.g.fromNumber(20)))return"Unclear";if(n(o.g.fromNumber(70)))return"A bit unclear";if(n(o.g.fromNumber(85)))return"Mostly clear";if(n(o.g.fromNumber(95)))return"Clear"}return"Very clear"}))},h={description:"Helps make your writing more interesting and effective.",stateMessage:c(((e,t,r)=>{const n=r&y.IsFreeUser,a=o.g.isMin(t),c=(0,s.W)(i.lt(o.g.ord))(t);if(r&y.IsDocumentEmpty||n&&a)return"Nothing yet";if(n||e.count>0){if(a)return l(e.count);if(c(o.g.fromNumber(20)))return"Bland";if(c(o.g.fromNumber(80)))return"A bit bland";if(c(o.g.fromNumber(95)))return"Engaging"}return"Very engaging"}))},m={description:"Helps you make the right impression on your reader.",stateMessage:c(((e,t,r)=>{const n=r&y.IsFreeUser,a=o.g.isMin(t),c=(0,s.W)(i.lt(o.g.ord))(t);if(r&y.IsDocumentEmpty||n&&a)return"Nothing yet";if(n||e.count>0){if(a)return l(e.count);if(c(o.g.fromNumber(20)))return"Serious issues";if(c(o.g.fromNumber(40)))return"Very off";if(c(o.g.fromNumber(95)))return"Slightly off"}return"Just right"}))},g={description:"Your organization’s writing guidelines.",stateMessage:c(u("Nothing yet","All good"))},f={[a.R.SpecialId.Correctness]:d,[a.R.SpecialId.CorrectnessPriority]:d,[a.R.SpecialId.Clarity]:p,[a.R.SpecialId.ClarityPriority]:p,[a.R.SpecialId.Engagement]:h,[a.R.SpecialId.EngagementPriority]:h,[a.R.SpecialId.Delivery]:m,[a.R.SpecialId.DeliveryPriority]:m,[a.R.SpecialId.Vox]:g,[a.R.SpecialId.VoxPriority]:g,[a.R.SpecialId.Plagiarism]:{description:"Checks for similarities to published writing.",stateMessage:c(((e,t,r)=>r&y.IsLensVisited&&!(r&y.IsDocumentEmpty)?r&y.IsLensActive?o.g.isMin(t)?"100% original":`${t}% unoriginal`:"Recheck":"Not checked yet"))},[a.R.SpecialId.Premium]:{description:"Offers more suggestions on how to improve your writing.",stateMessage:c(((e,t,r)=>r&y.IsDocumentEmpty?"Advanced checks":`${e.count} more ${n._6(e.count,"alert","alerts")}`))},[a.R.SpecialId.FreePremiumAlerts]:{description:"Offers more suggestions on how to improve your writing.",stateMessage:c(((e,t,r)=>r&y.IsDocumentEmpty?"Advanced checks":`${e.count} more ${n._6(e.count,"alert","alerts")}`))}};var y;function v(e){return f[e]}!function(e){e[e.IsDocumentEmpty=1]="IsDocumentEmpty",e[e.IsLensActive=2]="IsLensActive",e[e.IsLensVisited=4]="IsLensVisited",e[e.IsFreeUser=8]="IsFreeUser"}(y||(y={}))},25970:(e,t,r)=>{r.d(t,{g:()=>o});var i,n=r(8125),s=r(5114),a=r(38983);!function(e){let t,r;!function(e){e[e.CHECKED=0]="CHECKED",e[e.NOT_CHECKED=1]="NOT_CHECKED"}(t=e.PlagiarismCheckingState||(e.PlagiarismCheckingState={})),function(e){e.Mock=class{constructor(){this.downloadStarted=a.h.create(!1),this.beginDownload=n.Q1,this.tryToInterrupt=n.Q1,this.generateReport=()=>{throw new Error("Method not implemented.")},this.reportData=a.h.create(s.none),this.dedHTML="",this.dispose=n.Q1}}}(r=e.ViewModel||(e.ViewModel={}))}(i||(i={}));var o,l=r(76974);!function(e){let t,r;!function(e){let t;!function(e){e[e.ERROR=0]="ERROR",e[e.EMPTY=1]="EMPTY",e[e.LOADING=2]="LOADING",e[e.SHORT_CONTENT=3]="SHORT_CONTENT",e[e.READY=4]="READY"}(t=e.Type||(e.Type={}))}(t=e.State||(e.State={})),function(e){e.Mock=class{constructor(e={type:t.Type.EMPTY},r=s.some(new i.ViewModel.Mock)){this.statisticsState=e,this.reportViewModel=r,this.state=l.of(this.statisticsState),this.onModalClose=n.Q1}}}(r=e.ViewModel||(e.ViewModel={}))}(o||(o={}))},27125:(e,t,r)=>{if(r.d(t,{L:()=>A,g:()=>n}),75==r.j)var i=r(40327);var n,s=r(38983);if(75==r.j)var a=r(84966);if(75==r.j)var o=r(5114);if(75==r.j)var l=r(66896);if(75==r.j)var c=r(35416);if(75==r.j)var u=r(32952);if(75==r.j)var d=r(85985);if(75==r.j)var p=r(77176);if(75==r.j)var h=r(66310);if(75==r.j)var m=r(98403);if(75==r.j)var g=r(93508);if(75==r.j)var f=r(16118);if(75==r.j)var y=r(76974);if(75==r.j)var v=r(50628);if(75==r.j)var b=r(17343);if(75==r.j)var w=r(60797);if(75==r.j)var S=r(2834);if(75==r.j)var I=r(25975);class A{constructor(e,t,r,y,v,b,w,S=I.v.WithSuccess.State.isInSuccess(y),A){this._state=e,this._documentModel=t,this._trackSuccessStateChanged=r,this._capabilities=y,this.nonPriorityOptions=v,this.mutedAlertsOptions=b,this.hasNonPriorityAlerts=w,this.isInSuccess=S,this._withBirthday=A,this._getTextAmount=e=>0===e?n.TextAmount.zero:e<=a.hD?n.TextAmount.small:n.TextAmount.large,this._subs=[],this.textAmount=s.h.create(this._getTextAmount(this._documentModel.documentLength.get().trimmed)),this.actionEvents=new u.xQ,this.applicatorEffects={id:"successViewModel.effects",when:l.R.isWithAlertsId,what:c.nL.Effect.Applicator.create(this.actionEvents.pipe(d.h((({type:e})=>e===n.ActionType.More)),p.U((()=>e=>{const t=e.patch({currentLens:c.nL.hasItems(e)&&(0,c.yi)(e.currentLens)?this._capabilities.toggleNonPriorityList("expanded")(e.currentLens):e.currentLens});return(0,i.pipe)(c.nL.hasItems(t)?this._capabilities.findFirstAlert(t.currentLens):o.none,o.fold((()=>t),(e=>t.patch({currentLens:c.nL.hasItems(t)?this._capabilities.selectItemByAlert(e,[])(t.currentLens):t.currentLens}))))}))))},this._currentLens=this._state.view((e=>({isSuccess:this.isInSuccess(e),type:e.currentLens.type,nonPriorityAlertsLeft:c.nL.isLensview(e)&&c.nL.hasItems(e)&&0!==this._capabilities.getActiveAlertsCount(e.currentLens),isAllAlerts:l.R.isMainLens(e.currentLens.id)}))),this._listenTextSize=()=>this._currentLens.view((e=>e.isSuccess)).pipe(h.w(m.Ft(this._documentModel.documentLength.view("trimmed"))),p.U(this._getTextAmount)).subscribe(m.wW(this.textAmount)),this._lensSwitch=this._currentLens.pipe(g.O(this._currentLens.get()),f.G(),p.U((([e,t])=>t.isSuccess?o.some({prevLensType:e.type,nonPriorityAlertsLeft:t.nonPriorityAlertsLeft,isAllAlerts:t.isAllAlerts}):o.none))),this._textAmountToSuccessType=e=>e===n.TextAmount.zero?{type:n.SuccessType.zero,showBirthday:this._withBirthday.get()}:e===n.TextAmount.large?{type:n.SuccessType.large}:{type:n.SuccessType.small},this.successState=s.h.create({type:n.SuccessType.zero,showBirthday:this._withBirthday.get()}),this._subs.push(this._listenTextSize(),this._listenSuccessStateChange()),this.priorityList=(0,i.pipe)(v,o.map((e=>({hasNonPriorityAlerts:this._state.view(w),reviewNonPriorityAlerts:()=>{e.trackNonPriorityToggle(),this.actionEvents.next({type:n.ActionType.More})}})))),this.mutedAlerts=(0,i.pipe)(b,o.map((()=>({reviewMutedSuggestions:()=>{},mutedSuggestionsCount:this._state.view((e=>e.currentLens.meta.mutedCount))}))))}dispose(){this._subs.forEach((e=>e.unsubscribe())),this._subs=[]}_listenSuccessStateChange(){const e=e=>e.type===n.SuccessType.applied||e.type===n.SuccessType.zero?y.of(e):this._documentModel.checkingState.pipe(d.h((e=>"checking"!==e)),v.P(),b.h(e));return this._lensSwitch.pipe(w.cp((t=>this.textAmount.pipe(p.U(this._textAmountToSuccessType),g.O(t.prevLensType===c.Nm.lensview?{type:n.SuccessType.applied,nonPriorityAlertsLeft:t.nonPriorityAlertsLeft,isAllAlerts:t.isAllAlerts}:this._textAmountToSuccessType(this.textAmount.get())),f.G(),p.U((([e,t])=>e.type===n.SuccessType.applied&&t.type!==n.SuccessType.zero?e:t)),h.w(((t,r)=>0===r?y.of(t):e(t))),S.b((e=>{this._trackSuccessStateChanged(e.type===n.SuccessType.applied?"applied":e.type===n.SuccessType.zero?"nothingToCheck":"noIssues")})))))).subscribe(m.wW(this.successState))}}!function(e){let t,r,i;!function(e){e.More="More"}(t=e.ActionType||(e.ActionType={})),function(e){e.zero="zero",e.small="small",e.large="large"}(r=e.TextAmount||(e.TextAmount={})),function(e){e.zero="zero",e.small="small",e.large="large",e.applied="applied",e.premiumOnboardingStart="premiumOnboardingStart",e.premiumOnboardingComplete="premiumOnboardingComplete"}(i=e.SuccessType||(e.SuccessType={}));e.Mock=class{constructor(){this.textAmount=s.h.create(r.zero),this.successState=s.h.create({type:i.zero,showBirthday:!1}),this.mutedSuggestionsCount=s.h.create(0),this.hasNonPriorityAlerts=s.h.create(!1)}reviewMutedSuggestions(){throw new Error("Method not implemented.")}reviewNonPriorityAlerts(){throw new Error("Method not implemented.")}dispose(){throw new Error("Method not implemented.")}}}(n||(n={}))},90416:(e,t,r)=>{r.d(t,{p:()=>i});var i,n=r(27378),s=r(40327),a=r(38983),o=r(5114),l=r(83078),c=r(98403),u=r(19751),d=r(85255),p=r(2834),h=r(9223);!function(e){e.Manager=({children:t,cardWidth:r})=>{const i=c.Dx(r).pipe(u.d({refCount:!0,bufferSize:1}));return d.P.useSingleton("CardWidth.Manager"),d.P.useSubscriptionTo(i),n.createElement(e.Context.Provider,{value:i},t)},e.DefaultManager=({children:t})=>(d.P.useSingleton("CardWidth.DefaultManager"),n.createElement(e.Manager,{cardWidth:e.withCardWidthEffect(e.defaultSizeObserver)},t)),e.withCardWidthEffect=(t,r=e.defaultCardWidthSetter)=>t.pipe(p.b((e=>r(o.some(e)))),h.x(r.bind(null,o.none)),u.d({refCount:!0,bufferSize:1})),e.defaultCardWidthSetter=t=>{e.setRootCssVar(document.documentElement,t)},e.defaultSizeObserver=a.h.create(400),e.Context=n.createContext(e.defaultSizeObserver),e.setRootCssVar=(e,t)=>{e.style.setProperty("--cardWidth",(0,s.pipe)(t,o.map(String),l.QP))}}(i||(i={}))},18955:(e,t,r)=>{r.d(t,{d:()=>T});var i=r(27378),n=r(5739),s=r(38983),a=r(5114),o=r(19962),l=r(81531),c=r(46680),u=r(74238),d=r(45586),p=r(77176),h=r(24209),m=r(18625),g=r(66310),f=r(40151),y=r(85089),v=r(2834),b=r(49708),w=r(93508),S=r(17343),I=r(98403),A=r(76974),_=r(19751),C=r(67434),E=r(57091);class T extends i.Component{constructor(){super(...arguments),this._log=l.C8.Logging.getLogger("CardsListConnectorView",c.i.DEBUG),this._subs=new d.w.Keeper}componentDidMount(){!0===this.props.isMaster&&this._setMaster()}componentDidUpdate(e){const t=this.props.name;this._log.debug("lensview did update",{wasMaster:e.isMaster,nowMaster:this.props.isMaster,name:t}),!0===this.props.isMaster?!1===e.isMaster?(this._log.info("reuse released view",t),this.forceUpdate((()=>{this._setMaster(),this._log.trace("view force update complete",t)}))):(this._log.trace("set master view",t),this._setMaster()):(this._log.trace("release master view",t),this._clearSubs())}componentWillUnmount(){this._clearSubs()}render(){const{className:e,children:t,height:r}=this.props;return i.createElement(n.F.div,{"data-purpose":"card-list-connector",style:r.pipe(p.U((e=>({height:e})))),className:e},t)}_setMaster(){this._setSubs()}_setSubs(){this._clearSubs(),this._subs.push(this.props.stateSyncListener.subscribe())}_clearSubs(){this._subs.dispose()}}!function(e){let t;!function(e){e.create=()=>s.h.create({scrollProvider:a.none,scrollConsumer:a.none,viewport:a.none,title:a.none})}(t=e.Elements||(e.Elements={})),e.boundedScrollListener=(e,t)=>h.T(m.P((()=>{e.paddingTop.set(0)})),t.view("viewport").pipe(g.w(a.fold((()=>f.E),(e=>y.YC(e).pipe(p.U((t=>Object.assign(Object.assign({},t),{top:e.offsetTop,height:e.offsetHeight}))))))),v.b((t=>e.viewport.set({top:u.r.FromWindowTop.ISO.wrap(t.top),height:t.height})))),t.view("scrollProvider").pipe(g.w(a.fold((()=>f.E),(t=>b.R(t,"scroll").pipe(p.U((()=>t.scrollTop)),w.O(t.scrollTop),v.b((t=>e.scrollTop.set(t))),S.h(I.PU)))))),t.view("title").pipe(g.w(a.fold((()=>A.of(o.UL.empty)),(e=>y.YC(e)))),p.U((e=>e.height)),_.d({bufferSize:1,refCount:!0}),v.b((t=>e.paddingTop.set(t)))),t.view("scrollConsumer").pipe(g.w(a.fold((()=>f.E),(t=>e.scrollOffset.pipe(v.b((e=>{t.scrollTop+=e})))))))).pipe(S.h(void 0)),e.superScrollListener=(e,t)=>{const r=t.view("title").pipe(g.w(a.fold((()=>A.of(o.UL.empty)),(e=>y.YC(e)))),p.U((e=>e.height)),_.d({bufferSize:1,refCount:!0}));return h.T(m.P((()=>{e.paddingTop.set(0)})),t.view("viewport").pipe(g.w(a.fold((()=>f.E),(e=>y.YC(e).pipe(p.U((t=>Object.assign(Object.assign({},t),{top:e.offsetTop,height:e.offsetHeight}))))))),v.b((t=>e.viewport.set({top:u.r.FromWindowTop.ISO.wrap(t.top),height:t.height})))),t.view("scrollProvider").pipe(g.w(a.fold((()=>f.E),(t=>b.R(t,"scroll").pipe(p.U((()=>t.scrollTop)),w.O(t.scrollTop),v.b((t=>e.scrollTop.set(t))),S.h(I.PU)))))),t.view("scrollConsumer").pipe(g.w(a.fold((()=>f.E),(t=>e.scrollOffset.pipe(C.R(((e,t)=>e-t),0),v.b((e=>{t.style.transform=`translateY(${e}px)`})))))),E.a(r),v.b((([t,r])=>e.paddingTop.set(t+r))))).pipe(S.h(void 0))}}(T||(T={}))},4948:(e,t,r)=>{r.d(t,{J:()=>l});var i=r(27378),n=r(44060),s=r(63969),a=r(40219);if(75==r.j)var o=r(7046);const l=e=>i.createElement(o.zx.Animated,Object.assign({},(0,o.L_)(e,d.gray))),c={position:"relative",display:"inline-block",overflow:"hidden",outline:"none",border:0,verticalAlign:"middle",whiteSpace:"nowrap",cursor:"default",userSelect:"none",$nest:{"&:not([data-disabled='true'])[data-hovered='true']":{cursor:"pointer"}}},u={overflow:"hidden",padding:`0 ${s.u.rem(.5)}`,borderRadius:s.u.rem(a.fx),backgroundColor:n.Il.CoreNeutral60,color:n.Il.CoreNeutral0,textTransform:"none",letterSpacing:s.u.rem(n.xv.ButtonLetterSpacing),fontSize:s.u.rem(n.xv.ButtonSize),lineHeight:s.u.rem(n.xv.ButtonLineHeight),transitionDuration:s.u.seconds(.2),$nest:{"&[data-active='true'] > i[role='icon'] > svg, &:not([data-disabled='true']):hover > i[role='icon'] > svg, &:not([data-disabled='true'])[data-hovered='true'] > i[role='icon'] > svg":{fill:n.Il.CoreNeutral0},"&:not([data-disabled='true'])[data-hovered='true']":{backgroundColor:n.Il.CoreNeutral50,color:n.Il.CoreNeutral0},"&:not([data-disabled='true'])[data-active='true']":{backgroundColor:n.Il.CoreNeutral50,color:n.Il.CoreNeutral0,$nest:{"&:hover":{backgroundColor:n.Il.CoreNeutral50,color:n.Il.CoreNeutral0}}},"&[data-disabled='true']":{backgroundColor:n.Il.CoreNeutral60,color:n.Il.CoreNeutral50},".groupSticky &":{padding:`0 ${s.u.rem(.5)}`,marginRight:s.u.px(2),borderRadius:0,backgroundColor:n.Il.CoreNeutral20,$nest:{"&:first-child":{borderRadius:`${s.u.rem(a.fx)} 0 0 ${s.u.rem(a.fx)}`},"&:last-child":{marginRight:0,borderRight:"none",borderRadius:`0 ${s.u.rem(a.fx)} ${s.u.rem(a.fx)} 0`}}}}},d=s.u.stylesheet({button:[c],gray:[c,u]})},30543:(e,t,r)=>{r.d(t,{s:()=>R});var i,n,s=r(27378),a=r(5739),o=r(22232),l=r(44060),c=r(35407),u=r(88056),d=r(76024),p=r(19429),h=r(59312),m=r(95195),g=r(69243),f=r(55485);!function(e){e.prod="prod",e.preprod="preprod",e.qa="qa",e.fb="fb",e.dev="dev"}(i||(i={})),function(e){e.american="american",e.british="british",e.canadian="canadian",e.australian="australian"}(n||(n={}));var y,v=g.mM({".grammarly.com":null,".ppgr.io":null,".qagr.io":null}),b=(0,h.ev)((0,h.ev)([],Object.keys(v.keys),!0),["grammarly.io","sumologic.com","microsoft.com","office.com","apple.com","google.com","mozilla.org","mozilla.net","outlook.live.com"],!1).map((function(e){return e.startsWith(".")?e.slice(1):e})),w=g.G0([g.dt({state:g.i0("disabled")}),g.dt({state:g.i0("enabled")}),g.dt({state:g.i0("test")})]),S=(g.dt({version:g.Z_}),new g.Dy("HttpString",g.Z_.is,(function(e,t){return m.wE.chain(g.Z_.validate(e,t),(function(r){return/^(https?|wss?):\/\/(\w|\d|-|\/|\.|\?|\=|\_|\&)+(:(\d)+)?$/.test(r)?g.Vp(r):g.Rn(e,t,"URL parsing failed (".concat(r,")"))}))}),String)),I=new g.Dy("MsStoreUrlString",g.Z_.is,(function(e,t){return m.wE.chain(g.Z_.validate(e,t),(function(r){return/ms-windows-store:\/\/(\w|\d|-|\/|\.|\?|\=|\_|\&)+(:(\d)+)?$/.test(r)?g.Vp(r):g.Rn(e,t,"Edge URL parsing failed (".concat(r,")"))}))}),String),A=new g.Dy("AllowedHttpString",S.is,(function(e,t){return m.wE.chain(S.validate(e,t),(function(r){for(var i=r.split("//")[1].split("/")[0].split(":")[0],n=0,s=b;n<s.length;n++){var a=s[n];if(i.endsWith(a))return g.Vp(r)}var o="Domain (".concat(i,") is not allowed in ").concat(b.join(", "));return g.Rn(e,t,o)}))}),S.encode),_=g.mM({TRACE:null,DEBUG:null,INFO:null,WARN:null,ERROR:null,FATAL:null,OFF:null}),C=(g.r$({env:f.D.createStringEnum(i,"Environment"),logLevel:_,accumulateCrashLogLevel:_,sendCrashOnLogLevel:_,collectLogs:g.O7,collectCrashLogs:g.O7,copyLogsToConsole:g.O7,crashLogsCacheSize:g.pk,debugLogsCacheSize:g.pk,tracking:w,alertCache:g.r$({prefix:g.Z_,version:g.Z_}),mutedCategoriesCache:g.r$({prefix:g.Z_,version:g.Z_}),outcomeScoreCache:g.r$({prefix:g.Z_,version:g.Z_}),userSettingsPrefix:g.Z_,userSettingsVersion:g.Z_,defaultDialect:f.D.createStringEnum(n,"DialectEnum"),notificationShowTimeMs:g.pk,maxNotificationsOnTheScreen:g.pk,selfUpdate:g.r$({versionCheckInterval:g.pk,selfUpdateDelay:g.pk,canReloadCheckInterval:g.pk,blockingModalAutoReloadDelay:g.pk,retryFailedVersionCheckInterval:g.pk,retryFailedVersionCheckLimit:g.pk,debugBuildVersion:g.Z_,versionFilePath:g.Z_}),pingMaybeGnarDelay:g.pk,domains:g.r$({cookie:v,localServer:g.Z_}),api:g.r$({analyticsUrl:A,authUrl:A,institutionUrl:A,snippetsUrl:A,clientControlsUrl:A,institutionAdminUrl:A,institutionAnalyticsUrl:A,institutionGroupsUrl:A,institutionTonesUrl:A,tonesUrl:A,dapiUrl:A,doxUrl:A,irbisUrl:A,subscriptionUrl:A,discountUrl:A,dataReportUrl:A,capiWsUrl:A,capiApiUrl:A,gnarApi:g.r$({url:A}),felogUrl:A,felogDebugUrl:A,sumoUrl:A,crashLogUrl:A,onlineTestUrl:g.Z_,wsTest:A,proofitResultUrl:A,redirect:A,mailApiUrl:A,ssoUrl:A,scimUrl:A,workspaceUrl:A,voxWorkspaceUrl:A,voxInstitutionUrl:A,writingStylesUrl:A}),app:g.r$({nameWeb:g.Z_,nameDesktop:g.Z_}),urls:g.r$({free:g.Z_,account:A}),onlineEditor:g.r$({docId:A}),external:g.r$({gmail:A,gDocs:A,outlook:A}),funnel:g.r$({base:A,resetPassword:A,accountDeleted:A,businessLanding:A,businessStyleguideLanding:A,businessUpgradeLanding:A,subscribe:A,upgrade:A,plans:A,signin:A,socialSignin:A,signup:A,mainPage:A,deleteSocialAccount:A,subscriptionCancellationSurvey:A,keyboardInstall:A,desktopAppInstall:A,claimedUserJoinFallback:A,userTrustGuidelines:A,llamaServiceDownload:A,tour:A}),desktop:g.r$({windows:g.r$({installURL:A,infoURL:A}),mac:g.r$({installURL:A,infoURL:A})}),llama:g.r$({windows:A,mac:A}),mobileApp:g.r$({android:A,iOS:A}),extension:g.r$({chrome:g.r$({installURL:A,infoURL:A}),firefox:g.r$({installURL:A,iconURL:A,infoURL:A}),safari:g.r$({installURL:A}),edge:g.r$({installURL:I,infoURL:A}),edgeChromium:g.r$({installURL:A})}),edu:g.r$({adminPanelURL:A}),support:g.r$({login:A,email:g.Z_,mainPage:A,newRequest:A,contact:A,connectionTroubleshooting:A,emailExistsKBUrl:A,safariDownloadFilesKBUrl:A,rtfCompatibilityUrl:A,diagnosticTestPath:g.Z_,documentAcceptTrackedChanges:A,introducingGrammarlyEditor:A}),privacyPolicy:A,termsOfService:A,account:g.r$({customize:A,subscription:A,adminSubscription:A,members:A,styleGuide:A,writingStyle:A,suggestions:A}),preconnectLinks:g.IX(S),ideas:g.r$({galleryURL:A})}),p.VF((function(){return{env:i.prod,logLevel:"INFO",accumulateCrashLogLevel:"DEBUG",sendCrashOnLogLevel:"ERROR",collectLogs:!0,collectCrashLogs:!0,copyLogsToConsole:!1,crashLogsCacheSize:100,debugLogsCacheSize:100,tracking:{state:"enabled"},alertCache:{prefix:"editorTsAlertCache",version:"4"},mutedCategoriesCache:{prefix:"mutedCategoriesCache",version:"0"},outcomeScoreCache:{prefix:"scoreCache",version:"0"},userSettingsPrefix:"userSettings",userSettingsVersion:"1",defaultDialect:n.american,notificationShowTimeMs:7e3,maxNotificationsOnTheScreen:3,selfUpdate:{versionCheckInterval:59*d.wn,selfUpdateDelay:12*d.p7,canReloadCheckInterval:5*d.cK,blockingModalAutoReloadDelay:1*d.wn,retryFailedVersionCheckInterval:5*d.wn,retryFailedVersionCheckLimit:20,debugBuildVersion:"auto",versionFilePath:"/version.json"},pingMaybeGnarDelay:1*d.p7,domains:{cookie:".grammarly.com",localServer:"denali-local.grammarly.com"},api:{authUrl:"https://auth.grammarly.com/v3",institutionUrl:"https://goldengate.grammarly.com/institution/api",snippetsUrl:"https://goldengate.ppgr.io/snippets/v1/snippets",clientControlsUrl:"https://goldengate.grammarly.com/client-controls",institutionAdminUrl:"https://goldengate.grammarly.com/institution/api/institution/admin",institutionGroupsUrl:"https://goldengate.grammarly.com/institution/api/groups",analyticsUrl:"https://goldengate.grammarly.com/analytics/api/institution/statistics",institutionAnalyticsUrl:"https://goldengate.grammarly.com/institution/public/api/institution/statistics",institutionTonesUrl:"https://goldengate.grammarly.com/institution/api/institution/settings/tones",tonesUrl:"https://goldengate.ppgr.io/institution/api/tones",dapiUrl:"https://data.grammarly.com",doxUrl:"https://dox.grammarly.com",irbisUrl:"https://irbis.grammarly.com",subscriptionUrl:"https://subscription.grammarly.com/api/v1",discountUrl:"https://irbis.grammarly.com/api/discounts",dataReportUrl:"https://datareport.grammarly.com",capiWsUrl:"wss://capi.grammarly.com/freews",capiApiUrl:"https://capi.grammarly.com/api",gnarApi:{url:"https://gnar.grammarly.com"},felogUrl:"https://f-log-editor.grammarly.io",felogDebugUrl:"https://f-log-editor-debug.grammarly.io",sumoUrl:"https://endpoint2.collection.us2.sumologic.com/receiver/v1/http/ZaVnC4dhaV0Bxac28IqT2frgzsjX7HEotu8EZEZr07YE9RWLCzrOMGwzO9aL6c_iSiidkEplFOod2igKIxz_7s2CHlXc2u-XuLpetEBK1fV6xjfN2Sw2gA==",crashLogUrl:"https://f-log-editor.grammarly.io/crash",onlineTestUrl:"/online-test.json",wsTest:"wss://wstest.grammarly.com",proofitResultUrl:"https://dox.grammarly.com/documents/_docId_/proofread",redirect:"https://redirect.grammarly.com/redirect",mailApiUrl:"https://g-mail.grammarly.com",ssoUrl:"https://sso.grammarly.com",scimUrl:"https://goldengate.grammarly.com/auth/api/token/scim",workspaceUrl:"https://goldengate.grammarly.com/workspace",voxWorkspaceUrl:"https://goldengate.grammarly.com/vox/v1/workspace",voxInstitutionUrl:"https://goldengate.grammarly.com/vox/v1/institution",writingStylesUrl:"https://goldengate.grammarly.com/writingstyle"},app:{nameWeb:"editor",nameDesktop:"desktopEditor"},urls:{free:"/free",account:"https://account.grammarly.com"},onlineEditor:{docId:"https://app.grammarly.com/ddocs/"},external:{gmail:"https://mail.google.com/",gDocs:"https://docs.google.com",outlook:"https://outlook.live.com/mail"},funnel:{base:"https://www.grammarly.com",resetPassword:"https://www.grammarly.com/resetpassword",accountDeleted:"https://www.grammarly.com/account-deleted",businessLanding:"https://www.grammarly.com/business/e",businessStyleguideLanding:"https://www.grammarly.com/business/styleguide",businessUpgradeLanding:"https://www.grammarly.com/upgrade/business/try",subscribe:"https://www.grammarly.com/subscribe",upgrade:"https://www.grammarly.com/upgrade",plans:"https://www.grammarly.com/plans",signin:"https://www.grammarly.com/signin",socialSignin:"https://www.grammarly.com/signin/app/desktop-editor",signup:"https://www.grammarly.com/signup",mainPage:"https://www.grammarly.com/",deleteSocialAccount:"https://www.grammarly.com/social/delete-account",subscriptionCancellationSurvey:"https://www.grammarly.com/subscription-cancellation-survey",keyboardInstall:"https://www.grammarly.com/keyboard",desktopAppInstall:"https://www.grammarly.com/native",claimedUserJoinFallback:"https://redirect.grammarly.com/redirect?business_join=1",userTrustGuidelines:"https://www.grammarly.com/trust",llamaServiceDownload:"https://www.grammarly.com/service/download",tour:"https://www.grammarly.com/tour"},desktop:{windows:{installURL:"https://download-editor.grammarly.com/windows/GrammarlyEditor.exe",infoURL:"https://www.grammarly.com/native/windows"},mac:{installURL:"https://download-editor.grammarly.com/osx/GrammarlyEditor.dmg",infoURL:"https://www.grammarly.com/native/mac"}},llama:{windows:"https://download-windows.grammarly.com/GrammarlyInstaller.exe",mac:"https://download-mac.grammarly.com/Grammarly.dmg"},mobileApp:{android:"https://play.google.com/store/apps/details?id=com.grammarly.android.keyboard",iOS:"https://apps.apple.com/us/app/grammarly-grammar-keyboard/id1158877342"},extension:{chrome:{installURL:"https://chrome.google.com/webstore/detail/kbfnbcaeplbcioakkpcpgfkobkghlhen",infoURL:"https://chrome.google.com/webstore/detail/grammarly-spell-checker-g/kbfnbcaeplbcioakkpcpgfkobkghlhen?hl=en"},firefox:{installURL:"https://addons.mozilla.org/firefox/downloads/latest/566314/addon-566314-latest.xpi",iconURL:"https://addons.cdn.mozilla.net/user-media/addon_icons/566/566314-32.png",infoURL:"https://addons.mozilla.org/en-US/firefox/addon/grammarly-1/"},safari:{installURL:"https://apps.apple.com/us/app/grammarly-for-safari/id1462114288?ls=1&mt=12"},edge:{installURL:"ms-windows-store://pdp?ProductId=9p59wxtbhzzm",infoURL:"https://www.microsoft.com/en-us/store/p/grammarly-for-microsoft-edge/9p59wxtbhzzm?rtc=1"},edgeChromium:{installURL:"https://microsoftedge.microsoft.com/addons/detail/grammarly-for-microsoft-e/cnlefmmeadmemmdciolhbnfeacpdfbkd"}},edu:{adminPanelURL:"https://account.grammarly.com/admin"},support:{login:"https://support.grammarly.com/login",email:"support@grammarly.com",mainPage:"https://support.grammarly.com/",newRequest:"https://support.grammarly.com/hc/en-us/requests/new",contact:"https://www.grammarly.com/contact",connectionTroubleshooting:"https://support.grammarly.com/hc/en-us/articles/115000090271-Network-configuration-blocks-Grammarly-services",emailExistsKBUrl:"https://support.grammarly.com/hc/en-us/articles/115000090791-Changing-your-email-to-an-email-that-already-exists",safariDownloadFilesKBUrl:"https://support.grammarly.com/hc/en-us/articles/360001105952",rtfCompatibilityUrl:"https://support.grammarly.com/hc/en-us/articles/115000091512-Preserve-text-formatting",diagnosticTestPath:"/diagnostic-test?origin=editor",documentAcceptTrackedChanges:"https://support.office.com/en-us/article/Accept-tracked-changes-4838d24c-d5d1-4c6c-8e39-78b44bd2b4cc",introducingGrammarlyEditor:"https://support.grammarly.com/hc/en-us/articles/360003474732-Introducing-the-Grammarly-Editor"},privacyPolicy:"https://www.grammarly.com/privacy-policy",termsOfService:"https://www.grammarly.com/terms",account:{customize:"https://redirect.grammarly.com/redirect?profile_dictionary=1",subscription:"https://account.grammarly.com/subscription",adminSubscription:"https://account.grammarly.com/admin/subscription",members:"https://account.grammarly.com/admin/members",styleGuide:"https://account.grammarly.com/admin/style-guide",writingStyle:"https://account.grammarly.com/admin/style-guide-writing-style",suggestions:"https://redirect.grammarly.com/redirect?profile_suggestions=1"},preconnectLinks:["https://data.grammarly.com","https://gnar.grammarly.com","https://subscription.grammarly.com","https://auth.grammarly.com","https://f-log-editor.grammarly.com","https://static.institution.grammarly.com"],ideas:{galleryURL:"https://app.grammarly.com/ideas/sales"}}})));!function(e){e.createFromPlatformConfig=c.Pj(C),e.Context=s.createContext(u.Y.invariantContent("PlatformConfig"))}(y||(y={}));var E=r(81531),T=r(63969),x=r(30763),k=r(7046),M=r(50790),L=r(4948);var R;!function(e){e.UnauthorizedError=({action:e})=>s.createElement(M.DI.TitledContent,{title:"You've Been Logged Out"},"This occurs due to inactivity or logging out on another device.",s.createElement("br",null),s.createElement(L.J,{name:"login",className:D.footerLink,onClick:e},"Log Back In")),e.Offline=({reconnect:e,reconnectTime:t})=>s.createElement(M.DI.TitledContent,{title:"Lost Connection"},"Your Internet session was interrupted. We’ll try to reconnect you in"," ",s.createElement(a.F.span,null,t.view((e=>e)))," seconds.",s.createElement("br",null),s.createElement(L.J,{name:"reconnect",className:D.footerLink,onClick:e},"Reconnect Now")),e.ServerError=()=>{const t=e.withReload(L.J,"UnknownConnectionError");return s.createElement(M.DI.TitledContent,{title:"Sorry, Unexpected Issue"},"A small error has occurred, causing an interruption of service.",s.createElement("br",null),s.createElement(t,{name:"reload-page",className:D.footerLink},"Reload This Page"))},e.ConnectionWSError=()=>{const e=s.useContext(y.Context);return s.createElement(M.DI.TitledContent,{title:"Can’t Connect to Grammarly"},"Your network configuration currently blocks Grammarly services on this computer. ",s.createElement("br",null),s.createElement(L.J,{name:"troubleshoot",className:D.footerLink,href:e.support.diagnosticTestPath,target:"_blank"},"Troubleshoot This Issue"))},e.ClientConnectionError=()=>{const t=e.withReload(L.J,"ClientConnectionErrorNotification");return s.createElement(M.DI.TitledContent,{title:"Your Internet Connection Is Unstable"},"Please check your network stability and then reload this page.",s.createElement("br",null),s.createElement(t,{name:"reload-page",className:D.footerLink},"Reload Page Now"))},e.DocumentNotFoundError=({navigateToDocuments:e})=>s.createElement(M.DI.TitledContent,{title:"Can’t find this document"},"It looks like this document was removed or URL is incorrect.",s.createElement("br",null),s.createElement(L.J,{name:"goto-docs",className:D.footerLink,onClick:e},"Go to your documents")),e.SelfUpdate=()=>{const t=s.useContext(x.m.Context),r=e.withReload(k.zx,"SelfUpdateBlocker");return s.createElement(M.DI.TitledContent,{title:"Grammarly needs to refresh this page"},"Don't worry - your documents have already been saved. Please"," ",s.createElement(r,{name:"reload-page",className:D.link},"reload")," ","the page ",t.hotkeyLabelR,".")},e.DesktopHardUpdate=({reloadMethod:e})=>{const t=s.useContext(x.m.Context).desktopUpdate;return s.createElement(M.DI.TitledContent,{title:t.hardTitle},t.hard,s.createElement("br",null),s.createElement(L.J,{name:"reload-desktop",className:D.footerLink,onClick:e},t.reload))},e.DesktopHardDownload=({downloadMethod:e})=>{const t=s.useContext(x.m.Context).desktopUpdate;return s.createElement(M.DI.TitledContent,{title:t.hardTitle},t.hard,s.createElement("br",null),s.createElement(L.J,{name:"download-desktop",className:D.footerLink,onClick:e},t.download))},e.SlowNetworkError=()=>s.createElement(M.DI.TitledContent,{title:"Your Internet Connection Is Unstable"},"Grammarly may work slower than normal."),e.CheckingIsDownError=()=>s.createElement(M.DI.TitledContent,{title:"Text Checking Is Temporarily Unavailable"},"Grammarly is unable to check your text for errors at this time. We’re working to resolve the issue. Please check back soon."),e.Error=()=>{const e=s.useContext(y.Context);return s.createElement(M.DI.TitledContent,{title:"Sorry, Something Went Wrong"},"Please try again later or"," ",s.createElement(k.zx,{name:"support",className:D.link,href:e.support.login,target:"_blank"},"contact support")," ","now to report the issue.")},e.ProofitPaymentDeclinedError=({paymentMethod:e,navigateToSubscription:t})=>{const r=s.useContext(x.m.Context).proofitPayment,i=function(e,t,r){switch(e){case"creditCard":return t;case"payPal":return r;default:const i=`Unknown payment method: ${e}`;throw E.C8.Logging.getLogger("ProofitView").warn(i),new Error(i)}}(e,r.creditCard,r.payPal);return s.createElement(M.DI.TitledContent,{title:"Order can not be processed"},s.createElement("div",null,i),"Please update your credit card information in the Manage Subscription section.",s.createElement("br",null),s.createElement(L.J,{name:"manage-subscription",className:D.footerLink,onClick:t},"Go to Manage Subscription"))},e.PaymentSuccessMessage=()=>{const e=s.useContext(x.m.Context).proofitOrderModal.card.paymentSuccess;return s.createElement(M.DI.TitledContent,{title:e.title},s.createElement("div",null,e.message))},e.PaymentErrorMessage=()=>{const e=s.useContext(x.m.Context).proofitOrderModal.card.paymentError,t=s.useContext(y.Context);return s.createElement(M.DI.TitledContent,{title:e.title},s.createElement("div",null,e.message(t.support.login)))},e.ProofitEmptyDocumentError=()=>s.createElement(M.DI.TitledContent,{title:"Document is empty"},"The document you are trying to submit is empty. Please write something and try again."),e.ProofitDocumentProofreadError=({navigateToDocuments:e})=>s.createElement(M.DI.TitledContent,{title:"This document is a recent submission"},"The text you are trying to send for human proofreading was reviewed by our team. Please edit your text or select another document before you re-submit.",s.createElement("br",null),s.createElement(L.J,{name:"goto-docs",className:D.footerLink,onClick:e},"Go to your documents")),e.ProofitComplexInternalStructureError=({navigateToDocuments:e})=>s.createElement(M.DI.TitledContent,{title:"This document cannot be corrected"},"The text you are trying to send for human proofreading has complex internal structure. Please edit your text (e.g., remove significantly long tables) or select another document.",s.createElement("br",null),s.createElement(L.J,{name:"goto-docs",className:D.footerLink,onClick:e},"Go to your documents")),e.withReload=(e,t)=>class extends s.Component{render(){return s.createElement(e,Object.assign({},this.props,{onClick:()=>{try{localStorage.setItem("pageReloadReason",JSON.stringify({source:t,location:self.location.href,timestamp:Date.now()}))}catch(e){}self.location.reload()}}))}},e.CopyToClipboardError=()=>{const e=s.useContext(x.m.Context);return s.createElement(M.DI.TitledContent,{title:"Copying Is Not Supported by Your Browser"},"Please use ",e.hotkeyLabelC," instead.")},e.ProofitCancelled=()=>{const e=s.useContext(y.Context);return s.createElement(M.DI.TitledContent,{title:"Your order has been cancelled"},"Your proofreading order has been cancelled and the payment refunded. Please check your email for more information, or contact"," ",s.createElement(L.J,{name:"support",className:D.footerLink,href:e.support.login,target:"_blank"},"Grammarly support"))},e.ProofitCompleted=({documentTitle:e,documentDownloadUrl:t,email:r})=>s.createElement(M.DI.TitledContent,{title:`${e||"Your"} document has been proofread`},"A version of this document with proofreaders’ marks has been emailed to you at ",r," in .docx format.",s.createElement("br",null),s.createElement(L.J,{name:"download",className:D.footerLink,href:t,target:"_blank"},"Download .docx")),e.DenaliFormattingCompatibility=()=>{const e=s.useContext(x.m.Context),t=s.useContext(y.Context);return s.createElement(M.DI.TitledContent,{title:e.rtfCompatibilityModeNotificationTitle},"To preserve your document’s formatting, Grammarly’s formatting tools are temporarily not available.",s.createElement("br",null),s.createElement(L.J,{name:"support",className:D.footerLink,href:t.support.rtfCompatibilityUrl,target:"_blank"},"Learn more"))},e.DenaliDocumentUploaded=({navigateToDocuments:e})=>{const{denaliDocumentUploadNotification:t}=s.useContext(x.m.Context);return s.createElement(M.DI.TitledContent,{title:t.title},t.text," ",s.createElement(k.zx,{name:"goto-docs",className:D.link,onClick:e},t.link))},e.AlertsNothingFound=()=>s.createElement(M.DI.Content,null,"Grammarly found no critical writing issues in this text. Keep up the great work!"),e.DesktopSoftUpdate=({reloadMethod:e})=>{const t=s.useContext(x.m.Context).desktopUpdate;return s.createElement(M.DI.TitledContent,{title:t.softTitle},t.soft,s.createElement("br",null),s.createElement(L.J,{name:"reload-desktop",className:D.footerLink,onClick:e},t.reload))},e.DesktopSoftDownload=({downloadMethod:e})=>{const t=s.useContext(x.m.Context).desktopUpdate;return s.createElement(M.DI.TitledContent,{title:t.softTitle},t.soft,s.createElement("br",null),s.createElement(L.J,{name:"download-desktop",className:D.footerLink,onClick:e},t.download))},e.ThanksForFeedbackNotification=()=>s.createElement(M.DI.TitledContent,{title:"Your feedback has been sent"},"Thank you for helping make Grammarly better!"),e.DownloadDocumentNotFoundError=()=>{const e=s.useContext(x.m.Context);return s.createElement(M.DI.TitledContent,{"data-name":"document-not-found",title:e.downloadDocumentNotFoundError})},e.ClipboardNotSupported=({hotkey:e})=>{const t=s.useContext(x.m.Context);return s.createElement(M.DI.Content,null,t.hotkeyUnsupported,s.createElement("b",null,e))},e.DocumentSizeExceeded=({os:e,officeAddinUrl:t})=>{const r=s.useContext(x.m.Context).fileSizeExceededNotification;return s.createElement(M.DI.TitledContent,{title:r.title},r.body,"windows"===e&&s.createElement(L.J,{name:"officeAddin",className:D.footerLink,href:t,target:"_blank"},r.link))},e.DocumentUploaded=({navigateToDocument:e})=>{const t=s.useContext(x.m.Context).documentUploaded;return s.createElement(M.DI.Content,null,t.message,s.createElement("br",null),s.createElement(L.J,{name:"goto-doc",className:D.footerLink,onClick:e},t.link))},e.DocumentTypeUnsupported=()=>{const e=s.useContext(x.m.Context);return s.createElement(M.DI.Content,null,"Unsupported file type. ",e.notificationUploadFileText,": Microsoft Word (.doc, .docx), OpenOffice (.odt), TXT and RTF.")},e.DocumentWithTrackedChangesIsUnsupported=({link:e})=>s.createElement(M.DI.Content,null,"Your document contains revisions. Accept all revisions and try uploading again. Click"," ",s.createElement(k.zx,{name:"document-accept-tracked-changes",className:D.link,href:e,target:"_blank"},"here")," ","for details.");const t=(e,t)=>{switch(e){case O.switchToDenali:return t.switchToDenali;case O.feedbackSend:return t.feedbackSend;case O.statisticsError:return t.statisticsError;case O.referenceCopied:return t.referenceCopied;case O.documentCopied:return t.documentCopied;case O.isTemporaryDownloadError:return t.isTemporaryDownloadError;case O.documentUploadGeneralError:return t.documentUploadGeneralError;case O.documentIsEmpty:return t.documentIsEmpty;case O.noFileToUpload:return t.noFileToUpload;case O.oneDocumentIsAllowed:return t.oneDocumentIsAllowed;default:return(0,o.vE)(e)}};e.Generic=({type:e})=>{const r=s.useContext(x.m.Context);return s.createElement(M.DI.TitledContent,{title:t(e,r)})}}(R||(R={}));const N={display:"inline-flex",overflow:"unset",color:l.Il.CoreNeutral0,verticalAlign:"baseline",textDecoration:"underline",fontWeight:"bold",cursor:"pointer"},U={marginTop:T.u.rem(.5),textDecoration:"none"},D=T.u.stylesheet({link:[N],footerLink:[N,U]});var O;!function(e){e.switchToDenali="switchToDenali",e.feedbackSend="feedbackSend",e.statisticsError="statisticsError",e.referenceCopied="referenceCopied",e.documentCopied="documentCopied",e.isTemporaryDownloadError="isTemporaryDownloadError",e.documentUploadGeneralError="documentUploadGeneralError",e.documentIsEmpty="documentIsEmpty",e.noFileToUpload="noFileToUpload",e.oneDocumentIsAllowed="oneDocumentIsAllowed"}(O||(O={}))},32380:(e,t,r)=>{r.d(t,{A:()=>v});var i=r(27378),n=r(18208),s=r(44060),a=r(63969),o=r(30763),l=r(21474),c=r(50790),u=r(4948);const d=(e,t)=>{switch(e.kind){case"ignore":return"Dismissed";case"ignoreAll":return i.createElement(i.Fragment,null,i.createElement("span",null,e.alerts)," ",n._6(e.alerts,"alert has been","alerts have been")," dismissed");case"replace":return"Corrected";case"replaceSynonym":return"Replaced";case"replaceTransform":return i.createElement(i.Fragment,null,e.transform);case"addToDictionary":return i.createElement(i.Fragment,null,i.createElement("b",{className:t&&t.addToDictionary},e.word)," has been added to dictionary");case"report":return"Your report has been sent";case"markAsHelpful":return"Marked as “Will address”";case"markAsNotHelpful":return"Marked as “Not helpful”";default:return""}},p={display:"flex",marginTop:a.u.rem(-1.1),marginBottom:a.u.rem(-.5),alignItems:"center",justifyContent:"space-between"},h={marginTop:a.u.rem(.6),marginRight:a.u.rem(1),color:s.Il.CoreNeutral0,flexGrow:0,flexShrink:0},m={marginTop:a.u.rem(-.25),paddingRight:a.u.rem(.5),minWidth:"auto",minHeight:"auto",justifyContent:"space-between"},g={marginTop:a.u.rem(.6),maxWidth:a.u.rem(14),wordWrap:"break-word",flexBasis:"auto",flexGrow:1},f={marginRight:a.u.rem(1.4)},y=a.u.stylesheet({alertUndoWrapper:[p],alertUndoWrapperFlexible:[p,{flexWrap:"nowrap"}],alertUndoWrapperFullWidth:[p,{flexWrap:"wrap"}],alertUndoBtn:[h],alertUndoIcon:[m],alertUndoContent:[g],alertUndoContentFlexible:[g,f],addToDictionary:[{wordBreak:"break-all"}]});var v;!function(e){const t={wrapper:y.alertUndoWrapperFlexible,content:y.alertUndoContent,icon:y.alertUndoIcon,button:y.alertUndoBtn};e.Standard=({action:r,params:n})=>i.createElement(c.DI.Content,null,i.createElement(e.Content,{action:r,content:d(n),theme:Object.assign(Object.assign({},t),{wrapper:y.alertUndoWrapperFullWidth})})),e.Flexible=({notification:r,onClose:n,action:s,params:a})=>i.createElement(c.SJ.Wrapper,{notification:r,onClose:n},i.createElement(c.DI.Content,null,i.createElement(e.Content,{action:s,content:d(a,{addToDictionary:y.addToDictionary}),theme:Object.assign(Object.assign({},t),{wrapper:y.alertUndoWrapperFlexible,content:y.alertUndoContentFlexible})}))),e.Content=({action:e,content:r,theme:n=t})=>{const s=i.useContext(o.m.Context);return i.createElement("div",{className:n.wrapper},i.createElement("div",{className:n.content},r),i.createElement(u.J,{name:"alertUndoButton",className:n.button,onClick:e},i.createElement(l.JO.Undo,{className:n.icon}),s.undo))}}(v||(v={}))},25781:(e,t,r)=>{var i,n;r.d(t,{R:()=>i}),function(e){e.ESC_CODE=27,e.ENTER_CODE=13}(i||(i={})),function(e){e.isLeftMouseButtom=function(e){return 1===e.which||0===e.button}}(n||(n={}))},35407:(e,t,r)=>{r.d(t,{Pj:()=>a,GG:()=>o});var i=r(17771),n=r(19429),s=r(55415),a=function(e){return function(t){return n.r1.map((0,i.g)(n.r1)(e,t),(function(e){var t=e[0],r=e[1];return(0,s.Fx)(t,r)}))}},o=(0,i.Y)(n.r1)},51072:(e,t,r)=>{r.d(t,{Vi:()=>n});var i=r(95574);function n(e){return e().then(i.MH)}},93476:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r=e(t);return t[2]?"@media ".concat(t[2]," {").concat(r,"}"):r})).join("")},t.i=function(e,r,i){"string"==typeof e&&(e=[[null,e,""]]);var n={};if(i)for(var s=0;s<this.length;s++){var a=this[s][0];null!=a&&(n[a]=!0)}for(var o=0;o<e.length;o++){var l=[].concat(e[o]);i&&n[l[0]]||(r&&(l[2]?l[2]="".concat(r," and ").concat(l[2]):l[2]=r),t.push(l))}},t}},18756:(e,t,r)=>{function i(e){return!(!e||"function"!=typeof e.equals||"function"!=typeof e.hashCode)}function n(e,t){if(e===t||e!=e&&t!=t)return!0;if(!e||!t)return!1;if("function"==typeof e.valueOf&&"function"==typeof t.valueOf){const r=e.valueOf(),i=t.valueOf();if(r===i||r!=r&&i!=i)return!0;if(!r||!i)return!1}return!(!i(e)||!e.equals(t))}r.d(t,{AC:()=>a});function s(e){if("number"==typeof e)return e&e;if("function"==typeof e.valueOf){const t=e.valueOf();if(t!==e)return s(t)}return i(e)?e.hashCode():a(String(e))}function a(e){let t=0;if(null==e||0===e.length)return t;for(let r=0;r<e.length;r++){t=(t<<5)-t+e.charCodeAt(r),t&=t}return t}class o extends Error{constructor(e){let t="";for(const r of e.slice(0,2)){let e="";e=r instanceof Error?`${r.name}(${r.message})`:`${r}`,t+=", "+e}t=t.slice(2),e.length>2&&(t+=", ..."),super(t),this.name="CompositeError",this.errorsRef=e;this.constructor=o,this.__proto__=o.prototype}errors(){return this.errorsRef.slice()}}Error;class l extends Error{constructor(e){super(e),this.name="NoSuchElementError";this.constructor=l,this.__proto__=l.prototype}}Error;class c extends Error{constructor(e){super(e),this.name="IllegalStateError";this.constructor=c,this.__proto__=c.prototype}}class u extends Error{constructor(e){super(e),this.name="IllegalArgumentError";this.constructor=u,this.__proto__=u.prototype}}class d extends Error{constructor(e){super(e),this.name="NotImplementedError";this.constructor=d,this.__proto__=d.prototype}}class p extends Error{constructor(e){super(e),this.name="TimeoutError";this.constructor=p,this.__proto__=p.prototype}}function h(e){return function(){const t=Array.prototype.slice.call(arguments);return t.push(this),e.apply(void 0,t)}}function m(e,t,r){const i=e,n=i.prototype,s="fantasy-land/",a="equals",o=s+a,l="map",c=s+l,u="ap",d=s+u,p=s+"of",m="chain",g=s+m,f="chainRec",y=s+f;n.equals?n[o]=n.equals:r&&(n[o]=h(r.equals)),n.map?n[c]=n.map:t&&(n[c]=h(t.map)),n.ap?n[d]=n.ap:t&&(n[d]=h(t.ap)),i.pure?i[p]=i.pure:t&&(i[p]=t.of),n.chain?n[g]=n.chain:t&&(n[g]=h(t.chain)),i.chainRec?i[y]=i.chainRec:t&&(i[y]=t.chainRec)}class g{constructor(e,t){this._isRight="right"===t,this.value=e}isLeft(){return!this._isRight}isRight(){return this._isRight}contains(e){return this._isRight&&n(this.value,e)}exists(e){return this._isRight&&e(this.value)}filterOrElse(e,t){return this._isRight?e(this.value)?this:y(t()):this}flatMap(e){return this._isRight?e(this.value):this}chain(e){return this.flatMap(e)}ap(e){return e.flatMap((e=>this.map(e)))}fold(e,t){return this._isRight?t(this.value):e(this.value)}forAll(e){return!this._isRight||e(this.value)}get(){if(this._isRight)return this.value;throw new l("left.get()")}getOrElse(e){return this._isRight?this.value:e}getOrElseL(e){return this._isRight?this.value:e()}map(e){return this._isRight?b(e(this.value)):this}forEach(e){this._isRight&&e(this.value)}swap(){return this._isRight?y(this.value):b(this.value)}toOption(){return this._isRight?A(this.value):_}equals(e){return null!=e&&(this._isRight===e._isRight&&n(this.value,e.value))}hashCode(){return this._isRight?s(this.value)<<2:s(this.value)<<3}static pure(e){return new v(e)}static left(e){return y(e)}static right(e){return b(e)}static map2(e,t,r){return e.isLeft()?e:t.isLeft()?t:b(r(e.value,t.value))}static map3(e,t,r,i){return e.isLeft()?e:t.isLeft()?t:r.isLeft()?r:b(i(e.value,t.value,r.value))}static map4(e,t,r,i,n){return e.isLeft()?e:t.isLeft()?t:r.isLeft()?r:i.isLeft()?i:b(n(e.value,t.value,r.value,i.value))}static map5(e,t,r,i,n,s){return e.isLeft()?e:t.isLeft()?t:r.isLeft()?r:i.isLeft()?i:n.isLeft()?n:b(s(e.value,t.value,r.value,i.value,n.value))}static map6(e,t,r,i,n,s,a){return e.isLeft()?e:t.isLeft()?t:r.isLeft()?r:i.isLeft()?i:n.isLeft()?n:s.isLeft()?s:b(a(e.value,t.value,r.value,i.value,n.value,s.value))}static tailRecM(e,t){let r=e;for(;;){const e=t(r);if(!e.isRight())return e;const i=e.value;if(i.isRight())return b(i.value);r=i.value}}}class f extends g{constructor(e){super(e,"left")}}function y(e){return new f(e)}class v extends g{constructor(e){super(e,"right")}}function b(e){return new v(e)}const w={equals:(e,t)=>e?e.equals(t):!t,map:(e,t)=>t.map(e),ap:(e,t)=>t.ap(e),of:g.pure,chain:(e,t)=>t.flatMap(e),chainRec:(e,t)=>g.tailRecM(t,(t=>e(g.left,g.right,t)))};m(g,w,w);class S{constructor(e,t){this._isEmpty=null!=t?t:null==e,this.value=e}get(){if(!this._isEmpty)return this.value;throw new l("Option.get")}getOrElse(e){return this._isEmpty?e:this.value}orNull(){return this._isEmpty?null:this.value}orUndefined(){return this._isEmpty?void 0:this.value}getOrElseL(e){return this._isEmpty?e():this.value}orElse(e){return this._isEmpty?e:this}orElseL(e){return this._isEmpty?e():this}isEmpty(){return this._isEmpty}nonEmpty(){return!this._isEmpty}map(e){return this._isEmpty?_:A(e(this.value))}flatMap(e){return this._isEmpty?_:e(this.value)}chain(e){return this.flatMap(e)}ap(e){return e.flatMap((e=>this.map(e)))}filter(e){return this._isEmpty||!e(this.value)?_:this}fold(e,t){return this._isEmpty?e():t(this.value)}contains(e){return!this._isEmpty&&n(this.value,e)}exists(e){return!this._isEmpty&&e(this.value)}forAll(e){return this._isEmpty||e(this.value)}forEach(e){this._isEmpty||e(this.value)}equals(e){return null!=e&&(this.nonEmpty()&&e.nonEmpty()?n(this.value,e.value):this.isEmpty()&&e.isEmpty())}hashCode(){return this._isEmpty?2433880:null==this.value?9735524:s(this.value)<<2}static of(e){return null!=e?A(e):_}static some(e){return new S(e,!1)}static none(){return _}static empty(){return _}static pure(e){return A(e)}static map2(e,t,r){return e.nonEmpty()&&t.nonEmpty()?A(r(e.value,t.value)):_}static map3(e,t,r,i){return e.nonEmpty()&&t.nonEmpty()&&r.nonEmpty()?A(i(e.value,t.value,r.value)):_}static map4(e,t,r,i,n){return e.nonEmpty()&&t.nonEmpty()&&r.nonEmpty()&&i.nonEmpty()?A(n(e.value,t.value,r.value,i.value)):_}static map5(e,t,r,i,n,s){return e.nonEmpty()&&t.nonEmpty()&&r.nonEmpty()&&i.nonEmpty()&&n.nonEmpty()?A(s(e.value,t.value,r.value,i.value,n.value)):_}static map6(e,t,r,i,n,s,a){return e.nonEmpty()&&t.nonEmpty()&&r.nonEmpty()&&i.nonEmpty()&&n.nonEmpty()&&s.nonEmpty()?A(a(e.value,t.value,r.value,i.value,n.value,s.value)):_}static tailRecM(e,t){let r=e;for(;;){const e=t(r);if(!e.nonEmpty())return _;{const t=e.value;if(t.isRight())return A(t.value);r=t.value}}}}class I extends S{constructor(e){super(e,!1)}}function A(e){return new I(e)}const _=new class extends S{constructor(){super(void 0,!0)}},C={equals:(e,t)=>e?e.equals(t):!t,map:(e,t)=>t.map(e),ap:(e,t)=>t.ap(e),of:S.pure,chain:(e,t)=>t.flatMap(e),chainRec:(e,t)=>S.tailRecM(t,(t=>e(g.left,g.right,t)))};m(S,C,C);class E{constructor(e,t){this._isSuccess="success"===t,this.value=e}isSuccess(){return this._isSuccess}isFailure(){return!this._isSuccess}get(){if(!this._isSuccess)throw this.value;return this.value}getOrElse(e){return this._isSuccess?this.value:e}getOrElseL(e){return this._isSuccess?this.value:e()}orNull(){return this._isSuccess?this.value:null}orUndefined(){return this._isSuccess?this.value:void 0}orElse(e){return this._isSuccess?this:e}orElseL(e){return this._isSuccess?this:e()}failed(){return this._isSuccess?M(new l("try.failed()")):x(this.value)}fold(e,t){return this._isSuccess?t(this.value):e(this.value)}filter(e){if(!this._isSuccess)return this;try{return e(this.value)?this:M(new l(`Predicate does not hold for ${this.value}`))}catch(e){return M(e)}}flatMap(e){if(!this._isSuccess)return this;try{return e(this.value)}catch(e){return M(e)}}chain(e){return this.flatMap(e)}ap(e){return e.flatMap((e=>this.map(e)))}map(e){return this._isSuccess?E.of((()=>e(this.value))):this}forEach(e){this._isSuccess&&e(this.value)}recover(e){return this._isSuccess?this:E.of((()=>e(this.value)))}recoverWith(e){try{return this._isSuccess?this:e(this.value)}catch(e){return M(e)}}toOption(){return this._isSuccess?A(this.value):_}toEither(){return this._isSuccess?b(this.value):y(this.value)}equals(e){return null!=e&&(this._isSuccess?e._isSuccess&&n(this.value,e.value):!e._isSuccess&&n(this.value,e.value))}hashCode(){return this._isSuccess,s(this.value)}static of(e){try{return x(e())}catch(e){return M(e)}}static pure(e){return E.success(e)}static unit(){return R}static success(e){return x(e)}static failure(e){return M(e)}static raise(e){return M(e)}static map2(e,t,r){if(e.isFailure())return e;if(t.isFailure())return t;try{return x(r(e.value,t.value))}catch(e){return M(e)}}static map3(e,t,r,i){if(e.isFailure())return e;if(t.isFailure())return t;if(r.isFailure())return r;try{return x(i(e.value,t.value,r.value))}catch(e){return M(e)}}static map4(e,t,r,i,n){if(e.isFailure())return e;if(t.isFailure())return t;if(r.isFailure())return r;if(i.isFailure())return i;try{return x(n(e.value,t.value,r.value,i.value))}catch(e){return M(e)}}static map5(e,t,r,i,n,s){if(e.isFailure())return e;if(t.isFailure())return t;if(r.isFailure())return r;if(i.isFailure())return i;if(n.isFailure())return n;try{return x(s(e.value,t.value,r.value,i.value,n.value))}catch(e){return M(e)}}static map6(e,t,r,i,n,s,a){if(e.isFailure())return e;if(t.isFailure())return t;if(r.isFailure())return r;if(i.isFailure())return i;if(n.isFailure())return n;if(s.isFailure())return s;try{return x(a(e.value,t.value,r.value,i.value,n.value,s.value))}catch(e){return M(e)}}static tailRecM(e,t){let r=e;for(;;)try{const e=t(r);if(e.isFailure())return e;const i=e.get();if(i.isRight())return x(i.value);r=i.value}catch(e){return M(e)}}}class T extends E{constructor(e){super(e,"success")}}function x(e){return new T(e)}class k extends E{constructor(e){super(e,"failure")}}function M(e){return new k(e)}const L={equals:(e,t)=>e?e.equals(t):!t,map:(e,t)=>t.map(e),ap:(e,t)=>t.ap(e),of:E.pure,chain:(e,t)=>t.flatMap(e),chainRec:(e,t)=>E.tailRecM(t,(t=>e(g.left,g.right,t)))};m(E,L,L);const R=x(void 0);class N{static of(e){return new U(e)}static empty(){return O}static collection(...e){return new F(e)}static cancelAll(e){let t=null;for(const r of e)try{r.cancel()}catch(e){t?t.push(e):t=[e]}if(t)throw 1===t.length?t[0]:new o(t)}}class U extends N{constructor(e){super(),this.thunk=e}cancel(){if(null!==this.thunk){const e=this.thunk;this.thunk=null,e()}}}class D{constructor(){this._funIsDummy=!0}cancel(){}}const O=new D;class P{static of(e){return new z(e)}static empty(){return new j}static alreadyCanceled(){return B}static collection(...e){return new F(e)}}class F extends P{constructor(e){super(),this._refs=e}isCanceled(){return!this._refs}cancel(){if(this._refs)try{N.cancelAll(this._refs)}finally{delete this._refs}}}class z extends U{isCanceled(){return null===this.thunk}}class j extends P{constructor(){super(...arguments),this.canceled=!1}isCanceled(){return this.canceled}cancel(){this.canceled=!0}}const B=new class extends D{isCanceled(){return!0}};new class extends D{isCanceled(){return!0}cancel(){}update(e){return e.cancel(),this}};class W{constructor(e){this._underlying=e,this._canceled=!1}update(e){return this._canceled?e.cancel():this._underlying=e,this}isCanceled(){return this._canceled}cancel(){this._canceled||(this._canceled=!0,this._underlying&&(this._underlying.cancel(),delete this._underlying))}collapse(){if(this._underlying&&this._underlying instanceof W){const e=this._underlying;this._underlying=e._underlying,this._canceled=e._canceled}return this}clear(){return this._canceled||(this._underlying=void 0),this}static empty(){return new W}static of(e){return new W(N.of(e))}}class H{constructor(e){this._refs=e?e.slice(0):[]}cancel(){if(this._refs)try{N.cancelAll(this._refs)}finally{delete this._refs}}isCanceled(){return!this._refs}push(e){return this._refs?this._refs.push(e):e.cancel(),this}pop(){return this._refs&&this._refs.pop()||N.empty()}static empty(){return new H}static collection(...e){return new H(e)}}class G{constructor(e){this._underlying=e||O,this._chained=!1}update(e){if(!e)throw new u("cannot update to null value");return this._underlying?this._chained?(this._underlying.update(e),this):(this._underlying=e,this):(e.cancel(),this)}cancel(){this._underlying&&(this._underlying.cancel(),this._chained=!1,delete this._underlying)}clear(){this._underlying&&(this._underlying=O,this._chained=!1)}isCanceled(){return!this._underlying||this._chained&&this._underlying.isCanceled()}chainTo(e){if(!e)throw new u("cannot chain to null value");if(e===this)return this;if(!this._underlying)return e.cancel(),this;let t=e,r=!0;for(;t&&r;)if(t._chained){const e=t._underlying;if(e===this)return this;t=e,r=!!e}else t._underlying||(t=void 0),r=!1;if(t){const e=this._underlying;this._underlying=t,this._chained=!0,e instanceof D||t.update(e)}else this.cancel();return this}static empty(){return new G}}class ${toString(){return this.label.toUpperCase()}}const Y=1e3,V=1e6,Z=1e3*V,Q=60*Z,q=60*Q,X=24*q,J=9007199254740992,K=Math.trunc||function(e){return isNaN(e)?NaN:e>0?Math.floor(e):Math.ceil(e)};function ee(e,t,r){return e>r?J:e<-r?-9007199254740992:e*t}const te=new class extends ${constructor(){super(...arguments),this.ord=0,this.label="nanoseconds"}convert(e,t){return t.toNanos(e)}toNanos(e){return e}toMicros(e){return K(e/1e3)}toMillis(e){return K(e/(V/1))}toSeconds(e){return K(e/(Z/1))}toMinutes(e){return K(e/(Q/1))}toHours(e){return K(e/(q/1))}toDays(e){return K(e/(X/1))}};const re=new class extends ${constructor(){super(...arguments),this.ord=1,this.label="microseconds"}convert(e,t){return t.toMicros(e)}toNanos(e){return ee(e,1e3,K(J/1e3))}toMicros(e){return e}toMillis(e){return K(e/1e3)}toSeconds(e){return K(e/(Z/Y))}toMinutes(e){return K(e/(Q/Y))}toHours(e){return K(e/(q/Y))}toDays(e){return K(e/(X/Y))}};const ie=new class extends ${constructor(){super(...arguments),this.ord=2,this.label="milliseconds"}convert(e,t){return t.toMillis(e)}toNanos(e){return ee(e,V/1,K(J/(V/1)))}toMicros(e){return ee(e,1e3,K(J/1e3))}toMillis(e){return e}toSeconds(e){return K(e/1e3)}toMinutes(e){return K(e/6e4)}toHours(e){return K(e/(q/V))}toDays(e){return K(e/(X/V))}};const ne=new class extends ${constructor(){super(...arguments),this.ord=3,this.label="seconds"}convert(e,t){return t.toSeconds(e)}toNanos(e){return ee(e,Z/1,K(J/(Z/1)))}toMicros(e){return ee(e,Z/Y,K(J/(Z/Y)))}toMillis(e){return ee(e,1e3,K(J/1e3))}toSeconds(e){return e}toMinutes(e){return K(e/60)}toHours(e){return K(e/3600)}toDays(e){return K(e/86400)}};const se=new class extends ${constructor(){super(...arguments),this.ord=4,this.label="minutes"}convert(e,t){return t.toMinutes(e)}toNanos(e){return ee(e,Q/1,K(J/(Q/1)))}toMicros(e){return ee(e,Q/Y,K(J/(Q/Y)))}toMillis(e){return ee(e,6e4,K(J/6e4))}toSeconds(e){return ee(e,60,K(J/60))}toMinutes(e){return e}toHours(e){return K(e/60)}toDays(e){return K(e/1440)}};const ae=new class extends ${constructor(){super(...arguments),this.ord=5,this.label="hours"}convert(e,t){return t.toHours(e)}toNanos(e){return ee(e,q/1,K(J/(q/1)))}toMicros(e){return ee(e,q/Y,K(J/(q/Y)))}toMillis(e){return ee(e,q/V,K(J/(q/V)))}toSeconds(e){return ee(e,3600,K(J/3600))}toMinutes(e){return ee(e,60,K(J/60))}toHours(e){return e}toDays(e){return K(e/24)}};const oe=new class extends ${constructor(){super(...arguments),this.ord=6,this.label="days"}convert(e,t){return t.toDays(e)}toNanos(e){return ee(e,X/1,K(J/(X/1)))}toMicros(e){return ee(e,X/Y,K(J/(X/Y)))}toMillis(e){return ee(e,X/V,K(J/(X/V)))}toSeconds(e){return ee(e,86400,K(J/86400))}toMinutes(e){return ee(e,1440,K(J/1440))}toHours(e){return ee(e,24,K(J/24))}toDays(e){return e}};class le{constructor(e,t){if(isNaN(e))throw new u("NaN is not supported for a Duration");this.duration=K(e),this.unit=t}isFinite(){return isFinite(this.duration)}toNanos(){return te.convert(this.duration,this.unit)}toMicros(){return re.convert(this.duration,this.unit)}toMillis(){return ie.convert(this.duration,this.unit)}toSeconds(){return ne.convert(this.duration,this.unit)}toMinutes(){return se.convert(this.duration,this.unit)}toHours(){return ae.convert(this.duration,this.unit)}toDays(){return oe.convert(this.duration,this.unit)}convertTo(e){return new le(e.convert(this.duration,this.unit),e)}negate(){switch(this.duration){case 1/0:return le.negInf();case-1/0:return le.inf();default:return new le(-this.duration,this.unit)}}plus(e){if(!isFinite(this.duration)){if(!isFinite(e.duration)&&this.duration!==e.duration)throw new u("cannot deal with two infinities with different signs, as that would be a NaN");return this}if(0===e.duration)return this;if(0===this.duration)return e;if(!isFinite(e.duration))return e;let t=this,r=e;return r.unit.ord<t.unit.ord&&(t=e,r=this),r=r.convertTo(t.unit),new le(t.duration+r.duration,t.unit)}minus(e){return this.plus(e.negate())}equals(e){function t(e,t){return e.unit.convert(t.duration,t.unit)===e.duration}return isFinite(this.duration)?this.unit.ord<=e.unit.ord?t(this,e):t(e,this):!isFinite(e.duration)&&this.duration===e.duration}hashCode(){return this.isFinite()?this.toNanos():this.duration===1/0?7540833725118015:422082410550358}toString(){return this.isFinite()?`${this.duration} ${this.unit.label}`:this.duration>=0?"[end of time]":"[beginning of time]"}static of(e){return"number"==typeof e?le.millis(e):e}static zero(){return new le(0,oe)}static inf(){return new le(1/0,oe)}static negInf(){return new le(-1/0,oe)}static nanos(e){return new le(e,te)}static micros(e){return new le(e,re)}static millis(e){return new le(e,ie)}static seconds(e){return new le(e,ne)}static minutes(e){return new le(e,se)}static hours(e){return new le(e,ae)}static days(e){return new le(e,oe)}}class ce{constructor(e){this._previous=[],this.get=e}set(e){return this.setL((()=>e))}setL(e){this._previous.push(this.get),this.get=e}revert(){const e=this._previous.pop();e&&(this.get=e)}bind(e,t){return this.bindL((()=>e),t)}bindL(e,t){const r=this.get,i=this._previous.slice(0),n=this;try{return n.get=e,t()}finally{n.get=r,n._previous=i}}static of(e){return new ce(e)}}function ue(e){if(!e)return[];if("[object Array]"===Object.prototype.toString.call(e))return e;const t=e[Symbol.iterator](),r=[];for(;;){const e=t.next();if(e.value&&r.push(e.value),e.done)return r}}const de=Math.log(2);function pe(e){if(e<0)throw new u("nr must be positive");const t=Math.ceil(function(e){return Math.log(e)/de}(e));return 1<<(t>30?30:t&t)}class he{constructor(e){switch(this.batchIndex=0,this.executionModel=e,e.type){case"alwaysAsync":this.executeBatched=this.executeAsync;break;case"synchronous":this.executeBatched=this.trampoline;break;case"batched":const t=e.recommendedBatchSize-1;this.executeBatched=e=>{const r=this.batchIndex+1&t;return r?(this.batchIndex=r,this.trampoline(e)):this.executeAsync(e)}}}scheduleWithFixedDelay(e,t,r){const i=(e,n,s)=>n.update(e.scheduleOnce(s,(()=>{r(),i(e,n,t)}))),n=W.empty();return i(this,n,e)}scheduleAtFixedRate(e,t,r){const i=(e,t,n,s)=>t.update(e.scheduleOnce(n,(()=>{const n=e.currentTimeMillis();r();const a=e.currentTimeMillis()-n,o=Math.max(0,s-a);i(e,t,s,o)}))),n=W.empty();return i(this,n,"number"==typeof e?e:e.toMillis(),"number"==typeof t?t:t.toMillis())}}he.global=ce.of((()=>ye));class me{constructor(e,t){switch(this.type=e,e){case"synchronous":this.recommendedBatchSize=1073741824;break;case"alwaysAsync":this.recommendedBatchSize=1;break;case"batched":this.recommendedBatchSize=pe(t||128)}}equals(e){return this.type===e.type&&this.recommendedBatchSize===e.recommendedBatchSize}hashCode(){return 47*a(this.type)+this.recommendedBatchSize}static synchronous(){return new me("synchronous")}static alwaysAsync(){return new me("alwaysAsync")}static batched(e){return new me("batched",e)}}me.global=ce.of((()=>me.batched()));class ge{constructor(e){this._isActive=!1,this._queue=[],this._reporter=e}execute(e){this._isActive?this._queue.push(e):this.runLoop(e)}runLoop(e){this._isActive=!0;try{let t=e;for(;t;){try{t()}catch(e){this._reporter(e)}t=this._queue.pop()}}finally{this._isActive=!1}}}class fe extends he{constructor(e=!1,t=me.global.get(),r){super(t),r&&(this.reportFailure=r),this._trampoline=new ge(this.reportFailure),this._useSetImmediate=!!e&&"function"==typeof setImmediate,this.executeAsync=this._useSetImmediate?e=>setImmediate(ve(e,this.reportFailure)):e=>setTimeout(ve(e,this.reportFailure))}executeAsync(e){throw new d("Constructor of GlobalScheduler wasn't executed")}trampoline(e){return this._trampoline.execute(e)}reportFailure(e){console.error(e)}currentTimeMillis(){return Date.now()}scheduleOnce(e,t){const r=Math.max(0,le.of(e).toMillis()),i=setTimeout((()=>{this.batchIndex=0;try{t()}catch(e){this.reportFailure(e)}}),r);return N.of((()=>clearTimeout(i)))}withExecutionModel(e){return new fe(this._useSetImmediate,e)}}const ye=new fe(!0);function ve(e,t){return()=>{try{e()}catch(e){t(e)}}}class be{transform(e,t){return this.transformWith((t=>be.pure(e(t),this._scheduler)),(e=>be.pure(t(e),this._scheduler)))}attempt(){return this.transform(y,b)}flatMap(e){return this.transformWith(be.raise,e)}chain(e){return this.flatMap(e)}ap(e){return e.flatMap((e=>this.map(e)))}forEach(e){this.onComplete((t=>t.forEach(e)))}map(e){return this.transformWith(be.raise,(t=>be.pure(e(t),this._scheduler)))}recoverWith(e){return this.transformWith(e,be.pure)}recover(e){return this.transformWith((t=>be.pure(e(t),this._scheduler)),(e=>be.pure(e,this._scheduler)))}then(e,t){if(!e&&!t)return this;const r=this._scheduler;return this.transformWith(Ee(t,(e=>be.raise(e,r)),r),Ee(e,(e=>be.pure(e,r)),r))}toPromise(){return new Promise(((e,t)=>{this.onComplete((r=>r.fold(t,e)))}))}delayResult(e){return this.transformWith((t=>be.delayedTick(e,this._scheduler).flatMap((()=>be.raise(t,this._scheduler)))),(t=>be.delayedTick(e,this._scheduler).map((()=>t))))}timeout(e){const t=be.raise(new p(le.of(e).toString()),this._scheduler);return this.timeoutTo(e,(()=>t))}timeoutTo(e,t){const r=[this,be.delayedTick(e,this._scheduler).flatMap((()=>t()))];return be.firstCompletedOf(r,this._scheduler)}static of(e,t=he.global.get()){const r=_e.empty(t);return t.executeAsync((()=>r.tryComplete(E.of(e)))),r.future()}static pure(e,t=he.global.get()){return new we(x(e),t)}static raise(e,t=he.global.get()){return new we(M(e),t)}static create(e,t=he.global.get()){const r=_e.empty(t);try{const t=e(r.complete);return r.future(t||void 0)}catch(e){return be.raise(e,t)}}static unit(e=he.global.get()){const t=e;let r=t._funCache&&t._funCache.futureUnit;return r||(r=new we(x(void 0),e),t._funCache=t._funCache||{},t._funCache.futureUnit=r),r}static delayedTick(e,t=he.global.get()){return be.create((r=>t.scheduleOnce(e,(()=>r(x(void 0))))),t)}static tailRecM(e,t,r=he.global.get()){return t(e).flatMap((e=>e.isRight()?be.pure(e.get(),r):be.tailRecM(e.swap().get(),t,r)))}static fromPromise(e,t=he.global.get()){return e instanceof be?e.withScheduler(t):be.create((t=>{e.then((e=>t(x(e))),(e=>t(M(e))))}),t)}static fromTry(e,t=he.global.get()){return new we(e,t)}static firstCompletedOf(e,t=he.global.get()){return function(e,t){return be.create((r=>{try{const i=xe(e,t);if(0===i.length)return r(M(new u("empty list of futures")));let n=!1;for(let e=0;e<i.length;e++){const s=e;i[e].onComplete((e=>{n?e.isFailure()&&t.reportFailure(e.failed().get()):(n=!0,Te(i,t,s),r(e))}))}return N.of((()=>Te(i,t)))}catch(e){r(M(e))}}),t)}(e,t)}static traverse(e,t=1/0,r=he.global.get()){return i=>function(e,t,r,i){if(r<=0)throw new u("parallelism <= 0");return be.of((()=>ue(e)),i).flatMap((e=>ke(e,t,r,i,0,[])))}(e,i,t,r)}static sequence(e,t=he.global.get()){return function(e,t){return be.create((r=>{try{const i=xe(e,t);if(0===i.length)return r(x([]));const n=N.of((()=>Te(i,t)));let s=!1,a=0,o=[];for(let e=0;e<i.length;e++){const l=e;i[e].onComplete((e=>{a+=1,e.isSuccess()?s||(o[l]=e.get(),s=a===i.length,s&&r(x(o))):s?t.reportFailure(e.failed().get()):(s=!0,n.cancel(),r(e))}))}return n}catch(e){r(M(e))}}),t)}(e,t)}static map2(e,t,r,i=he.global.get()){return be.sequence([e,t],i).map((e=>r(e[0],e[1])))}static map3(e,t,r,i,n=he.global.get()){return be.sequence([e,t,r],n).map((e=>i(e[0],e[1],e[2])))}static map4(e,t,r,i,n,s=he.global.get()){return be.sequence([e,t,r,i],s).map((e=>n(e[0],e[1],e[2],e[3])))}static map5(e,t,r,i,n,s,a=he.global.get()){return be.sequence([e,t,r,i,n],a).map((e=>s(e[0],e[1],e[2],e[3],e[4])))}static map6(e,t,r,i,n,s,a,o=he.global.get()){return be.sequence([e,t,r,i,n,s],o).map((e=>a(e[0],e[1],e[2],e[3],e[4],e[5])))}}class we extends be{constructor(e,t){super(),this._value=e,this._scheduler=t}cancel(){}value(){return A(this._value)}withScheduler(e){return this._scheduler===e?this:new we(this._value,e)}onComplete(e){this._scheduler.executeBatched((()=>e(this._value)))}transformWith(e,t){return Ce(this,e,t,this._scheduler)}toPromise(){return this._value.fold((e=>Promise.reject(e)),(e=>Promise.resolve(e)))}}class Se{constructor(){this.id=null,this.ref=null}compressedRoot(){let e=this;for(;"chained"===e.id;)e=e.ref,this.ref=e;return e}value(){switch(this.id){case null:return _;case"complete":return A(this.ref);case"chained":return this.compressedRoot().value()}}tryComplete(e,t){switch(this.id){case null:const r=this.ref;if(this.ref=e,this.id="complete",r)for(let i=0;i<r.length;i++)t.executeBatched((()=>r[i](e)));return!0;case"complete":return!1;case"chained":const i=this.ref.compressedRoot(),n=i.tryComplete(e,t);return this.id="complete",this.ref=n?e:i.value().get(),n}}chainTo(e,t){switch(this.id){case null:const r=this.ref;if(this.id="chained",this.ref=e.compressedRoot(),r&&r.length>0)for(let i=0;i<r.length;i++)e.onComplete(r[i],t);break;case"chained":this.compressedRoot().chainTo(e.compressedRoot(),t);break;case"complete":e.tryComplete(this.ref,t)}}onComplete(e,t){switch(this.id){case null:this.ref||(this.ref=[]),this.ref.push(e);break;case"complete":t.executeBatched((()=>e(this.ref)));break;case"chained":this.ref.onComplete(e,t)}}}const Ie={map:(e,t)=>t.map(e),ap:(e,t)=>t.ap(e),of:be.pure,chain:(e,t)=>t.flatMap(e),chainRec:(e,t)=>be.tailRecM(t,(t=>e(g.left,g.right,t)))};m(be,Ie);class Ae extends be{constructor(e,t,r){super(),this._state=e,this._scheduler=r,t&&(this._cancelable=t)}value(){return this._state.value()}onComplete(e){return this._state.onComplete(e,this._scheduler)}cancel(){if(this._cancelable)try{this._cancelable.cancel()}finally{delete this._cancelable}}withScheduler(e){return this._scheduler===e?this:new Ae(this._state,this._cancelable,e)}transformWith(e,t){return Ce(this,e,t,this._scheduler,this._cancelable)}}class _e{constructor(e,t){this.tryComplete=e=>this._state.tryComplete(e,this._scheduler),this.complete=e=>{if(!this.tryComplete(e))throw new c("Cannot complete a FutureMaker twice!")},this._state=e,this._scheduler=t}trySuccess(e){return this.tryComplete(x(e))}success(e){return this.complete(x(e))}tryFailure(e){return this.tryComplete(M(e))}failure(e){return this.complete(M(e))}chainTo(e){this._state.chainTo(e._state,this._scheduler)}future(e){switch(this._state.id){case"complete":return new we(this._state.ref,this._scheduler);default:return new Ae(this._state,e,this._scheduler)}}withScheduler(e){return this._scheduler===e?this:new _e(this._state,e)}static empty(e=he.global.get()){return new _e(new Se,e)}static completed(e,t=he.global.get()){const r=new Se;return r.id="complete",r.ref=e,new _e(r,t)}}function Ce(e,t,r,i,n){const s=_e.empty(i),a=new G(n);return e.onComplete((e=>{let n;try{n=e.fold(t,r)}catch(e){n=be.raise(e)}if(n.value().isEmpty()){const e=n._cancelable;e&&e instanceof G?e.chainTo(a):!e||e instanceof D||a.update(e)}else a.clear();n instanceof Ae?n._state.chainTo(s._state,i):n.onComplete(s.tryComplete)})),s.future(a)}function Ee(e,t,r){return i=>{if("function"!=typeof e)return t(i);const n=e(i);return n?"function"==typeof n.then?be.fromPromise(n,r):be.pure(n,r):be.pure(i,r)}}function Te(e,t,r=-1){const i=[];for(let t=0;t<e.length;t++)if(t!==r)try{e[t].cancel()}catch(e){i.push(e)}if(i.length>0)for(const e of i)t.reportFailure(e)}function xe(e,t){if(!e)return[];if("[object Array]"===Object.prototype.toString.call(e))return e;const r=[];try{const t=e[Symbol.iterator]();for(;;){const e=t.next();if(e.value&&r.push(e.value),e.done)break}return r}catch(e){throw Te(r,t),e}}function ke(e,t,r,i,n,s){if(n>=e.length)return be.pure(s,i);let a=[],o=0;try{for(;n<e.length&&o<r;)a.push(t(e[n++])),o+=1;const l=be.sequence(a,i).map((e=>{for(let t=0;t<e.length;t++)s.push(e[t])}));return n>=e.length?l.map((()=>s)):l.flatMap((()=>ke(e,t,r,i,n,s)))}catch(e){return Te(a,i),be.raise(e)}}const Me={next:()=>({done:!0})};function Le(e){if(!e)return Me;if("[object Array]"!==Object.prototype.toString.call(e))return e[Symbol.iterator]();const t=e;if(0===t.length)return Me;let r=0;return{next:()=>{const e=t[r++];return{done:r>=t.length,value:e}}}}class Re{get(){return function(e){let t=e,r=null,i=null;for(;;)switch(t._tag){case"now":const e=t,n=je(r,i);if(!n)return e.value;r=null,t=n(e.value);break;case"always":case"once":t=new Ne(t.get());break;case"suspend":t=t.thunk();break;case"flatMap":r&&(i||(i=[]),i.push(r));const s=t;r=s.f,t=s.source}}(this)}map(e){return new Fe(this,(t=>Re.now(e(t))))}flatMap(e){return new Fe(this,e)}chain(e){return this.flatMap(e)}ap(e){return e.flatMap((e=>this.map(e)))}memoize(){switch(this._tag){case"now":case"once":return this;case"always":return new De(this.get);default:return new De((()=>this.get()))}}forEachL(e){return this.map(e)}forEach(e){this.forEachL(e).get()}static of(e){return Re.always(e)}static pure(e){return Re.now(e)}static now(e){return new Ne(e)}static unit(){return Ue}static always(e){return new Oe(e)}static once(e){return new De(e)}static suspend(e){return new Pe(e)}static defer(e){return Re.suspend(e)}static tailRecM(e,t){return t(e).flatMap((e=>e.isRight()?Re.now(e.get()):Re.tailRecM(e.swap().get(),t)))}static sequence(e){return function(e){return Re.of((()=>Le(e))).flatMap((e=>Be([],e)))}(e)}static map2(e,t,r){return Re.sequence([e,t]).map((e=>r(e[0],e[1])))}static map3(e,t,r,i){return Re.sequence([e,t,r]).map((e=>i(e[0],e[1],e[2])))}static map4(e,t,r,i,n){return Re.sequence([e,t,r,i]).map((e=>n(e[0],e[1],e[2],e[3])))}static map5(e,t,r,i,n,s){return Re.sequence([e,t,r,i,n]).map((e=>s(e[0],e[1],e[2],e[3],e[4])))}static map6(e,t,r,i,n,s,a){return Re.sequence([e,t,r,i,n,s]).map((e=>a(e[0],e[1],e[2],e[3],e[4],e[5])))}}class Ne extends Re{constructor(e){super(),this.value=e,this._tag="now"}get(){return this.value}toString(){return`Eval.now(${JSON.stringify(this.value)})`}}const Ue=new Ne(void 0);class De extends Re{constructor(e){super(),this._tag="once",this._thunk=e}get(){if(this._thunk){try{this._cache=this._thunk(),this._isError=!1}catch(e){this._cache=e,this._isError=!0}delete this._thunk}if(this._isError)throw this._cache;return this._cache}toString(){return"Eval.once([thunk])"}}class Oe extends Re{constructor(e){super(),this._tag="always",this.get=e}toString(){return"Eval.always([thunk])"}}class Pe extends Re{constructor(e){super(),this.thunk=e,this._tag="suspend"}toString(){return"Eval.suspend([thunk])"}}class Fe extends Re{constructor(e,t){super(),this.source=e,this.f=t,this._tag="flatMap"}toString(){return`Eval#FlatMap(${String(this.source)}, [function])`}}const ze={map:(e,t)=>t.map(e),ap:(e,t)=>t.ap(e),of:Re.pure,chain:(e,t)=>t.flatMap(e),chainRec:(e,t)=>Re.tailRecM(t,(t=>e(g.left,g.right,t)))};function je(e,t){return e||(t&&t.length>0?t.pop():null)}function Be(e,t){for(;;){const r=t.next(),i=r.done;if(r.value){return r.value.flatMap((r=>(e.push(r),i?Re.pure(e):Be(e,t))))}if(i)return Re.pure(e)}}m(Re,ze);class We{run(e=he.global.get()){return function(e,t){let r=e,i=null,n=null;const s=t.executionModel.recommendedBatchSize-1;let a=t.batchIndex;for(;;)if(r instanceof E){if(r.isSuccess()){const e=et(i,n);if(!e)return t.batchIndex=a,be.pure(r.get());try{r=e(r.get())}catch(e){r=new He(E.failure(e))}}else{const e=r.failed().get(),s=tt(i,n);if(!s)return t.batchIndex=a,be.raise(e);try{r=s(e)}catch(e){r=new He(E.failure(e))}}i=null;const e=a+1&s;if(!e)return at(r,t,i,n,!0);a=e}else switch(r._tag){case"pure":r=r.value;break;case"always":r=E.of(r.thunk);break;case"once":r=r.runTry();break;case"flatMap":const e=r;i&&(n||(n=[]),n.push(i)),i=e.g?[e.f,e.g]:e.f,r=e.source;break;case"async":case"memoize":return at(r,t,i,n,!1)}}(this,e)}runOnComplete(e,t=he.global.get()){return st(this,t,null,e,null,null,null)||N.empty()}attempt(){return this.transform((e=>g.left(e)),g.right)}asyncBoundary(e){return this.flatMap((t=>We.shift(e).map((()=>t))))}chain(e){return this.flatMap(e)}delayExecution(e){return We.delayedTick(e).flatMap((()=>this))}delayResult(e){return this.transformWith((t=>We.delayedTick(e).flatMap((()=>We.raise(t)))),(t=>We.delayedTick(e).map((()=>t))))}doOnFinish(e){return this.transformWith((t=>e(A(t)).flatMap((()=>We.raise(t)))),(t=>e(_).map((()=>t))))}doOnCancel(e){return We.asyncUnsafe(((t,r)=>{const i=t.scheduler;i.trampoline((()=>{const n=t.connection;n.push(N.of((()=>e.run(i)))),We.unsafeStart(this,t,ot(i,n,r))}))}))}executeForked(e){return We.fork(this,e)}executeWithModel(e){return We.asyncUnsafe(((t,r)=>{const i=t.scheduler.withExecutionModel(e),n=new qe(i,t.connection,t.options);i.trampoline((()=>We.unsafeStart(this,n,r)))}))}executeWithOptions(e){return We.asyncUnsafe(((t,r)=>{const i=t.scheduler,n=new qe(i,t.connection,e);i.trampoline((()=>We.unsafeStart(this,n,r)))}))}flatMap(e){return new Ve(this,e)}ap(e){return e.flatMap((e=>this.map(e)))}followedBy(e){return this.flatMap((()=>e))}forEach(e){return this.map(e)}forEffect(e){return this.flatMap((t=>e.map((()=>t))))}map(e){return new Ve(this,(t=>We.now(e(t))))}memoize(){switch(this._tag){case"pure":return this;case"always":return new $e(this.thunk,!1);case"memoize":const e=this;return e.onlySuccess?new Qe(this,!1):e;default:return new Qe(this,!1)}}memoizeOnSuccess(){switch(this._tag){case"pure":case"once":case"memoize":return this;case"always":return new $e(this.thunk,!0);default:return new Qe(this,!0)}}recover(e){return this.recoverWith((t=>We.now(e(t))))}recoverWith(e){return this.transformWith(e,We.now)}timeout(e){const t=We.raise(new p(le.of(e).toString()));return this.timeoutTo(e,t)}timeoutTo(e,t){const r=[this,We.delayedTick(e).flatMap((()=>t))];return We.firstCompletedOf(r)}transform(e,t){return this.transformWith((t=>We.now(e(t))),(e=>We.now(t(e))))}transformWith(e,t){return new Ve(this,t,e)}static always(e){return new Ye(e)}static async(e){return We.asyncUnsafe(((t,r)=>{const i=t.scheduler,n=t.connection;i.trampoline((()=>{const t=ot(i,n,r);try{const r=e(i,t);n.push(r||N.empty())}catch(e){t(M(e))}}))}))}static asyncUnsafe(e){return new Ze(e)}static defer(e){return We.unit().flatMap((()=>e()))}static deferAction(e){return We.asyncUnsafe(((t,r)=>{const i=t.scheduler;let n;try{n=e(i)}catch(e){n=We.raise(e)}i.trampoline((()=>We.unsafeStart(n,t,r)))}))}static deferFuture(e){return We.suspend((()=>We.fromFuture(e())))}static deferFutureAction(e){return We.deferAction((t=>We.fromFuture(e(t))))}static delayedTick(e){return We.asyncUnsafe(((t,r)=>{const i=t.connection,n=t.scheduler.scheduleOnce(e,(()=>{i.pop(),r(E.unit())}));i.push(n)}))}static firstCompletedOf(e){return ut(e,be.firstCompletedOf)}static fromFuture(e){return e.value().isEmpty()?We.asyncUnsafe(((t,r)=>{t.connection.push(e),e.onComplete((e=>{t.connection.pop(),r(e)}))})):We.fromTry(e.value().get())}static fromTry(e){return new He(e)}static fork(e,t){return We.shift(t).flatMap((()=>e))}static map2(e,t,r){return We.sequence([e,t]).map((e=>r(e[0],e[1])))}static map3(e,t,r,i){return We.sequence([e,t,r]).map((e=>i(e[0],e[1],e[2])))}static map4(e,t,r,i,n){return We.sequence([e,t,r,i]).map((e=>n(e[0],e[1],e[2],e[3])))}static map5(e,t,r,i,n,s){return We.sequence([e,t,r,i,n]).map((e=>s(e[0],e[1],e[2],e[3],e[4])))}static map6(e,t,r,i,n,s,a){return We.sequence([e,t,r,i,n,s]).map((e=>a(e[0],e[1],e[2],e[3],e[4],e[5])))}static now(e){return new He(x(e))}static of(e){return We.always(e)}static once(e){return new $e(e,!1)}static parMap2(e,t,r){return We.gather([e,t]).map((e=>r(e[0],e[1])))}static parMap3(e,t,r,i){return We.gather([e,t,r]).map((e=>i(e[0],e[1],e[2])))}static parMap4(e,t,r,i,n){return We.gather([e,t,r,i]).map((e=>n(e[0],e[1],e[2],e[3])))}static parMap5(e,t,r,i,n,s){return We.gather([e,t,r,i,n]).map((e=>s(e[0],e[1],e[2],e[3],e[4])))}static parMap6(e,t,r,i,n,s,a){return We.gather([e,t,r,i,n,s]).map((e=>a(e[0],e[1],e[2],e[3],e[4],e[5])))}static pure(e){return We.now(e)}static raise(e){return new He(M(e))}static sequence(e){return function(e){return We.of((()=>Le(e))).flatMap((e=>ct([],e)))}(e)}static gather(e){return ut(e,be.sequence)}static shift(e){return e?Je(e):Ke}static suspend(e){return We.unit().flatMap((()=>e()))}static tailRecM(e,t){try{return t(e).flatMap((e=>e.isRight()?We.now(e.get()):We.tailRecM(e.swap().get(),t)))}catch(e){return We.raise(e)}}static unit(){return Ge}static unsafeStart(e,t,r){return st(e,t.scheduler,t,r,null,null,null)}}class He extends We{constructor(e){super(),this.value=e,this._tag="pure"}}const Ge=new He(E.unit());class $e extends We{constructor(e,t){super(),this._tag="once",this._thunk=e,this.onlyOnSuccess=t}memoize(){return this.onlyOnSuccess&&this._thunk?new $e(this._thunk,!1):this}runTry(){if(this._thunk){const e=E.of(this._thunk);return!e.isSuccess()&&this.onlyOnSuccess||(delete this._thunk,delete this.onlyOnSuccess,this.cache=e),e}return this.cache}}class Ye extends We{constructor(e){super(),this.thunk=e,this._tag="always"}}class Ve extends We{constructor(e,t,r){super(),this.source=e,this.f=t,this.g=r,this._tag="flatMap"}}class Ze extends We{constructor(e){super(),this.register=e,this._tag="async"}}class Qe extends We{constructor(e,t){super(),this._tag="memoize",this.source=e,this.result=null,this.onlySuccess=t}}class qe{constructor(e,t=new H,r={autoCancelableRunLoops:!1}){this.scheduler=e,this.options=r,this.connection=t,r.autoCancelableRunLoops&&(this.shouldCancel=()=>t.isCanceled())}markAsyncBoundary(){this.scheduler.batchIndex=0}shouldCancel(){return!1}}const Xe={map:(e,t)=>t.map(e),ap:(e,t)=>t.ap(e),of:We.pure,chain:(e,t)=>t.flatMap(e),chainRec:(e,t)=>We.tailRecM(t,(t=>e(g.left,g.right,t)))};function Je(e){return We.asyncUnsafe(((t,r)=>{(e||t.scheduler).executeAsync((()=>r(E.unit())))}))}m(We,Xe);const Ke=Je();function et(e,t){let r;return e?r=e:t&&t.length>0&&(r=t.pop()),r?"function"==typeof r?r:r[0]:null}function tt(e,t){let r=e;do{if(r&&"function"!=typeof r)return r[1];r=t?t.pop():null}while(r);return null}class rt{constructor(e,t){this.context=e,this.callback=t,this.canCall=!1,this.bFirst=null,this.bRest=null,this.asFunction=this.signal.bind(this)}prepare(e,t){this.bFirst=e,this.bRest=t,this.canCall=!0}signal(e){this.canCall?(this.canCall=!1,st(new He(e),this.context.scheduler,this.context,this.callback,this,this.bFirst,this.bRest)):e.isFailure()&&this.context.scheduler.reportFailure(e.failed().get())}}function it(e,t,r,i,n,s,a){if(!t.shouldCancel()){t.scheduler.batchIndex=a;const o=i||new rt(t,r);o.prepare(n,s),e(t,o.asFunction)}}function nt(e,t,r,i,n,s){t.shouldCancel()||t.scheduler.executeAsync((()=>{st(e,t.scheduler,t,r,i,n,s)}))}function st(e,t,r,i,n,s,a){let o=e,l=s,c=a;const u=t.executionModel.recommendedBatchSize-1;let d=t.batchIndex;for(;;)if(o instanceof E){if(o.isSuccess()){const e=et(l,c);if(!e)return t.batchIndex=d,i(o);try{o=e(o.get())}catch(e){o=E.failure(e)}}else{const e=tt(l,c);if(!e)return t.batchIndex=d,i(o);try{o=e(o.failed().get())}catch(e){o=E.failure(e)}}l=null;const e=d+1&u;if(!e){const e=r||new qe(t);return nt(o instanceof E?new He(o):o,e,i,n,l,c),e.connection}d=e}else switch(o._tag){case"pure":o=o.value;break;case"always":o=E.of(o.thunk);break;case"once":o=o.runTry();break;case"flatMap":const e=o;l&&(c||(c=[]),c.push(l)),l=e.g?[e.f,e.g]:e.f,o=e.source;break;case"async":const s=o,a=r||new qe(t);return it(s.register,a,i,n,l,c,d),a.connection;case"memoize":return lt(o,t,r,i,l,c,d)}}function at(e,t,r,i,n){return be.create((s=>{const a=new qe(t);return n?nt(e,a,s,null,r,i):st(e,t,a,s,null,r,i),a.connection}))}function ot(e,t,r){let i=!1;return n=>{i?n.isFailure()&&e.reportFailure(n.failed().get()):(i=!0,e.trampoline((()=>{t.pop(),r(n)})))}}function lt(e,t,r,i,n,s,a){let o;if(t.batchIndex=a,e.result)o=e.result;else{const r=at(e.source,t,null,null,!1);r.value().isEmpty()?(e.result=r,o=r,r.onComplete((t=>{t.isSuccess()||!e.onlySuccess?(e.result=t,delete e.source):e.result=null}))):(o=r.value().get(),!o.isSuccess()&&e.onlySuccess||(e.result=o))}st(o instanceof E?new He(o):We.fromFuture(o),t,r,i,null,n,s)}function ct(e,t){for(;;){const r=t.next(),i=r.done;if(r.value){return r.value.flatMap((r=>(e.push(r),i?We.pure(e):ct(e,t))))}if(i)return We.pure(e)}}function ut(e,t){return We.asyncUnsafe(((r,i)=>{r.scheduler.trampoline((()=>{let n=!0;try{const s=[],a=ue(e);n=!1;for(let e=0;e<a.length;e++){const t=a[e].run(r.scheduler);s.push(t)}const o=t(s,r.scheduler);r.connection.push(o),o.onComplete(ot(r.scheduler,r.connection,i))}catch(e){n?i(M(e)):r.scheduler.reportFailure(e)}}))}))}}}]);